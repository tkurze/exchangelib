<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>exchangelib.services API documentation</title>
<meta name="description" content="Implement a selection of EWS services (operations) â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>exchangelib.services</code></h1>
</header>
<section id="section-intro">
<p>Implement a selection of EWS services (operations).</p>
<p>Exchange is very picky about things like the order of XML elements in SOAP requests, so we need to generate XML
automatically instead of taking advantage of Python SOAP libraries and the WSDL file.</p>
<p>Exchange EWS operations overview:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/ews-operations-in-exchange">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/ews-operations-in-exchange</a></p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;Implement a selection of EWS services (operations).

Exchange is very picky about things like the order of XML elements in SOAP requests, so we need to generate XML
automatically instead of taking advantage of Python SOAP libraries and the WSDL file.

Exchange EWS operations overview:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/ews-operations-in-exchange
&#34;&#34;&#34;

from .archive_item import ArchiveItem
from .common import EWSService
from .convert_id import ConvertId
from .copy_item import CopyItem
from .create_attachment import CreateAttachment
from .create_folder import CreateFolder
from .create_item import CreateItem
from .create_user_configuration import CreateUserConfiguration
from .delete_attachment import DeleteAttachment
from .delete_folder import DeleteFolder
from .delete_item import DeleteItem
from .delete_user_configuration import DeleteUserConfiguration
from .empty_folder import EmptyFolder
from .expand_dl import ExpandDL
from .export_items import ExportItems
from .find_folder import FindFolder
from .find_item import FindItem
from .find_people import FindPeople
from .get_attachment import GetAttachment
from .get_delegate import GetDelegate
from .get_events import GetEvents
from .get_folder import GetFolder
from .get_item import GetItem
from .get_mail_tips import GetMailTips
from .get_persona import GetPersona
from .get_room_lists import GetRoomLists
from .get_rooms import GetRooms
from .get_searchable_mailboxes import GetSearchableMailboxes
from .get_server_time_zones import GetServerTimeZones
from .get_streaming_events import GetStreamingEvents
from .get_user_availability import GetUserAvailability
from .get_user_configuration import GetUserConfiguration
from .get_user_oof_settings import GetUserOofSettings
from .get_user_settings import GetUserSettings
from .mark_as_junk import MarkAsJunk
from .move_folder import MoveFolder
from .move_item import MoveItem
from .resolve_names import ResolveNames
from .send_item import SendItem
from .send_notification import SendNotification
from .set_user_oof_settings import SetUserOofSettings
from .subscribe import SubscribeToPull, SubscribeToPush, SubscribeToStreaming
from .sync_folder_hierarchy import SyncFolderHierarchy
from .sync_folder_items import SyncFolderItems
from .unsubscribe import Unsubscribe
from .update_folder import UpdateFolder
from .update_item import UpdateItem
from .update_user_configuration import UpdateUserConfiguration
from .upload_items import UploadItems

__all__ = [
    &#34;ArchiveItem&#34;,
    &#34;ConvertId&#34;,
    &#34;CopyItem&#34;,
    &#34;CreateAttachment&#34;,
    &#34;CreateFolder&#34;,
    &#34;CreateItem&#34;,
    &#34;CreateUserConfiguration&#34;,
    &#34;DeleteAttachment&#34;,
    &#34;DeleteFolder&#34;,
    &#34;DeleteUserConfiguration&#34;,
    &#34;DeleteItem&#34;,
    &#34;EmptyFolder&#34;,
    &#34;EWSService&#34;,
    &#34;ExpandDL&#34;,
    &#34;ExportItems&#34;,
    &#34;FindFolder&#34;,
    &#34;FindItem&#34;,
    &#34;FindPeople&#34;,
    &#34;GetAttachment&#34;,
    &#34;GetDelegate&#34;,
    &#34;GetEvents&#34;,
    &#34;GetFolder&#34;,
    &#34;GetItem&#34;,
    &#34;GetMailTips&#34;,
    &#34;GetPersona&#34;,
    &#34;GetRoomLists&#34;,
    &#34;GetRooms&#34;,
    &#34;GetSearchableMailboxes&#34;,
    &#34;GetServerTimeZones&#34;,
    &#34;GetStreamingEvents&#34;,
    &#34;GetUserAvailability&#34;,
    &#34;GetUserConfiguration&#34;,
    &#34;GetUserOofSettings&#34;,
    &#34;GetUserSettings&#34;,
    &#34;MarkAsJunk&#34;,
    &#34;MoveFolder&#34;,
    &#34;MoveItem&#34;,
    &#34;ResolveNames&#34;,
    &#34;SendItem&#34;,
    &#34;SendNotification&#34;,
    &#34;SetUserOofSettings&#34;,
    &#34;SubscribeToPull&#34;,
    &#34;SubscribeToPush&#34;,
    &#34;SubscribeToStreaming&#34;,
    &#34;SyncFolderHierarchy&#34;,
    &#34;SyncFolderItems&#34;,
    &#34;Unsubscribe&#34;,
    &#34;UpdateFolder&#34;,
    &#34;UpdateItem&#34;,
    &#34;UpdateUserConfiguration&#34;,
    &#34;UploadItems&#34;,
]</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="exchangelib.services.archive_item" href="archive_item.html">exchangelib.services.archive_item</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.common" href="common.html">exchangelib.services.common</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.convert_id" href="convert_id.html">exchangelib.services.convert_id</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.copy_item" href="copy_item.html">exchangelib.services.copy_item</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.create_attachment" href="create_attachment.html">exchangelib.services.create_attachment</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.create_folder" href="create_folder.html">exchangelib.services.create_folder</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.create_item" href="create_item.html">exchangelib.services.create_item</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.create_user_configuration" href="create_user_configuration.html">exchangelib.services.create_user_configuration</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.delete_attachment" href="delete_attachment.html">exchangelib.services.delete_attachment</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.delete_folder" href="delete_folder.html">exchangelib.services.delete_folder</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.delete_item" href="delete_item.html">exchangelib.services.delete_item</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.delete_user_configuration" href="delete_user_configuration.html">exchangelib.services.delete_user_configuration</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.empty_folder" href="empty_folder.html">exchangelib.services.empty_folder</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.expand_dl" href="expand_dl.html">exchangelib.services.expand_dl</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.export_items" href="export_items.html">exchangelib.services.export_items</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.find_folder" href="find_folder.html">exchangelib.services.find_folder</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.find_item" href="find_item.html">exchangelib.services.find_item</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.find_people" href="find_people.html">exchangelib.services.find_people</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.get_attachment" href="get_attachment.html">exchangelib.services.get_attachment</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.get_delegate" href="get_delegate.html">exchangelib.services.get_delegate</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.get_events" href="get_events.html">exchangelib.services.get_events</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.get_folder" href="get_folder.html">exchangelib.services.get_folder</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.get_item" href="get_item.html">exchangelib.services.get_item</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.get_mail_tips" href="get_mail_tips.html">exchangelib.services.get_mail_tips</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.get_persona" href="get_persona.html">exchangelib.services.get_persona</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.get_room_lists" href="get_room_lists.html">exchangelib.services.get_room_lists</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.get_rooms" href="get_rooms.html">exchangelib.services.get_rooms</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.get_searchable_mailboxes" href="get_searchable_mailboxes.html">exchangelib.services.get_searchable_mailboxes</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.get_server_time_zones" href="get_server_time_zones.html">exchangelib.services.get_server_time_zones</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.get_streaming_events" href="get_streaming_events.html">exchangelib.services.get_streaming_events</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.get_user_availability" href="get_user_availability.html">exchangelib.services.get_user_availability</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.get_user_configuration" href="get_user_configuration.html">exchangelib.services.get_user_configuration</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.get_user_oof_settings" href="get_user_oof_settings.html">exchangelib.services.get_user_oof_settings</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.get_user_settings" href="get_user_settings.html">exchangelib.services.get_user_settings</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.mark_as_junk" href="mark_as_junk.html">exchangelib.services.mark_as_junk</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.move_folder" href="move_folder.html">exchangelib.services.move_folder</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.move_item" href="move_item.html">exchangelib.services.move_item</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.resolve_names" href="resolve_names.html">exchangelib.services.resolve_names</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.send_item" href="send_item.html">exchangelib.services.send_item</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.send_notification" href="send_notification.html">exchangelib.services.send_notification</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.set_user_oof_settings" href="set_user_oof_settings.html">exchangelib.services.set_user_oof_settings</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.subscribe" href="subscribe.html">exchangelib.services.subscribe</a></code></dt>
<dd>
<div class="desc"><p>The 'Subscribe' service has three different modes - pull, push and streaming - with different signatures. Implement
as three distinct classes.</p></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.sync_folder_hierarchy" href="sync_folder_hierarchy.html">exchangelib.services.sync_folder_hierarchy</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.sync_folder_items" href="sync_folder_items.html">exchangelib.services.sync_folder_items</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.unsubscribe" href="unsubscribe.html">exchangelib.services.unsubscribe</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.update_folder" href="update_folder.html">exchangelib.services.update_folder</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.update_item" href="update_item.html">exchangelib.services.update_item</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.update_user_configuration" href="update_user_configuration.html">exchangelib.services.update_user_configuration</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="exchangelib.services.upload_items" href="upload_items.html">exchangelib.services.upload_items</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="exchangelib.services.ArchiveItem"><code class="flex name class">
<span>class <span class="ident">ArchiveItem</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/archiveitem-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/archiveitem-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ArchiveItem(EWSAccountService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/archiveitem-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;ArchiveItem&#34;
    element_container_name = f&#34;{{{MNS}}}Items&#34;
    supported_from = EXCHANGE_2013

    def call(self, items, to_folder):
        &#34;&#34;&#34;Move a list of items to a specific folder in the archive mailbox.

        :param items: a list of (id, changekey) tuples or Item objects
        :param to_folder:

        :return: None
        &#34;&#34;&#34;
        return self._elems_to_objs(self._chunked_get_elements(self.get_payload, items=items, to_folder=to_folder))

    def _elem_to_obj(self, elem):
        return Item.id_from_xml(elem)

    def get_payload(self, items, to_folder):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        payload.append(
            folder_ids_element(folders=[to_folder], version=self.account.version, tag=&#34;m:ArchiveSourceFolderId&#34;)
        )
        payload.append(item_ids_element(items=items, version=self.account.version))
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.ArchiveItem.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.ArchiveItem.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.ArchiveItem.supported_from"><code class="name">var <span class="ident">supported_from</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.ArchiveItem.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, items, to_folder)</span>
</code></dt>
<dd>
<div class="desc"><p>Move a list of items to a specific folder in the archive mailbox.</p>
<p>:param items: a list of (id, changekey) tuples or Item objects
:param to_folder:</p>
<p>:return: None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, items, to_folder):
    &#34;&#34;&#34;Move a list of items to a specific folder in the archive mailbox.

    :param items: a list of (id, changekey) tuples or Item objects
    :param to_folder:

    :return: None
    &#34;&#34;&#34;
    return self._elems_to_objs(self._chunked_get_elements(self.get_payload, items=items, to_folder=to_folder))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.ArchiveItem.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, items, to_folder)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, items, to_folder):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    payload.append(
        folder_ids_element(folders=[to_folder], version=self.account.version, tag=&#34;m:ArchiveSourceFolderId&#34;)
    )
    payload.append(item_ids_element(items=items, version=self.account.version))
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.ConvertId"><code class="flex name class">
<span>class <span class="ident">ConvertId</span></span>
<span>(</span><span>protocol, chunk_size=None, timeout=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Take a list of IDs to convert. Returns a list of converted IDs or exception instances, in the same order as the
input list.</p>
<p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/convertid-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/convertid-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ConvertId(EWSService):
    &#34;&#34;&#34;Take a list of IDs to convert. Returns a list of converted IDs or exception instances, in the same order as the
    input list.

    MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/convertid-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;ConvertId&#34;
    cls_map = {cls.response_tag(): cls for cls in (AlternateId, AlternatePublicFolderId, AlternatePublicFolderItemId)}

    def call(self, items, destination_format):
        if destination_format not in ID_FORMATS:
            raise InvalidEnumValue(&#34;destination_format&#34;, destination_format, ID_FORMATS)
        return self._elems_to_objs(
            self._chunked_get_elements(self.get_payload, items=items, destination_format=destination_format)
        )

    def _elem_to_obj(self, elem):
        return self.cls_map[elem.tag].from_xml(elem, account=None)

    def get_payload(self, items, destination_format):
        supported_item_classes = AlternateId, AlternatePublicFolderId, AlternatePublicFolderItemId
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(DestinationFormat=destination_format))
        item_ids = create_element(&#34;m:SourceIds&#34;)
        for item in items:
            if not isinstance(item, supported_item_classes):
                raise InvalidTypeError(&#34;item&#34;, item, supported_item_classes)
            set_xml_value(item_ids, item, version=None)
        payload.append(item_ids)
        return payload

    @classmethod
    def _get_elements_in_container(cls, container):
        # We may have other elements in here, e.g. &#39;ResponseCode&#39;. Filter away those.
        return (
            container.findall(AlternateId.response_tag())
            + container.findall(AlternatePublicFolderId.response_tag())
            + container.findall(AlternatePublicFolderItemId.response_tag())
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.ConvertId.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.ConvertId.cls_map"><code class="name">var <span class="ident">cls_map</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.ConvertId.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, items, destination_format)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, items, destination_format):
    if destination_format not in ID_FORMATS:
        raise InvalidEnumValue(&#34;destination_format&#34;, destination_format, ID_FORMATS)
    return self._elems_to_objs(
        self._chunked_get_elements(self.get_payload, items=items, destination_format=destination_format)
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.ConvertId.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, items, destination_format)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, items, destination_format):
    supported_item_classes = AlternateId, AlternatePublicFolderId, AlternatePublicFolderItemId
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(DestinationFormat=destination_format))
    item_ids = create_element(&#34;m:SourceIds&#34;)
    for item in items:
        if not isinstance(item, supported_item_classes):
            raise InvalidTypeError(&#34;item&#34;, item, supported_item_classes)
        set_xml_value(item_ids, item, version=None)
    payload.append(item_ids)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.CopyItem"><code class="flex name class">
<span>class <span class="ident">CopyItem</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/copyitem-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/copyitem-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class CopyItem(move_item.MoveItem):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/copyitem-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;CopyItem&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.move_item.MoveItem" href="move_item.html#exchangelib.services.move_item.MoveItem">MoveItem</a></li>
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.CopyItem.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.move_item.MoveItem" href="move_item.html#exchangelib.services.move_item.MoveItem">MoveItem</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.move_item.MoveItem.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.move_item.MoveItem.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.move_item.MoveItem.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.move_item.MoveItem.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.move_item.MoveItem.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.move_item.MoveItem.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.CreateAttachment"><code class="flex name class">
<span>class <span class="ident">CreateAttachment</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createattachment-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createattachment-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class CreateAttachment(EWSAccountService):
    &#34;&#34;&#34;MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createattachment-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;CreateAttachment&#34;
    element_container_name = f&#34;{{{MNS}}}Attachments&#34;
    cls_map = {cls.response_tag(): cls for cls in (FileAttachment, ItemAttachment)}

    def call(self, parent_item, items):
        return self._elems_to_objs(self._chunked_get_elements(self.get_payload, items=items, parent_item=parent_item))

    def _elem_to_obj(self, elem):
        return self.cls_map[elem.tag].from_xml(elem=elem, account=self.account)

    def get_payload(self, items, parent_item):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        version = self.account.version
        if isinstance(parent_item, BaseItem):
            # to_item_id() would convert this to a normal ItemId, but the service wants a ParentItemId
            parent_item = ParentItemId(parent_item.id, parent_item.changekey)
        set_xml_value(payload, to_item_id(parent_item, ParentItemId), version=self.account.version)
        attachments = create_element(&#34;m:Attachments&#34;)
        for item in items:
            set_xml_value(attachments, item, version=version)
        payload.append(attachments)
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.CreateAttachment.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.CreateAttachment.cls_map"><code class="name">var <span class="ident">cls_map</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.CreateAttachment.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.CreateAttachment.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, parent_item, items)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, parent_item, items):
    return self._elems_to_objs(self._chunked_get_elements(self.get_payload, items=items, parent_item=parent_item))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.CreateAttachment.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, items, parent_item)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, items, parent_item):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    version = self.account.version
    if isinstance(parent_item, BaseItem):
        # to_item_id() would convert this to a normal ItemId, but the service wants a ParentItemId
        parent_item = ParentItemId(parent_item.id, parent_item.changekey)
    set_xml_value(payload, to_item_id(parent_item, ParentItemId), version=self.account.version)
    attachments = create_element(&#34;m:Attachments&#34;)
    for item in items:
        set_xml_value(attachments, item, version=version)
    payload.append(attachments)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.CreateFolder"><code class="flex name class">
<span>class <span class="ident">CreateFolder</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createfolder-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createfolder-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class CreateFolder(EWSAccountService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createfolder-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;CreateFolder&#34;
    element_container_name = f&#34;{{{MNS}}}Folders&#34;
    ERRORS_TO_CATCH_IN_RESPONSE = EWSAccountService.ERRORS_TO_CATCH_IN_RESPONSE + (ErrorFolderExists,)

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self.folders = []  # A hack to communicate parsing args to _elems_to_objs()

    def call(self, parent_folder, folders):
        # We can&#39;t easily find the correct folder class from the returned XML. Instead, return objects with the same
        # class as the folder instance it was requested with.
        self.folders = list(folders)  # Convert to a list, in case &#39;folders&#39; is a generator. We&#39;re iterating twice.
        return self._elems_to_objs(
            self._chunked_get_elements(
                self.get_payload,
                items=self.folders,
                parent_folder=parent_folder,
            )
        )

    def _elems_to_objs(self, elems):
        for folder, elem in zip(self.folders, elems):
            if isinstance(elem, Exception):
                yield elem
                continue
            yield parse_folder_elem(elem=elem, folder=folder, account=self.account)

    def get_payload(self, folders, parent_folder):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        payload.append(
            folder_ids_element(folders=[parent_folder], version=self.account.version, tag=&#34;m:ParentFolderId&#34;)
        )
        folder_elems = create_element(&#34;m:Folders&#34;)
        for folder in folders:
            set_xml_value(folder_elems, folder, version=self.account.version)
        payload.append(folder_elems)
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.CreateFolder.ERRORS_TO_CATCH_IN_RESPONSE"><code class="name">var <span class="ident">ERRORS_TO_CATCH_IN_RESPONSE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.CreateFolder.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.CreateFolder.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.CreateFolder.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, parent_folder, folders)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, parent_folder, folders):
    # We can&#39;t easily find the correct folder class from the returned XML. Instead, return objects with the same
    # class as the folder instance it was requested with.
    self.folders = list(folders)  # Convert to a list, in case &#39;folders&#39; is a generator. We&#39;re iterating twice.
    return self._elems_to_objs(
        self._chunked_get_elements(
            self.get_payload,
            items=self.folders,
            parent_folder=parent_folder,
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.CreateFolder.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, folders, parent_folder)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, folders, parent_folder):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    payload.append(
        folder_ids_element(folders=[parent_folder], version=self.account.version, tag=&#34;m:ParentFolderId&#34;)
    )
    folder_elems = create_element(&#34;m:Folders&#34;)
    for folder in folders:
        set_xml_value(folder_elems, folder, version=self.account.version)
    payload.append(folder_elems)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.CreateItem"><code class="flex name class">
<span>class <span class="ident">CreateItem</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Take a folder and a list of items. Return the result of creation as a list of tuples (success[True|False],
errormessage), in the same order as the input list.</p>
<p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createitem-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createitem-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class CreateItem(EWSAccountService):
    &#34;&#34;&#34;Take a folder and a list of items. Return the result of creation as a list of tuples (success[True|False],
    errormessage), in the same order as the input list.

    MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createitem-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;CreateItem&#34;
    element_container_name = f&#34;{{{MNS}}}Items&#34;

    def call(self, items, folder, message_disposition, send_meeting_invitations):
        if message_disposition not in MESSAGE_DISPOSITION_CHOICES:
            raise InvalidEnumValue(&#34;message_disposition&#34;, message_disposition, MESSAGE_DISPOSITION_CHOICES)
        if send_meeting_invitations not in SEND_MEETING_INVITATIONS_CHOICES:
            raise InvalidEnumValue(
                &#34;send_meeting_invitations&#34;, send_meeting_invitations, SEND_MEETING_INVITATIONS_CHOICES
            )
        if folder is not None:
            if not isinstance(folder, (BaseFolder, FolderId)):
                raise InvalidTypeError(&#34;folder&#34;, folder, (BaseFolder, FolderId))
            if folder.account != self.account:
                raise ValueError(&#34;Folder must belong to account&#34;)
        if message_disposition == SAVE_ONLY and folder is None:
            raise AttributeError(&#34;Folder must be supplied when in save-only mode&#34;)
        if message_disposition == SEND_AND_SAVE_COPY and folder is None:
            folder = self.account.sent  # &#39;Sent&#39; is default EWS behaviour
        if message_disposition == SEND_ONLY and folder is not None:
            raise AttributeError(&#34;Folder must be None in send-ony mode&#34;)
        return self._elems_to_objs(
            self._chunked_get_elements(
                self.get_payload,
                items=items,
                folder=folder,
                message_disposition=message_disposition,
                send_meeting_invitations=send_meeting_invitations,
            )
        )

    def _elem_to_obj(self, elem):
        if isinstance(elem, bool):
            return elem
        return BulkCreateResult.from_xml(elem=elem, account=self.account)

    @classmethod
    def _get_elements_in_container(cls, container):
        res = super()._get_elements_in_container(container)
        return res or [True]

    def get_payload(self, items, folder, message_disposition, send_meeting_invitations):
        &#34;&#34;&#34;Take a list of Item objects (CalendarItem, Message etc.) and return the XML for a CreateItem request.
        convert items to XML Elements.

        MessageDisposition is only applicable to email messages, where it is required.

        SendMeetingInvitations is required for calendar items. It is also applicable to tasks, meeting request
        responses (see
        https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createitem-operation-meeting-request
        ) and sharing
        invitation accepts (see
        https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createitem-acceptsharinginvitation
        ). The last two are not supported yet.

        :param items:
        :param folder:
        :param message_disposition:
        :param send_meeting_invitations:
        &#34;&#34;&#34;
        payload = create_element(
            f&#34;m:{self.SERVICE_NAME}&#34;,
            attrs=dict(MessageDisposition=message_disposition, SendMeetingInvitations=send_meeting_invitations),
        )
        if folder:
            payload.append(
                folder_ids_element(folders=[folder], version=self.account.version, tag=&#34;m:SavedItemFolderId&#34;)
            )
        item_elems = create_element(&#34;m:Items&#34;)
        for item in items:
            if not item.account:
                item.account = self.account
            set_xml_value(item_elems, item, version=self.account.version)
        payload.append(item_elems)
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.CreateItem.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.CreateItem.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.CreateItem.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, items, folder, message_disposition, send_meeting_invitations)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, items, folder, message_disposition, send_meeting_invitations):
    if message_disposition not in MESSAGE_DISPOSITION_CHOICES:
        raise InvalidEnumValue(&#34;message_disposition&#34;, message_disposition, MESSAGE_DISPOSITION_CHOICES)
    if send_meeting_invitations not in SEND_MEETING_INVITATIONS_CHOICES:
        raise InvalidEnumValue(
            &#34;send_meeting_invitations&#34;, send_meeting_invitations, SEND_MEETING_INVITATIONS_CHOICES
        )
    if folder is not None:
        if not isinstance(folder, (BaseFolder, FolderId)):
            raise InvalidTypeError(&#34;folder&#34;, folder, (BaseFolder, FolderId))
        if folder.account != self.account:
            raise ValueError(&#34;Folder must belong to account&#34;)
    if message_disposition == SAVE_ONLY and folder is None:
        raise AttributeError(&#34;Folder must be supplied when in save-only mode&#34;)
    if message_disposition == SEND_AND_SAVE_COPY and folder is None:
        folder = self.account.sent  # &#39;Sent&#39; is default EWS behaviour
    if message_disposition == SEND_ONLY and folder is not None:
        raise AttributeError(&#34;Folder must be None in send-ony mode&#34;)
    return self._elems_to_objs(
        self._chunked_get_elements(
            self.get_payload,
            items=items,
            folder=folder,
            message_disposition=message_disposition,
            send_meeting_invitations=send_meeting_invitations,
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.CreateItem.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, items, folder, message_disposition, send_meeting_invitations)</span>
</code></dt>
<dd>
<div class="desc"><p>Take a list of Item objects (CalendarItem, Message etc.) and return the XML for a CreateItem request.
convert items to XML Elements.</p>
<p>MessageDisposition is only applicable to email messages, where it is required.</p>
<p>SendMeetingInvitations is required for calendar items. It is also applicable to tasks, meeting request
responses (see
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createitem-operation-meeting-request">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createitem-operation-meeting-request</a>
) and sharing
invitation accepts (see
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createitem-acceptsharinginvitation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createitem-acceptsharinginvitation</a>
). The last two are not supported yet.</p>
<p>:param items:
:param folder:
:param message_disposition:
:param send_meeting_invitations:</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, items, folder, message_disposition, send_meeting_invitations):
    &#34;&#34;&#34;Take a list of Item objects (CalendarItem, Message etc.) and return the XML for a CreateItem request.
    convert items to XML Elements.

    MessageDisposition is only applicable to email messages, where it is required.

    SendMeetingInvitations is required for calendar items. It is also applicable to tasks, meeting request
    responses (see
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createitem-operation-meeting-request
    ) and sharing
    invitation accepts (see
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createitem-acceptsharinginvitation
    ). The last two are not supported yet.

    :param items:
    :param folder:
    :param message_disposition:
    :param send_meeting_invitations:
    &#34;&#34;&#34;
    payload = create_element(
        f&#34;m:{self.SERVICE_NAME}&#34;,
        attrs=dict(MessageDisposition=message_disposition, SendMeetingInvitations=send_meeting_invitations),
    )
    if folder:
        payload.append(
            folder_ids_element(folders=[folder], version=self.account.version, tag=&#34;m:SavedItemFolderId&#34;)
        )
    item_elems = create_element(&#34;m:Items&#34;)
    for item in items:
        if not item.account:
            item.account = self.account
        set_xml_value(item_elems, item, version=self.account.version)
    payload.append(item_elems)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.CreateUserConfiguration"><code class="flex name class">
<span>class <span class="ident">CreateUserConfiguration</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createuserconfiguration-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createuserconfiguration-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class CreateUserConfiguration(EWSAccountService):
    &#34;&#34;&#34;MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/createuserconfiguration-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;CreateUserConfiguration&#34;
    returns_elements = False

    def call(self, user_configuration):
        return self._get_elements(payload=self.get_payload(user_configuration=user_configuration))

    def get_payload(self, user_configuration):
        return set_xml_value(
            create_element(f&#34;m:{self.SERVICE_NAME}&#34;), user_configuration, version=self.protocol.version
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.CreateUserConfiguration.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.CreateUserConfiguration.returns_elements"><code class="name">var <span class="ident">returns_elements</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.CreateUserConfiguration.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, user_configuration)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, user_configuration):
    return self._get_elements(payload=self.get_payload(user_configuration=user_configuration))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.CreateUserConfiguration.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, user_configuration)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, user_configuration):
    return set_xml_value(
        create_element(f&#34;m:{self.SERVICE_NAME}&#34;), user_configuration, version=self.protocol.version
    )</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.DeleteAttachment"><code class="flex name class">
<span>class <span class="ident">DeleteAttachment</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/deleteattachment-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/deleteattachment-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DeleteAttachment(EWSAccountService):
    &#34;&#34;&#34;MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/deleteattachment-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;DeleteAttachment&#34;

    def call(self, items):
        return self._elems_to_objs(self._chunked_get_elements(self.get_payload, items=items))

    def _elem_to_obj(self, elem):
        return RootItemId.from_xml(elem=elem, account=self.account)

    @classmethod
    def _get_elements_in_container(cls, container):
        return container.findall(RootItemId.response_tag())

    def get_payload(self, items):
        return set_xml_value(
            create_element(f&#34;m:{self.SERVICE_NAME}&#34;),
            attachment_ids_element(items=items, version=self.account.version),
            version=self.account.version,
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.DeleteAttachment.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.DeleteAttachment.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, items)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, items):
    return self._elems_to_objs(self._chunked_get_elements(self.get_payload, items=items))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.DeleteAttachment.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, items)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, items):
    return set_xml_value(
        create_element(f&#34;m:{self.SERVICE_NAME}&#34;),
        attachment_ids_element(items=items, version=self.account.version),
        version=self.account.version,
    )</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.DeleteFolder"><code class="flex name class">
<span>class <span class="ident">DeleteFolder</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/deletefolder-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/deletefolder-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DeleteFolder(EWSAccountService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/deletefolder-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;DeleteFolder&#34;
    returns_elements = False

    def call(self, folders, delete_type):
        if delete_type not in DELETE_TYPE_CHOICES:
            raise InvalidEnumValue(&#34;delete_type&#34;, delete_type, DELETE_TYPE_CHOICES)
        return self._chunked_get_elements(self.get_payload, items=folders, delete_type=delete_type)

    def get_payload(self, folders, delete_type):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(DeleteType=delete_type))
        payload.append(folder_ids_element(folders=folders, version=self.account.version))
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.DeleteFolder.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.DeleteFolder.returns_elements"><code class="name">var <span class="ident">returns_elements</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.DeleteFolder.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, folders, delete_type)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, folders, delete_type):
    if delete_type not in DELETE_TYPE_CHOICES:
        raise InvalidEnumValue(&#34;delete_type&#34;, delete_type, DELETE_TYPE_CHOICES)
    return self._chunked_get_elements(self.get_payload, items=folders, delete_type=delete_type)</code></pre>
</details>
</dd>
<dt id="exchangelib.services.DeleteFolder.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, folders, delete_type)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, folders, delete_type):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(DeleteType=delete_type))
    payload.append(folder_ids_element(folders=folders, version=self.account.version))
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.DeleteItem"><code class="flex name class">
<span>class <span class="ident">DeleteItem</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Take a folder and a list of (id, changekey) tuples. Return result of deletion as a list of tuples
(success[True|False], errormessage), in the same order as the input list.</p>
<p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/deleteitem-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/deleteitem-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DeleteItem(EWSAccountService):
    &#34;&#34;&#34;Take a folder and a list of (id, changekey) tuples. Return result of deletion as a list of tuples
    (success[True|False], errormessage), in the same order as the input list.

    MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/deleteitem-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;DeleteItem&#34;
    returns_elements = False

    def call(self, items, delete_type, send_meeting_cancellations, affected_task_occurrences, suppress_read_receipts):
        if delete_type not in DELETE_TYPE_CHOICES:
            raise InvalidEnumValue(&#34;delete_type&#34;, delete_type, DELETE_TYPE_CHOICES)
        if send_meeting_cancellations not in SEND_MEETING_CANCELLATIONS_CHOICES:
            raise InvalidEnumValue(
                &#34;send_meeting_cancellations&#34;, send_meeting_cancellations, SEND_MEETING_CANCELLATIONS_CHOICES
            )
        if affected_task_occurrences not in AFFECTED_TASK_OCCURRENCES_CHOICES:
            raise InvalidEnumValue(
                &#34;affected_task_occurrences&#34;, affected_task_occurrences, AFFECTED_TASK_OCCURRENCES_CHOICES
            )
        return self._chunked_get_elements(
            self.get_payload,
            items=items,
            delete_type=delete_type,
            send_meeting_cancellations=send_meeting_cancellations,
            affected_task_occurrences=affected_task_occurrences,
            suppress_read_receipts=suppress_read_receipts,
        )

    def get_payload(
        self, items, delete_type, send_meeting_cancellations, affected_task_occurrences, suppress_read_receipts
    ):
        # Takes a list of (id, changekey) tuples or Item objects and returns the XML for a DeleteItem request.
        attrs = dict(
            DeleteType=delete_type,
            SendMeetingCancellations=send_meeting_cancellations,
            AffectedTaskOccurrences=affected_task_occurrences,
        )
        if self.account.version.build &gt;= EXCHANGE_2013_SP1:
            attrs[&#34;SuppressReadReceipts&#34;] = suppress_read_receipts
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=attrs)
        payload.append(item_ids_element(items=items, version=self.account.version))
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.DeleteItem.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.DeleteItem.returns_elements"><code class="name">var <span class="ident">returns_elements</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.DeleteItem.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, items, delete_type, send_meeting_cancellations, affected_task_occurrences, suppress_read_receipts)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, items, delete_type, send_meeting_cancellations, affected_task_occurrences, suppress_read_receipts):
    if delete_type not in DELETE_TYPE_CHOICES:
        raise InvalidEnumValue(&#34;delete_type&#34;, delete_type, DELETE_TYPE_CHOICES)
    if send_meeting_cancellations not in SEND_MEETING_CANCELLATIONS_CHOICES:
        raise InvalidEnumValue(
            &#34;send_meeting_cancellations&#34;, send_meeting_cancellations, SEND_MEETING_CANCELLATIONS_CHOICES
        )
    if affected_task_occurrences not in AFFECTED_TASK_OCCURRENCES_CHOICES:
        raise InvalidEnumValue(
            &#34;affected_task_occurrences&#34;, affected_task_occurrences, AFFECTED_TASK_OCCURRENCES_CHOICES
        )
    return self._chunked_get_elements(
        self.get_payload,
        items=items,
        delete_type=delete_type,
        send_meeting_cancellations=send_meeting_cancellations,
        affected_task_occurrences=affected_task_occurrences,
        suppress_read_receipts=suppress_read_receipts,
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.DeleteItem.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, items, delete_type, send_meeting_cancellations, affected_task_occurrences, suppress_read_receipts)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(
    self, items, delete_type, send_meeting_cancellations, affected_task_occurrences, suppress_read_receipts
):
    # Takes a list of (id, changekey) tuples or Item objects and returns the XML for a DeleteItem request.
    attrs = dict(
        DeleteType=delete_type,
        SendMeetingCancellations=send_meeting_cancellations,
        AffectedTaskOccurrences=affected_task_occurrences,
    )
    if self.account.version.build &gt;= EXCHANGE_2013_SP1:
        attrs[&#34;SuppressReadReceipts&#34;] = suppress_read_receipts
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=attrs)
    payload.append(item_ids_element(items=items, version=self.account.version))
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.DeleteUserConfiguration"><code class="flex name class">
<span>class <span class="ident">DeleteUserConfiguration</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/deleteuserconfiguration-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/deleteuserconfiguration-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DeleteUserConfiguration(EWSAccountService):
    &#34;&#34;&#34;MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/deleteuserconfiguration-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;DeleteUserConfiguration&#34;
    returns_elements = False

    def call(self, user_configuration_name):
        return self._get_elements(payload=self.get_payload(user_configuration_name=user_configuration_name))

    def get_payload(self, user_configuration_name):
        return set_xml_value(
            create_element(f&#34;m:{self.SERVICE_NAME}&#34;), user_configuration_name, version=self.account.version
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.DeleteUserConfiguration.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.DeleteUserConfiguration.returns_elements"><code class="name">var <span class="ident">returns_elements</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.DeleteUserConfiguration.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, user_configuration_name)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, user_configuration_name):
    return self._get_elements(payload=self.get_payload(user_configuration_name=user_configuration_name))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.DeleteUserConfiguration.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, user_configuration_name)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, user_configuration_name):
    return set_xml_value(
        create_element(f&#34;m:{self.SERVICE_NAME}&#34;), user_configuration_name, version=self.account.version
    )</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.EWSService"><code class="flex name class">
<span>class <span class="ident">EWSService</span></span>
<span>(</span><span>protocol, chunk_size=None, timeout=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Base class for all EWS services.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class EWSService(SupportedVersionClassMixIn, metaclass=abc.ABCMeta):
    &#34;&#34;&#34;Base class for all EWS services.&#34;&#34;&#34;

    CHUNK_SIZE = 100  # A default chunk size for all services. This is the number of items we send in a single request

    SERVICE_NAME = None  # The name of the SOAP service
    element_container_name = None  # The name of the XML element wrapping the collection of returned items
    returns_elements = True  # If False, the service does not return response elements, just the ResponseCode status
    # Return exception instance instead of raising exceptions for the following errors when contained in an element
    ERRORS_TO_CATCH_IN_RESPONSE = (
        EWSWarning,
        ErrorCannotDeleteObject,
        ErrorInvalidChangeKey,
        ErrorItemNotFound,
        ErrorItemSave,
        ErrorInvalidIdMalformed,
        ErrorMessageSizeExceeded,
        ErrorCannotDeleteTaskOccurrence,
        ErrorMimeContentConversionFailed,
        ErrorRecurrenceHasNoOccurrence,
        ErrorCorruptData,
        ErrorItemCorrupt,
        ErrorMailRecipientNotFound,
    )
    # Similarly, define the warnings we want to return un-raised
    WARNINGS_TO_CATCH_IN_RESPONSE = ErrorBatchProcessingStopped
    # Define the warnings we want to ignore, to let response processing proceed
    WARNINGS_TO_IGNORE_IN_RESPONSE = ()
    # The exception type to raise when all attempted API versions failed
    NO_VALID_SERVER_VERSIONS = ErrorInvalidServerVersion

    NS_MAP = {k: v for k, v in ns_translation.items() if k in (&#34;s&#34;, &#34;m&#34;, &#34;t&#34;)}

    def __init__(self, protocol, chunk_size=None, timeout=None):
        self.chunk_size = chunk_size or self.CHUNK_SIZE
        if not isinstance(self.chunk_size, int):
            raise InvalidTypeError(&#34;chunk_size&#34;, chunk_size, int)
        if self.chunk_size &lt; 1:
            raise ValueError(f&#34;&#39;chunk_size&#39; {self.chunk_size} must be a positive number&#34;)
        if self.supported_from and protocol.version.build &lt; self.supported_from:
            raise NotImplementedError(
                f&#34;Service {self.SERVICE_NAME!r} only supports server versions from {self.supported_from or &#39;*&#39;} to &#34;
                f&#34;{self.deprecated_from or &#39;*&#39;} (server has {protocol.version})&#34;
            )
        self.protocol = protocol
        # Allow a service to override the default protocol timeout. Useful for streaming services
        self.timeout = timeout
        # Controls whether the HTTP request should be streaming or fetch everything at once
        self.streaming = False
        # Streaming connection variables
        self._streaming_session = None
        self._streaming_response = None

    def __del__(self):
        # pylint: disable=bare-except
        try:
            if self.streaming:
                # Make sure to clean up lingering resources
                self.stop_streaming()
        except Exception:  # nosec
            # __del__ should never fail
            pass

    # The following two methods are the minimum required to be implemented by subclasses, but the name and number of
    # kwargs differs between services. Therefore, we cannot make these methods abstract.

    # @abc.abstractmethod
    # def call(self, **kwargs):
    #     &#34;&#34;&#34;Defines the arguments required by the service. Arguments are basic Python types or EWSElement objects.
    #     Returns either XML objects or EWSElement objects.
    #     &#34;&#34;&#34;&#34;
    #     pass

    # @abc.abstractmethod
    # def get_payload(self, **kwargs):
    #     &#34;&#34;&#34;Using the arguments from .call(), return the payload expected by the service, as an XML object. The XML
    #     object should consist of a SERVICE_NAME element and everything within that.
    #     &#34;&#34;&#34;
    #     pass

    def get(self, expect_result=True, **kwargs):
        &#34;&#34;&#34;Like .call(), but expects exactly one result from the server, or zero when expect_result=False, or either
        zero or one when expect_result=None. Returns either one object or None.

        :param expect_result: None, True, or False
        :param kwargs: Same as arguments for .call()
        :return: Same as .call(), but returns either None or exactly one item
        &#34;&#34;&#34;
        res = list(self.call(**kwargs))
        # Raise any errors
        for r in res:
            if isinstance(r, Exception):
                raise r
        if expect_result is None and not res:
            # Allow empty result
            return None
        if expect_result is False:
            if res:
                raise ValueError(f&#34;Expected result length 0, but got {res}&#34;)
            return None
        if len(res) != 1:
            raise ValueError(f&#34;Expected result length 1, but got {res}&#34;)
        return res[0]

    def parse(self, xml):
        &#34;&#34;&#34;Used mostly for testing, when we want to parse static XML data.&#34;&#34;&#34;
        resp = DummyResponse(content=xml, streaming=self.streaming)
        _, body = self._get_soap_parts(response=resp)
        return self._elems_to_objs(self._get_elements_in_response(response=self._get_soap_messages(body=body)))

    def wrap(self, content, api_version=None):
        &#34;&#34;&#34;Generate the necessary boilerplate XML for a raw SOAP request. The XML is specific to the server version.
        ExchangeImpersonation allows to act as the user we want to impersonate.

        RequestServerVersion element on MSDN:
        https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/requestserverversion

        ExchangeImpersonation element on MSDN:
        https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/exchangeimpersonation

        TimeZoneContent element on MSDN:
        https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/timezonecontext

        :param content:
        :param api_version:
        &#34;&#34;&#34;
        envelope = create_element(&#34;s:Envelope&#34;, nsmap=self.NS_MAP)
        header = create_element(&#34;s:Header&#34;)
        if api_version:
            request_server_version = create_element(&#34;t:RequestServerVersion&#34;, attrs=dict(Version=api_version))
            header.append(request_server_version)
        identity = self._account_to_impersonate
        if identity:
            add_xml_child(header, &#34;t:ExchangeImpersonation&#34;, identity)
        timezone = self._timezone
        if timezone:
            timezone_context = create_element(&#34;t:TimeZoneContext&#34;)
            timezone_definition = create_element(&#34;t:TimeZoneDefinition&#34;, attrs=dict(Id=timezone.ms_id))
            timezone_context.append(timezone_definition)
            header.append(timezone_context)
        if len(header):
            envelope.append(header)
        body = create_element(&#34;s:Body&#34;)
        body.append(content)
        envelope.append(body)
        return xml_to_str(envelope, encoding=DEFAULT_ENCODING, xml_declaration=True)

    def _elems_to_objs(self, elems):
        &#34;&#34;&#34;Takes a generator of XML elements and exceptions. Returns the equivalent Python objects (or exceptions).&#34;&#34;&#34;
        for elem in elems:
            # Allow None here. Some services don&#39;t return an ID if the target folder is outside the mailbox.
            if isinstance(elem, (Exception, type(None))):
                yield elem
                continue
            yield self._elem_to_obj(elem)

    def _elem_to_obj(self, elem):
        if not self.returns_elements:
            raise RuntimeError(&#34;Incorrect call to method when &#39;returns_elements&#39; is False&#34;)
        raise NotImplementedError()

    @property
    def _version_hint(self):
        # We may be here due to version guessing in Protocol.version, so we can&#39;t use the self.protocol.version property
        return self.protocol.config.version

    @_version_hint.setter
    def _version_hint(self, value):
        self.protocol.config.version = value

    def _extra_headers(self):
        headers = {}
        identity = self._account_to_impersonate
        if identity and identity.primary_smtp_address:
            # See
            # https://blogs.msdn.microsoft.com/webdav_101/2015/05/11/best-practices-ews-authentication-and-access-issues/
            headers[&#34;X-AnchorMailbox&#34;] = identity.primary_smtp_address
        return headers

    @property
    def _account_to_impersonate(self):
        if self.protocol and isinstance(self.protocol.credentials, BaseOAuth2Credentials):
            return self.protocol.credentials.identity
        return None

    @property
    def _timezone(self):
        return None

    def _response_generator(self, payload):
        &#34;&#34;&#34;Send the payload to the server, and return the response.

        :param payload: payload as an XML object
        :return: the response, as XML objects
        &#34;&#34;&#34;
        response = self._get_response_xml(payload=payload)
        return self._get_elements_in_response(response=response)

    def _chunked_get_elements(self, payload_func, items, **kwargs):
        &#34;&#34;&#34;Yield elements in a response. Like ._get_elements(), but chop items into suitable chunks and send multiple
        requests.

        :param payload_func: A reference to .payload()
        :param items: An iterable of items (messages, folders, etc.) to process
        :param kwargs: Same as arguments for .call(), except for the &#39;items&#39; argument
        :return: Same as ._get_elements()
        &#34;&#34;&#34;
        # If the input for a service is a QuerySet, it can be difficult to remove exceptions before now
        filtered_items = filter(lambda item: not isinstance(item, Exception), items)
        for i, chunk in enumerate(chunkify(filtered_items, self.chunk_size), start=1):
            log.debug(&#34;Processing chunk %s containing %s items&#34;, i, len(chunk))
            yield from self._get_elements(payload=payload_func(chunk, **kwargs))

    def stop_streaming(self):
        if not self.streaming:
            raise RuntimeError(&#34;Attempt to stop a non-streaming service&#34;)
        if self._streaming_response:
            self._streaming_response.close()  # Release memory
            self._streaming_response = None
        if self._streaming_session:
            self.protocol.release_session(self._streaming_session)
            self._streaming_session = None

    def _get_elements(self, payload):
        &#34;&#34;&#34;Send the payload to be sent and parsed. Handles and re-raise exceptions that are not meant to be returned
        to the caller as exception objects. Retry the request according to the retry policy.
        &#34;&#34;&#34;
        wait = self.protocol.RETRY_WAIT
        while True:
            try:
                # Create a generator over the response elements so exceptions in response elements are also raised
                # here and can be handled.
                yield from self._response_generator(payload=payload)
                # TODO: Restore session pool size on succeeding request?
                return
            except TokenExpiredError:
                # Retry immediately
                continue
            except ErrorServerBusy as e:
                if not e.back_off:
                    e.back_off = wait
                self._handle_backoff(e)
            except ErrorExceededConnectionCount as e:
                # ErrorExceededConnectionCount indicates that the connecting user has too many open TCP connections to
                # the server. Decrease our session pool size and retry immediately.
                try:
                    self.protocol.decrease_poolsize()
                    continue
                except SessionPoolMinSizeReached:
                    # We&#39;re already as low as we can go. Let the user handle this.
                    raise e
            except ErrorTimeoutExpired as e:
                # ErrorTimeoutExpired can be caused by a busy server, or by an overly large request. If it&#39;s the latter,
                # we don&#39;t want to continue hammering the server with this request indefinitely. Instead, lower the
                # connection count, if possible, and retry the request.
                if self.protocol.session_pool_size &lt;= 1:
                    # We&#39;re already as low as we can go. We can no longer use the session count to put less load
                    # on the server. If this is a chunked request we could lower the chunk size, but we don&#39;t have a
                    # way of doing that from this part of the code yet. Let the user handle this.
                    raise e
                self._handle_backoff(ErrorServerBusy(f&#34;Reraised from {e.__class__.__name__}({e})&#34;, back_off=wait))
            except (ErrorTooManyObjectsOpened, ErrorInternalServerTransientError) as e:
                # ErrorTooManyObjectsOpened means there are too many connections to the Exchange database. This is very
                # often a symptom of sending too many requests.
                self._handle_backoff(ErrorServerBusy(f&#34;Reraised from {e.__class__.__name__}({e})&#34;, back_off=wait))
            finally:
                wait *= 2  # Increase delay for every retry
                if self.streaming:
                    self.stop_streaming()

    def _handle_response_cookies(self, session):
        pass

    def _get_response(self, payload, api_version):
        &#34;&#34;&#34;Send the actual HTTP request and get the response.&#34;&#34;&#34;
        if self.streaming:
            # Make sure to clean up lingering resources
            self.stop_streaming()
        session = self.protocol.get_session()
        r, session = post_ratelimited(
            protocol=self.protocol,
            session=session,
            url=self.protocol.service_endpoint,
            headers=self._extra_headers(),
            data=self.wrap(
                content=payload,
                api_version=api_version,
            ),
            stream=self.streaming,
            timeout=self.timeout or self.protocol.TIMEOUT,
        )
        self._handle_response_cookies(session)
        if self.streaming:
            # We con only release the session when we have fully consumed the response. Save session and response
            # objects for later.
            self._streaming_session, self._streaming_response = session, r
        else:
            self.protocol.release_session(session)
        return r

    @classmethod
    def supported_api_versions(cls):
        &#34;&#34;&#34;Return API versions supported by the service, sorted from newest to oldest&#34;&#34;&#34;
        return sorted({v.api_version for v in Version.all_versions() if cls.supports_version(v)}, reverse=True)

    def _api_versions_to_try(self):
        # Put the hint first in the list, and then all other versions except the hint, from newest to oldest
        return (self._version_hint.api_version,) + tuple(
            v for v in self.supported_api_versions() if v != self._version_hint.api_version
        )

    def _get_response_xml(self, payload, **parse_opts):
        &#34;&#34;&#34;Send the payload to the server and return relevant elements from the result. Several things happen here:
          * The payload is wrapped in SOAP headers and sent to the server
          * The Exchange API version is negotiated and stored in the protocol object
          * Connection errors are handled and possibly reraised as ErrorServerBusy
          * SOAP errors are raised
          * EWS errors are raised, or passed on to the caller

        :param payload: The request payload, as an XML object
        :return: A generator of XML objects or None if the service does not return a result
        &#34;&#34;&#34;
        # Microsoft really doesn&#39;t want to make our lives easy. The server may report one version in our initial version
        # guessing tango, but then the server may decide that any arbitrary legacy backend server may actually process
        # the request for an account. Prepare to handle version-related errors and set the server version per-account.
        log.debug(&#34;Calling service %s&#34;, self.SERVICE_NAME)
        for api_version in self._api_versions_to_try():
            log.debug(&#34;Trying API version %s&#34;, api_version)
            r = self._get_response(payload=payload, api_version=api_version)
            if self.streaming:
                # Let &#39;requests&#39; decode raw data automatically
                r.raw.decode_content = True
            try:
                header, body = self._get_soap_parts(response=r, **parse_opts)
            except Exception:
                r.close()  # Release memory
                raise
            # The body may contain error messages from Exchange, but we still want to collect version info
            if header is not None:
                self._update_api_version(api_version=api_version, header=header, **parse_opts)
            try:
                return self._get_soap_messages(body=body, **parse_opts)
            except (
                ErrorInvalidServerVersion,
                ErrorIncorrectSchemaVersion,
                ErrorInvalidRequest,
                ErrorInvalidSchemaVersionForMailboxVersion,
            ):
                # The guessed server version is wrong. Try the next version
                log.debug(&#34;API version %s was invalid&#34;, api_version)
                continue
            finally:
                if not self.streaming:
                    # In streaming mode, we may not have accessed the raw stream yet. Caller must handle this.
                    r.close()  # Release memory

        raise self.NO_VALID_SERVER_VERSIONS(f&#34;Tried versions {self._api_versions_to_try()} but all were invalid&#34;)

    def _handle_backoff(self, e):
        &#34;&#34;&#34;Take a request from the server to back off and checks the retry policy for what to do. Re-raise the
        exception if conditions are not met.

        :param e: An ErrorServerBusy instance
        :return:
        &#34;&#34;&#34;
        log.debug(&#34;Got ErrorServerBusy (back off %s seconds)&#34;, e.back_off)
        # ErrorServerBusy is very often a symptom of sending too many requests. Scale back connections if possible.
        with suppress(SessionPoolMinSizeReached):
            self.protocol.decrease_poolsize()
        if self.protocol.retry_policy.fail_fast:
            raise e
        self.protocol.retry_policy.back_off(e.back_off)
        # We&#39;ll warn about this later if we actually need to sleep

    def _update_api_version(self, api_version, header, **parse_opts):
        &#34;&#34;&#34;Parse the server version contained in SOAP headers and update the version hint stored by the caller, if
        necessary.
        &#34;&#34;&#34;
        try:
            head_version = Version.from_soap_header(requested_api_version=api_version, header=header)
        except TransportError as te:
            log.debug(&#34;Failed to update version info (%s)&#34;, te)
            return
        if self._version_hint == head_version:
            # Nothing to do
            return
        log.debug(&#34;Found new version (%s -&gt; %s)&#34;, self._version_hint, head_version)
        # The api_version that worked was different from our hint, or we never got a build version. Store the working
        # version.
        self._version_hint = head_version

    @classmethod
    def _response_tag(cls):
        &#34;&#34;&#34;Return the name of the element containing the service response.&#34;&#34;&#34;
        return f&#34;{{{MNS}}}{cls.SERVICE_NAME}Response&#34;

    @staticmethod
    def _response_messages_tag():
        &#34;&#34;&#34;Return the name of the element containing service response messages.&#34;&#34;&#34;
        return f&#34;{{{MNS}}}ResponseMessages&#34;

    @classmethod
    def _response_message_tag(cls):
        &#34;&#34;&#34;Return the name of the element of a single response message.&#34;&#34;&#34;
        return f&#34;{{{MNS}}}{cls.SERVICE_NAME}ResponseMessage&#34;

    @classmethod
    def _get_soap_parts(cls, response, **parse_opts):
        &#34;&#34;&#34;Split the SOAP response into its headers and body elements.&#34;&#34;&#34;
        try:
            root = to_xml(response.iter_content())
        except ParseError as e:
            raise SOAPError(f&#34;Bad SOAP response: {e}&#34;)
        header = root.find(f&#34;{{{SOAPNS}}}Header&#34;)
        if header is None:
            # This is normal when the response contains SOAP-level errors
            log.debug(&#34;No header in XML response&#34;)
        body = root.find(f&#34;{{{SOAPNS}}}Body&#34;)
        if body is None:
            raise MalformedResponseError(&#34;No Body element in SOAP response&#34;)
        return header, body

    def _get_soap_messages(self, body, **parse_opts):
        &#34;&#34;&#34;Return the elements in the response containing the response messages. Raises any SOAP exceptions.&#34;&#34;&#34;
        response = body.find(self._response_tag())
        if response is None:
            fault = body.find(f&#34;{{{SOAPNS}}}Fault&#34;)
            if fault is None:
                raise SOAPError(f&#34;Unknown SOAP response (expected {self._response_tag()} or Fault): {xml_to_str(body)}&#34;)
            self._raise_soap_errors(fault=fault)  # Will throw SOAPError or custom EWS error
        response_messages = response.find(self._response_messages_tag())
        if response_messages is None:
            # Result isn&#39;t delivered in a list of FooResponseMessages, but directly in the FooResponse. Consumers expect
            # a list, so return a list
            return [response]
        return response_messages.findall(self._response_message_tag())

    @classmethod
    def _raise_soap_errors(cls, fault):
        &#34;&#34;&#34;Parse error messages contained in SOAP headers and raise as exceptions defined in this package.&#34;&#34;&#34;
        # Fault: See http://www.w3.org/TR/2000/NOTE-SOAP-20000508/#_Toc478383507
        fault_code = get_xml_attr(fault, &#34;faultcode&#34;)
        fault_string = get_xml_attr(fault, &#34;faultstring&#34;)
        fault_actor = get_xml_attr(fault, &#34;faultactor&#34;)
        detail = fault.find(&#34;detail&#34;)
        if detail is not None:
            code = get_xml_attr(detail, f&#34;{{{ENS}}}ResponseCode&#34;)
            if code:
                code = code.strip()
            msg = get_xml_attr(detail, f&#34;{{{ENS}}}Message&#34;)
            if msg:
                msg = msg.strip()
            msg_xml = detail.find(f&#34;{{{TNS}}}MessageXml&#34;)  # Crazy. Here, it&#39;s in the TNS namespace
            if code == &#34;ErrorServerBusy&#34;:
                back_off = None
                with suppress(TypeError, AttributeError):
                    value = msg_xml.find(f&#34;{{{TNS}}}Value&#34;)
                    if value.get(&#34;Name&#34;) == &#34;BackOffMilliseconds&#34;:
                        back_off = int(value.text) / 1000.0  # Convert to seconds
                raise ErrorServerBusy(msg, back_off=back_off)
            if code == &#34;ErrorSchemaValidation&#34; and msg_xml is not None:
                line_number = get_xml_attr(msg_xml, f&#34;{{{TNS}}}LineNumber&#34;)
                line_position = get_xml_attr(msg_xml, f&#34;{{{TNS}}}LinePosition&#34;)
                violation = get_xml_attr(msg_xml, f&#34;{{{TNS}}}Violation&#34;)
                if violation:
                    msg = f&#34;{msg} {violation}&#34;
                if line_number or line_position:
                    msg = f&#34;{msg} (line: {line_number} position: {line_position})&#34;
            try:
                raise vars(errors)[code](msg)
            except KeyError:
                detail = f&#34;{cls.SERVICE_NAME}: code: {code} msg: {msg} ({xml_to_str(detail)})&#34;
        with suppress(KeyError):
            raise vars(errors)[fault_code](fault_string)
        raise SOAPError(f&#34;SOAP error code: {fault_code} string: {fault_string} actor: {fault_actor} detail: {detail}&#34;)

    def _get_element_container(self, message, name=None):
        &#34;&#34;&#34;Return the XML element in a response element that contains the elements we want the service to return. For
        example, in a GetFolder response, &#39;message&#39; is the GetFolderResponseMessage element, and we return the &#39;Folders&#39;
        element:

        &lt;m:GetFolderResponseMessage ResponseClass=&#34;Success&#34;&gt;
          &lt;m:ResponseCode&gt;NoError&lt;/m:ResponseCode&gt;
          &lt;m:Folders&gt;
            &lt;t:Folder&gt;
              &lt;t:FolderId Id=&#34;AQApA=&#34; ChangeKey=&#34;AQAAAB&#34; /&gt;
              [...]
            &lt;/t:Folder&gt;
          &lt;/m:Folders&gt;
        &lt;/m:GetFolderResponseMessage&gt;

        Some service responses don&#39;t have a containing element for the returned elements (&#39;name&#39; is None). In
        that case, we return the &#39;SomeServiceResponseMessage&#39; element.

        If the response contains a warning or an error message, we raise the relevant exception, unless the error class
        is contained in WARNINGS_TO_CATCH_IN_RESPONSE or ERRORS_TO_CATCH_IN_RESPONSE, in which case we return the
        exception instance.
        &#34;&#34;&#34;
        # ResponseClass is an XML attribute of various SomeServiceResponseMessage elements: Possible values are:
        # Success, Warning, Error. See e.g.
        # https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/finditemresponsemessage
        response_class = message.get(&#34;ResponseClass&#34;)
        # ResponseCode, MessageText: See
        # https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/responsecode
        response_code = get_xml_attr(message, f&#34;{{{MNS}}}ResponseCode&#34;)
        if response_class == &#34;Success&#34; and response_code == &#34;NoError&#34;:
            if not name:
                return message
            container = message.find(name)
            if container is None:
                raise MalformedResponseError(f&#34;No {name} elements in ResponseMessage ({xml_to_str(message)})&#34;)
            return container
        if response_code == &#34;NoError&#34;:
            return True
        # Raise any non-acceptable errors in the container, or return the container or the acceptable exception instance
        msg_text = get_xml_attr(message, f&#34;{{{MNS}}}MessageText&#34;)
        msg_xml = message.find(f&#34;{{{MNS}}}MessageXml&#34;)
        if response_class == &#34;Warning&#34;:
            try:
                raise self._get_exception(code=response_code, text=msg_text, msg_xml=msg_xml)
            except self.WARNINGS_TO_CATCH_IN_RESPONSE as e:
                return e
            except self.WARNINGS_TO_IGNORE_IN_RESPONSE as e:
                log.warning(str(e))
                container = message.find(name)
                if container is None:
                    raise MalformedResponseError(f&#34;No {name} elements in ResponseMessage ({xml_to_str(message)})&#34;)
                return container
        # response_class == &#39;Error&#39;, or &#39;Success&#39; and not &#39;NoError&#39;
        try:
            raise self._get_exception(code=response_code, text=msg_text, msg_xml=msg_xml)
        except self.ERRORS_TO_CATCH_IN_RESPONSE as e:
            return e

    @staticmethod
    def _get_exception(code, text, msg_xml):
        &#34;&#34;&#34;Parse error messages contained in EWS responses and raise as exceptions defined in this package.&#34;&#34;&#34;
        if not code:
            return TransportError(f&#34;Empty ResponseCode in ResponseMessage (MessageText: {text}, MessageXml: {msg_xml})&#34;)
        if msg_xml is not None:
            # If this is an ErrorInvalidPropertyRequest error, the xml may contain a specific FieldURI
            for elem_cls in (FieldURI, IndexedFieldURI, ExtendedFieldURI, ExceptionFieldURI):
                elem = msg_xml.find(elem_cls.response_tag())
                if elem is not None:
                    field_uri = elem_cls.from_xml(elem, account=None)
                    text += f&#34; (field: {field_uri})&#34;
                    break

            # If this is an ErrorInvalidValueForProperty error, the xml may contain the name and value of the property
            if code == &#34;ErrorInvalidValueForProperty&#34;:
                msg_parts = {}
                for elem in msg_xml.findall(f&#34;{{{TNS}}}Value&#34;):
                    key, val = elem.get(&#34;Name&#34;), elem.text
                    if key:
                        msg_parts[key] = val
                if msg_parts:
                    text += f&#34; ({&#39;, &#39;.join(f&#39;{k}: {v}&#39; for k, v in msg_parts.items())})&#34;

            # If this is an ErrorInternalServerError error, the xml may contain a more specific error code
            inner_code, inner_text = None, None
            for value_elem in msg_xml.findall(f&#34;{{{TNS}}}Value&#34;):
                name = value_elem.get(&#34;Name&#34;)
                if name == &#34;InnerErrorResponseCode&#34;:
                    inner_code = value_elem.text
                elif name == &#34;InnerErrorMessageText&#34;:
                    inner_text = value_elem.text
            if inner_code:
                try:
                    # Raise the error as the inner error code
                    return vars(errors)[inner_code](f&#34;{inner_text} (raised from: {code}({text!r}))&#34;)
                except KeyError:
                    # Inner code is unknown to us. Just append to the original text
                    text += f&#34; (inner error: {inner_code}({inner_text!r}))&#34;
        try:
            # Raise the error corresponding to the ResponseCode
            return vars(errors)[code](text)
        except KeyError:
            # Should not happen
            return TransportError(
                f&#34;Unknown ResponseCode in ResponseMessage: {code} (MessageText: {text}, MessageXml: {msg_xml})&#34;
            )

    def _get_elements_in_response(self, response):
        &#34;&#34;&#34;Take a list of &#39;SomeServiceResponseMessage&#39; elements and return the elements in each response message that
        we want the service to return. With e.g. &#39;CreateItem&#39;, we get a list of &#39;CreateItemResponseMessage&#39; elements
        and return the &#39;Message&#39; elements.

        &lt;m:CreateItemResponseMessage ResponseClass=&#34;Success&#34;&gt;
          &lt;m:ResponseCode&gt;NoError&lt;/m:ResponseCode&gt;
          &lt;m:Items&gt;
            &lt;t:Message&gt;
              &lt;t:ItemId Id=&#34;AQApA=&#34; ChangeKey=&#34;AQAAAB&#34;/&gt;
            &lt;/t:Message&gt;
          &lt;/m:Items&gt;
        &lt;/m:CreateItemResponseMessage&gt;
        &lt;m:CreateItemResponseMessage ResponseClass=&#34;Success&#34;&gt;
          &lt;m:ResponseCode&gt;NoError&lt;/m:ResponseCode&gt;
          &lt;m:Items&gt;
            &lt;t:Message&gt;
              &lt;t:ItemId Id=&#34;AQApB=&#34; ChangeKey=&#34;AQAAAC&#34;/&gt;
            &lt;/t:Message&gt;
          &lt;/m:Items&gt;
        &lt;/m:CreateItemResponseMessage&gt;

        :param response: a list of &#39;SomeServiceResponseMessage&#39; XML objects
        :return: a generator of items as returned by &#39;_get_elements_in_container()
        &#34;&#34;&#34;
        for msg in response:
            container_or_exc = self._get_element_container(message=msg, name=self.element_container_name)
            if isinstance(container_or_exc, (bool, Exception)):
                yield container_or_exc
            else:
                for c in self._get_elements_in_container(container=container_or_exc):
                    yield c

    @classmethod
    def _get_elements_in_container(cls, container):
        &#34;&#34;&#34;Return a list of response elements from an XML response element container. With e.g.
        &#39;CreateItem&#39;, &#39;Items&#39; is the container element, and we return the &#39;Message&#39; child elements:

          &lt;m:Items&gt;
            &lt;t:Message&gt;
              &lt;t:ItemId Id=&#34;AQApA=&#34; ChangeKey=&#34;AQAAAB&#34;/&gt;
            &lt;/t:Message&gt;
          &lt;/m:Items&gt;

        If the service does not return response elements, return True to indicate the status. Errors have already been
        raised.
        &#34;&#34;&#34;
        if cls.returns_elements:
            return list(container)
        return [True]</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.convert_id.ConvertId" href="convert_id.html#exchangelib.services.convert_id.ConvertId">ConvertId</a></li>
<li><a title="exchangelib.services.expand_dl.ExpandDL" href="expand_dl.html#exchangelib.services.expand_dl.ExpandDL">ExpandDL</a></li>
<li><a title="exchangelib.services.get_mail_tips.GetMailTips" href="get_mail_tips.html#exchangelib.services.get_mail_tips.GetMailTips">GetMailTips</a></li>
<li><a title="exchangelib.services.get_room_lists.GetRoomLists" href="get_room_lists.html#exchangelib.services.get_room_lists.GetRoomLists">GetRoomLists</a></li>
<li><a title="exchangelib.services.get_rooms.GetRooms" href="get_rooms.html#exchangelib.services.get_rooms.GetRooms">GetRooms</a></li>
<li><a title="exchangelib.services.get_searchable_mailboxes.GetSearchableMailboxes" href="get_searchable_mailboxes.html#exchangelib.services.get_searchable_mailboxes.GetSearchableMailboxes">GetSearchableMailboxes</a></li>
<li><a title="exchangelib.services.get_server_time_zones.GetServerTimeZones" href="get_server_time_zones.html#exchangelib.services.get_server_time_zones.GetServerTimeZones">GetServerTimeZones</a></li>
<li><a title="exchangelib.services.get_user_availability.GetUserAvailability" href="get_user_availability.html#exchangelib.services.get_user_availability.GetUserAvailability">GetUserAvailability</a></li>
<li><a title="exchangelib.services.get_user_settings.GetUserSettings" href="get_user_settings.html#exchangelib.services.get_user_settings.GetUserSettings">GetUserSettings</a></li>
<li><a title="exchangelib.services.resolve_names.ResolveNames" href="resolve_names.html#exchangelib.services.resolve_names.ResolveNames">ResolveNames</a></li>
<li><a title="exchangelib.services.send_notification.SendNotification" href="send_notification.html#exchangelib.services.send_notification.SendNotification">SendNotification</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.EWSService.CHUNK_SIZE"><code class="name">var <span class="ident">CHUNK_SIZE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.EWSService.ERRORS_TO_CATCH_IN_RESPONSE"><code class="name">var <span class="ident">ERRORS_TO_CATCH_IN_RESPONSE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.EWSService.NO_VALID_SERVER_VERSIONS"><code class="name">var <span class="ident">NO_VALID_SERVER_VERSIONS</span></code></dt>
<dd>
<div class="desc"><p>Global error type within this module.</p></div>
</dd>
<dt id="exchangelib.services.EWSService.NS_MAP"><code class="name">var <span class="ident">NS_MAP</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.EWSService.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE"><code class="name">var <span class="ident">WARNINGS_TO_CATCH_IN_RESPONSE</span></code></dt>
<dd>
<div class="desc"><p>Global error type within this module.</p></div>
</dd>
<dt id="exchangelib.services.EWSService.WARNINGS_TO_IGNORE_IN_RESPONSE"><code class="name">var <span class="ident">WARNINGS_TO_IGNORE_IN_RESPONSE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.EWSService.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.EWSService.returns_elements"><code class="name">var <span class="ident">returns_elements</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="exchangelib.services.EWSService.supported_api_versions"><code class="name flex">
<span>def <span class="ident">supported_api_versions</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Return API versions supported by the service, sorted from newest to oldest</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
def supported_api_versions(cls):
    &#34;&#34;&#34;Return API versions supported by the service, sorted from newest to oldest&#34;&#34;&#34;
    return sorted({v.api_version for v in Version.all_versions() if cls.supports_version(v)}, reverse=True)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.EWSService.get"><code class="name flex">
<span>def <span class="ident">get</span></span>(<span>self, expect_result=True, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Like .call(), but expects exactly one result from the server, or zero when expect_result=False, or either
zero or one when expect_result=None. Returns either one object or None.</p>
<p>:param expect_result: None, True, or False
:param kwargs: Same as arguments for .call()
:return: Same as .call(), but returns either None or exactly one item</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get(self, expect_result=True, **kwargs):
    &#34;&#34;&#34;Like .call(), but expects exactly one result from the server, or zero when expect_result=False, or either
    zero or one when expect_result=None. Returns either one object or None.

    :param expect_result: None, True, or False
    :param kwargs: Same as arguments for .call()
    :return: Same as .call(), but returns either None or exactly one item
    &#34;&#34;&#34;
    res = list(self.call(**kwargs))
    # Raise any errors
    for r in res:
        if isinstance(r, Exception):
            raise r
    if expect_result is None and not res:
        # Allow empty result
        return None
    if expect_result is False:
        if res:
            raise ValueError(f&#34;Expected result length 0, but got {res}&#34;)
        return None
    if len(res) != 1:
        raise ValueError(f&#34;Expected result length 1, but got {res}&#34;)
    return res[0]</code></pre>
</details>
</dd>
<dt id="exchangelib.services.EWSService.parse"><code class="name flex">
<span>def <span class="ident">parse</span></span>(<span>self, xml)</span>
</code></dt>
<dd>
<div class="desc"><p>Used mostly for testing, when we want to parse static XML data.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def parse(self, xml):
    &#34;&#34;&#34;Used mostly for testing, when we want to parse static XML data.&#34;&#34;&#34;
    resp = DummyResponse(content=xml, streaming=self.streaming)
    _, body = self._get_soap_parts(response=resp)
    return self._elems_to_objs(self._get_elements_in_response(response=self._get_soap_messages(body=body)))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.EWSService.stop_streaming"><code class="name flex">
<span>def <span class="ident">stop_streaming</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def stop_streaming(self):
    if not self.streaming:
        raise RuntimeError(&#34;Attempt to stop a non-streaming service&#34;)
    if self._streaming_response:
        self._streaming_response.close()  # Release memory
        self._streaming_response = None
    if self._streaming_session:
        self.protocol.release_session(self._streaming_session)
        self._streaming_session = None</code></pre>
</details>
</dd>
<dt id="exchangelib.services.EWSService.wrap"><code class="name flex">
<span>def <span class="ident">wrap</span></span>(<span>self, content, api_version=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Generate the necessary boilerplate XML for a raw SOAP request. The XML is specific to the server version.
ExchangeImpersonation allows to act as the user we want to impersonate.</p>
<p>RequestServerVersion element on MSDN:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/requestserverversion">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/requestserverversion</a></p>
<p>ExchangeImpersonation element on MSDN:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/exchangeimpersonation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/exchangeimpersonation</a></p>
<p>TimeZoneContent element on MSDN:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/timezonecontext">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/timezonecontext</a></p>
<p>:param content:
:param api_version:</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def wrap(self, content, api_version=None):
    &#34;&#34;&#34;Generate the necessary boilerplate XML for a raw SOAP request. The XML is specific to the server version.
    ExchangeImpersonation allows to act as the user we want to impersonate.

    RequestServerVersion element on MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/requestserverversion

    ExchangeImpersonation element on MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/exchangeimpersonation

    TimeZoneContent element on MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/timezonecontext

    :param content:
    :param api_version:
    &#34;&#34;&#34;
    envelope = create_element(&#34;s:Envelope&#34;, nsmap=self.NS_MAP)
    header = create_element(&#34;s:Header&#34;)
    if api_version:
        request_server_version = create_element(&#34;t:RequestServerVersion&#34;, attrs=dict(Version=api_version))
        header.append(request_server_version)
    identity = self._account_to_impersonate
    if identity:
        add_xml_child(header, &#34;t:ExchangeImpersonation&#34;, identity)
    timezone = self._timezone
    if timezone:
        timezone_context = create_element(&#34;t:TimeZoneContext&#34;)
        timezone_definition = create_element(&#34;t:TimeZoneDefinition&#34;, attrs=dict(Id=timezone.ms_id))
        timezone_context.append(timezone_definition)
        header.append(timezone_context)
    if len(header):
        envelope.append(header)
    body = create_element(&#34;s:Body&#34;)
    body.append(content)
    envelope.append(body)
    return xml_to_str(envelope, encoding=DEFAULT_ENCODING, xml_declaration=True)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="exchangelib.services.EmptyFolder"><code class="flex name class">
<span>class <span class="ident">EmptyFolder</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/emptyfolder-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/emptyfolder-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class EmptyFolder(EWSAccountService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/emptyfolder-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;EmptyFolder&#34;
    returns_elements = False

    def call(self, folders, delete_type, delete_sub_folders):
        if delete_type not in DELETE_TYPE_CHOICES:
            raise InvalidEnumValue(&#34;delete_type&#34;, delete_type, DELETE_TYPE_CHOICES)
        return self._chunked_get_elements(
            self.get_payload, items=folders, delete_type=delete_type, delete_sub_folders=delete_sub_folders
        )

    def get_payload(self, folders, delete_type, delete_sub_folders):
        payload = create_element(
            f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(DeleteType=delete_type, DeleteSubFolders=delete_sub_folders)
        )
        payload.append(folder_ids_element(folders=folders, version=self.account.version))
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.EmptyFolder.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.EmptyFolder.returns_elements"><code class="name">var <span class="ident">returns_elements</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.EmptyFolder.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, folders, delete_type, delete_sub_folders)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, folders, delete_type, delete_sub_folders):
    if delete_type not in DELETE_TYPE_CHOICES:
        raise InvalidEnumValue(&#34;delete_type&#34;, delete_type, DELETE_TYPE_CHOICES)
    return self._chunked_get_elements(
        self.get_payload, items=folders, delete_type=delete_type, delete_sub_folders=delete_sub_folders
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.EmptyFolder.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, folders, delete_type, delete_sub_folders)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, folders, delete_type, delete_sub_folders):
    payload = create_element(
        f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(DeleteType=delete_type, DeleteSubFolders=delete_sub_folders)
    )
    payload.append(folder_ids_element(folders=folders, version=self.account.version))
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.ExpandDL"><code class="flex name class">
<span>class <span class="ident">ExpandDL</span></span>
<span>(</span><span>protocol, chunk_size=None, timeout=None)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/expanddl-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/expanddl-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ExpandDL(EWSService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/expanddl-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;ExpandDL&#34;
    element_container_name = f&#34;{{{MNS}}}DLExpansion&#34;
    WARNINGS_TO_IGNORE_IN_RESPONSE = ErrorNameResolutionMultipleResults

    def call(self, distribution_list):
        return self._elems_to_objs(self._get_elements(payload=self.get_payload(distribution_list=distribution_list)))

    def _elem_to_obj(self, elem):
        return Mailbox.from_xml(elem, account=None)

    def get_payload(self, distribution_list):
        return set_xml_value(create_element(f&#34;m:{self.SERVICE_NAME}&#34;), distribution_list, version=self.protocol.version)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.ExpandDL.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.ExpandDL.WARNINGS_TO_IGNORE_IN_RESPONSE"><code class="name">var <span class="ident">WARNINGS_TO_IGNORE_IN_RESPONSE</span></code></dt>
<dd>
<div class="desc"><p>Global error type within this module.</p></div>
</dd>
<dt id="exchangelib.services.ExpandDL.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.ExpandDL.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, distribution_list)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, distribution_list):
    return self._elems_to_objs(self._get_elements(payload=self.get_payload(distribution_list=distribution_list)))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.ExpandDL.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, distribution_list)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, distribution_list):
    return set_xml_value(create_element(f&#34;m:{self.SERVICE_NAME}&#34;), distribution_list, version=self.protocol.version)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.ExportItems"><code class="flex name class">
<span>class <span class="ident">ExportItems</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/exportitems-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/exportitems-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ExportItems(EWSAccountService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/exportitems-operation&#34;&#34;&#34;

    ERRORS_TO_CATCH_IN_RESPONSE = ResponseMessageError
    SERVICE_NAME = &#34;ExportItems&#34;
    element_container_name = f&#34;{{{MNS}}}Data&#34;

    def call(self, items):
        return self._elems_to_objs(self._chunked_get_elements(self.get_payload, items=items))

    def _elem_to_obj(self, elem):
        return elem.text  # All we want is the 64bit string in the &#39;Data&#39; tag

    def get_payload(self, items):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        payload.append(item_ids_element(items=items, version=self.account.version))
        return payload

    # We need to override this since ExportItemsResponseMessage is formatted a bit differently.
    @classmethod
    def _get_elements_in_container(cls, container):
        return [container]</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.ExportItems.ERRORS_TO_CATCH_IN_RESPONSE"><code class="name">var <span class="ident">ERRORS_TO_CATCH_IN_RESPONSE</span></code></dt>
<dd>
<div class="desc"><p>Global error type within this module.</p></div>
</dd>
<dt id="exchangelib.services.ExportItems.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.ExportItems.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.ExportItems.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, items)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, items):
    return self._elems_to_objs(self._chunked_get_elements(self.get_payload, items=items))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.ExportItems.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, items)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, items):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    payload.append(item_ids_element(items=items, version=self.account.version))
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.FindFolder"><code class="flex name class">
<span>class <span class="ident">FindFolder</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/findfolder-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/findfolder-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class FindFolder(EWSPagingService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/findfolder-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;FindFolder&#34;
    element_container_name = f&#34;{{{TNS}}}Folders&#34;
    paging_container_name = f&#34;{{{MNS}}}RootFolder&#34;

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self.root = None  # A hack to communicate parsing args to _elems_to_objs()

    def call(self, folders, additional_fields, restriction, shape, depth, max_items, offset):
        &#34;&#34;&#34;Find sub-folders of a folder.

        :param folders: the folders to act on
        :param additional_fields: the extra fields that should be returned with the folder, as FieldPath objects
        :param restriction: Restriction object that defines the filters for the query
        :param shape: The set of attributes to return
        :param depth: How deep in the folder structure to search for folders
        :param max_items: The maximum number of items to return
        :param offset: the offset relative to the first item in the item collection. Usually 0.

        :return: XML elements for the matching folders
        &#34;&#34;&#34;
        if shape not in SHAPE_CHOICES:
            raise InvalidEnumValue(&#34;shape&#34;, shape, SHAPE_CHOICES)
        if depth not in FOLDER_TRAVERSAL_CHOICES:
            raise InvalidEnumValue(&#34;depth&#34;, depth, FOLDER_TRAVERSAL_CHOICES)
        roots = {f.root for f in folders}
        if len(roots) != 1:
            raise ValueError(f&#34;All folders must have the same root hierarchy ({roots})&#34;)
        self.root = roots.pop()
        return self._elems_to_objs(
            self._paged_call(
                payload_func=self.get_payload,
                max_items=max_items,
                folders=folders,
                **dict(
                    additional_fields=additional_fields,
                    restriction=restriction,
                    shape=shape,
                    depth=depth,
                    page_size=self.page_size,
                    offset=offset,
                ),
            )
        )

    def _elem_to_obj(self, elem):
        return Folder.from_xml_with_root(elem=elem, root=self.root)

    def get_payload(self, folders, additional_fields, restriction, shape, depth, page_size, offset=0):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(Traversal=depth))
        payload.append(
            shape_element(
                tag=&#34;m:FolderShape&#34;, shape=shape, additional_fields=additional_fields, version=self.account.version
            )
        )
        if self.account.version.build &gt;= EXCHANGE_2010:
            indexed_page_folder_view = create_element(
                &#34;m:IndexedPageFolderView&#34;,
                attrs=dict(MaxEntriesReturned=page_size, Offset=offset, BasePoint=&#34;Beginning&#34;),
            )
            payload.append(indexed_page_folder_view)
        else:
            if offset != 0:
                raise NotImplementedError(&#34;&#39;offset&#39; is only supported for Exchange 2010 servers and later&#34;)
        if restriction:
            payload.append(restriction.to_xml(version=self.account.version))
        payload.append(folder_ids_element(folders=folders, version=self.protocol.version, tag=&#34;m:ParentFolderIds&#34;))
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSPagingService" href="common.html#exchangelib.services.common.EWSPagingService">EWSPagingService</a></li>
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.FindFolder.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.FindFolder.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.FindFolder.paging_container_name"><code class="name">var <span class="ident">paging_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.FindFolder.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, folders, additional_fields, restriction, shape, depth, max_items, offset)</span>
</code></dt>
<dd>
<div class="desc"><p>Find sub-folders of a folder.</p>
<p>:param folders: the folders to act on
:param additional_fields: the extra fields that should be returned with the folder, as FieldPath objects
:param restriction: Restriction object that defines the filters for the query
:param shape: The set of attributes to return
:param depth: How deep in the folder structure to search for folders
:param max_items: The maximum number of items to return
:param offset: the offset relative to the first item in the item collection. Usually 0.</p>
<p>:return: XML elements for the matching folders</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, folders, additional_fields, restriction, shape, depth, max_items, offset):
    &#34;&#34;&#34;Find sub-folders of a folder.

    :param folders: the folders to act on
    :param additional_fields: the extra fields that should be returned with the folder, as FieldPath objects
    :param restriction: Restriction object that defines the filters for the query
    :param shape: The set of attributes to return
    :param depth: How deep in the folder structure to search for folders
    :param max_items: The maximum number of items to return
    :param offset: the offset relative to the first item in the item collection. Usually 0.

    :return: XML elements for the matching folders
    &#34;&#34;&#34;
    if shape not in SHAPE_CHOICES:
        raise InvalidEnumValue(&#34;shape&#34;, shape, SHAPE_CHOICES)
    if depth not in FOLDER_TRAVERSAL_CHOICES:
        raise InvalidEnumValue(&#34;depth&#34;, depth, FOLDER_TRAVERSAL_CHOICES)
    roots = {f.root for f in folders}
    if len(roots) != 1:
        raise ValueError(f&#34;All folders must have the same root hierarchy ({roots})&#34;)
    self.root = roots.pop()
    return self._elems_to_objs(
        self._paged_call(
            payload_func=self.get_payload,
            max_items=max_items,
            folders=folders,
            **dict(
                additional_fields=additional_fields,
                restriction=restriction,
                shape=shape,
                depth=depth,
                page_size=self.page_size,
                offset=offset,
            ),
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.FindFolder.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, folders, additional_fields, restriction, shape, depth, page_size, offset=0)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, folders, additional_fields, restriction, shape, depth, page_size, offset=0):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(Traversal=depth))
    payload.append(
        shape_element(
            tag=&#34;m:FolderShape&#34;, shape=shape, additional_fields=additional_fields, version=self.account.version
        )
    )
    if self.account.version.build &gt;= EXCHANGE_2010:
        indexed_page_folder_view = create_element(
            &#34;m:IndexedPageFolderView&#34;,
            attrs=dict(MaxEntriesReturned=page_size, Offset=offset, BasePoint=&#34;Beginning&#34;),
        )
        payload.append(indexed_page_folder_view)
    else:
        if offset != 0:
            raise NotImplementedError(&#34;&#39;offset&#39; is only supported for Exchange 2010 servers and later&#34;)
    if restriction:
        payload.append(restriction.to_xml(version=self.account.version))
    payload.append(folder_ids_element(folders=folders, version=self.protocol.version, tag=&#34;m:ParentFolderIds&#34;))
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSPagingService" href="common.html#exchangelib.services.common.EWSPagingService">EWSPagingService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSPagingService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSPagingService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSPagingService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSPagingService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSPagingService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSPagingService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.FindItem"><code class="flex name class">
<span>class <span class="ident">FindItem</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/finditem-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/finditem-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class FindItem(EWSPagingService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/finditem-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;FindItem&#34;
    element_container_name = f&#34;{{{TNS}}}Items&#34;
    paging_container_name = f&#34;{{{MNS}}}RootFolder&#34;

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        # A hack to communicate parsing args to _elems_to_objs()
        self.additional_fields = None
        self.shape = None

    def call(
        self,
        folders,
        additional_fields,
        restriction,
        order_fields,
        shape,
        query_string,
        depth,
        calendar_view,
        max_items,
        offset,
    ):
        &#34;&#34;&#34;Find items in an account.

        :param folders: the folders to act on
        :param additional_fields: the extra fields that should be returned with the item, as FieldPath objects
        :param restriction: a Restriction object for
        :param order_fields: the fields to sort the results by
        :param shape: The set of attributes to return
        :param query_string: a QueryString object
        :param depth: How deep in the folder structure to search for items
        :param calendar_view: If set, returns recurring calendar items unfolded
        :param max_items: the max number of items to return
        :param offset: the offset relative to the first item in the item collection. Usually 0.

        :return: XML elements for the matching items
        &#34;&#34;&#34;
        if shape not in SHAPE_CHOICES:
            raise InvalidEnumValue(&#34;shape&#34;, shape, SHAPE_CHOICES)
        if depth not in ITEM_TRAVERSAL_CHOICES:
            raise InvalidEnumValue(&#34;depth&#34;, depth, ITEM_TRAVERSAL_CHOICES)
        self.additional_fields = additional_fields
        self.shape = shape
        return self._elems_to_objs(
            self._paged_call(
                payload_func=self.get_payload,
                max_items=max_items,
                folders=folders,
                **dict(
                    additional_fields=additional_fields,
                    restriction=restriction,
                    order_fields=order_fields,
                    query_string=query_string,
                    shape=shape,
                    depth=depth,
                    calendar_view=calendar_view,
                    page_size=self.page_size,
                    offset=offset,
                ),
            )
        )

    def _elem_to_obj(self, elem):
        if self.shape == ID_ONLY and self.additional_fields is None:
            return Item.id_from_xml(elem)
        return BaseFolder.item_model_from_tag(elem.tag).from_xml(elem=elem, account=self.account)

    def get_payload(
        self,
        folders,
        additional_fields,
        restriction,
        order_fields,
        query_string,
        shape,
        depth,
        calendar_view,
        page_size,
        offset=0,
    ):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(Traversal=depth))
        payload.append(
            shape_element(
                tag=&#34;m:ItemShape&#34;, shape=shape, additional_fields=additional_fields, version=self.account.version
            )
        )
        if calendar_view is None:
            view_type = create_element(
                &#34;m:IndexedPageItemView&#34;, attrs=dict(MaxEntriesReturned=page_size, Offset=offset, BasePoint=&#34;Beginning&#34;)
            )
        else:
            view_type = calendar_view.to_xml(version=self.account.version)
        payload.append(view_type)
        if restriction:
            payload.append(restriction.to_xml(version=self.account.version))
        if order_fields:
            payload.append(set_xml_value(create_element(&#34;m:SortOrder&#34;), order_fields, version=self.account.version))
        payload.append(folder_ids_element(folders=folders, version=self.protocol.version, tag=&#34;m:ParentFolderIds&#34;))
        if query_string:
            payload.append(query_string.to_xml(version=self.account.version))
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSPagingService" href="common.html#exchangelib.services.common.EWSPagingService">EWSPagingService</a></li>
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.FindItem.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.FindItem.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.FindItem.paging_container_name"><code class="name">var <span class="ident">paging_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.FindItem.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, folders, additional_fields, restriction, order_fields, shape, query_string, depth, calendar_view, max_items, offset)</span>
</code></dt>
<dd>
<div class="desc"><p>Find items in an account.</p>
<p>:param folders: the folders to act on
:param additional_fields: the extra fields that should be returned with the item, as FieldPath objects
:param restriction: a Restriction object for
:param order_fields: the fields to sort the results by
:param shape: The set of attributes to return
:param query_string: a QueryString object
:param depth: How deep in the folder structure to search for items
:param calendar_view: If set, returns recurring calendar items unfolded
:param max_items: the max number of items to return
:param offset: the offset relative to the first item in the item collection. Usually 0.</p>
<p>:return: XML elements for the matching items</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(
    self,
    folders,
    additional_fields,
    restriction,
    order_fields,
    shape,
    query_string,
    depth,
    calendar_view,
    max_items,
    offset,
):
    &#34;&#34;&#34;Find items in an account.

    :param folders: the folders to act on
    :param additional_fields: the extra fields that should be returned with the item, as FieldPath objects
    :param restriction: a Restriction object for
    :param order_fields: the fields to sort the results by
    :param shape: The set of attributes to return
    :param query_string: a QueryString object
    :param depth: How deep in the folder structure to search for items
    :param calendar_view: If set, returns recurring calendar items unfolded
    :param max_items: the max number of items to return
    :param offset: the offset relative to the first item in the item collection. Usually 0.

    :return: XML elements for the matching items
    &#34;&#34;&#34;
    if shape not in SHAPE_CHOICES:
        raise InvalidEnumValue(&#34;shape&#34;, shape, SHAPE_CHOICES)
    if depth not in ITEM_TRAVERSAL_CHOICES:
        raise InvalidEnumValue(&#34;depth&#34;, depth, ITEM_TRAVERSAL_CHOICES)
    self.additional_fields = additional_fields
    self.shape = shape
    return self._elems_to_objs(
        self._paged_call(
            payload_func=self.get_payload,
            max_items=max_items,
            folders=folders,
            **dict(
                additional_fields=additional_fields,
                restriction=restriction,
                order_fields=order_fields,
                query_string=query_string,
                shape=shape,
                depth=depth,
                calendar_view=calendar_view,
                page_size=self.page_size,
                offset=offset,
            ),
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.FindItem.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, folders, additional_fields, restriction, order_fields, query_string, shape, depth, calendar_view, page_size, offset=0)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(
    self,
    folders,
    additional_fields,
    restriction,
    order_fields,
    query_string,
    shape,
    depth,
    calendar_view,
    page_size,
    offset=0,
):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(Traversal=depth))
    payload.append(
        shape_element(
            tag=&#34;m:ItemShape&#34;, shape=shape, additional_fields=additional_fields, version=self.account.version
        )
    )
    if calendar_view is None:
        view_type = create_element(
            &#34;m:IndexedPageItemView&#34;, attrs=dict(MaxEntriesReturned=page_size, Offset=offset, BasePoint=&#34;Beginning&#34;)
        )
    else:
        view_type = calendar_view.to_xml(version=self.account.version)
    payload.append(view_type)
    if restriction:
        payload.append(restriction.to_xml(version=self.account.version))
    if order_fields:
        payload.append(set_xml_value(create_element(&#34;m:SortOrder&#34;), order_fields, version=self.account.version))
    payload.append(folder_ids_element(folders=folders, version=self.protocol.version, tag=&#34;m:ParentFolderIds&#34;))
    if query_string:
        payload.append(query_string.to_xml(version=self.account.version))
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSPagingService" href="common.html#exchangelib.services.common.EWSPagingService">EWSPagingService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSPagingService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSPagingService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSPagingService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSPagingService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSPagingService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSPagingService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.FindPeople"><code class="flex name class">
<span>class <span class="ident">FindPeople</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/findpeople-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/findpeople-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class FindPeople(EWSPagingService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/findpeople-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;FindPeople&#34;
    element_container_name = f&#34;{{{MNS}}}People&#34;
    supported_from = EXCHANGE_2013

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        # A hack to communicate parsing args to _elems_to_objs()
        self.additional_fields = None
        self.shape = None

    def call(self, folder, additional_fields, restriction, order_fields, shape, query_string, depth, max_items, offset):
        &#34;&#34;&#34;Find items in an account. This service can only be called on a single folder.

        :param folder: the Folder object to query
        :param additional_fields: the extra fields that should be returned with the item, as FieldPath objects
        :param restriction: a Restriction object for
        :param order_fields: the fields to sort the results by
        :param shape: The set of attributes to return
        :param query_string: a QueryString object
        :param depth: How deep in the folder structure to search for items
        :param max_items: the max number of items to return
        :param offset: the offset relative to the first item in the item collection. Usually 0.

        :return: XML elements for the matching items
        &#34;&#34;&#34;
        if shape not in SHAPE_CHOICES:
            raise InvalidEnumValue(&#34;shape&#34;, shape, SHAPE_CHOICES)
        if depth not in ITEM_TRAVERSAL_CHOICES:
            raise InvalidEnumValue(&#34;depth&#34;, depth, ITEM_TRAVERSAL_CHOICES)
        self.additional_fields = additional_fields
        self.shape = shape
        return self._elems_to_objs(
            self._paged_call(
                payload_func=self.get_payload,
                max_items=max_items,
                folders=[folder],  # We just need the list to satisfy self._paged_call()
                **dict(
                    additional_fields=additional_fields,
                    restriction=restriction,
                    order_fields=order_fields,
                    query_string=query_string,
                    shape=shape,
                    depth=depth,
                    page_size=self.page_size,
                    offset=offset,
                ),
            )
        )

    def _elem_to_obj(self, elem):
        if self.shape == ID_ONLY and self.additional_fields is None:
            return Persona.id_from_xml(elem)
        return Persona.from_xml(elem, account=self.account)

    def get_payload(
        self, folders, additional_fields, restriction, order_fields, query_string, shape, depth, page_size, offset=0
    ):
        # We actually only support a single folder, but self._paged_call() sends us a list
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(Traversal=depth))
        payload.append(
            shape_element(
                tag=&#34;m:PersonaShape&#34;, shape=shape, additional_fields=additional_fields, version=self.account.version
            )
        )
        payload.append(
            create_element(
                &#34;m:IndexedPageItemView&#34;, attrs=dict(MaxEntriesReturned=page_size, Offset=offset, BasePoint=&#34;Beginning&#34;)
            )
        )
        if restriction:
            payload.append(restriction.to_xml(version=self.account.version))
        if order_fields:
            payload.append(set_xml_value(create_element(&#34;m:SortOrder&#34;), order_fields, version=self.account.version))
        payload.append(folder_ids_element(folders=folders, version=self.account.version, tag=&#34;m:ParentFolderId&#34;))
        if query_string:
            payload.append(query_string.to_xml(version=self.account.version))
        return payload

    @staticmethod
    def _get_paging_values(elem):
        &#34;&#34;&#34;Find paging values. The paging element from FindPeople is different from other paging containers.&#34;&#34;&#34;
        item_count = int(elem.find(f&#34;{{{MNS}}}TotalNumberOfPeopleInView&#34;).text)
        first_matching = int(elem.find(f&#34;{{{MNS}}}FirstMatchingRowIndex&#34;).text)
        first_loaded = int(elem.find(f&#34;{{{MNS}}}FirstLoadedRowIndex&#34;).text)
        log.debug(
            &#34;Got page with total items %s, first matching %s, first loaded %s &#34;,
            item_count,
            first_matching,
            first_loaded,
        )
        next_offset = None  # GetPersona does not support fetching more pages
        return item_count, next_offset</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSPagingService" href="common.html#exchangelib.services.common.EWSPagingService">EWSPagingService</a></li>
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.FindPeople.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.FindPeople.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.FindPeople.supported_from"><code class="name">var <span class="ident">supported_from</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.FindPeople.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, folder, additional_fields, restriction, order_fields, shape, query_string, depth, max_items, offset)</span>
</code></dt>
<dd>
<div class="desc"><p>Find items in an account. This service can only be called on a single folder.</p>
<p>:param folder: the Folder object to query
:param additional_fields: the extra fields that should be returned with the item, as FieldPath objects
:param restriction: a Restriction object for
:param order_fields: the fields to sort the results by
:param shape: The set of attributes to return
:param query_string: a QueryString object
:param depth: How deep in the folder structure to search for items
:param max_items: the max number of items to return
:param offset: the offset relative to the first item in the item collection. Usually 0.</p>
<p>:return: XML elements for the matching items</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, folder, additional_fields, restriction, order_fields, shape, query_string, depth, max_items, offset):
    &#34;&#34;&#34;Find items in an account. This service can only be called on a single folder.

    :param folder: the Folder object to query
    :param additional_fields: the extra fields that should be returned with the item, as FieldPath objects
    :param restriction: a Restriction object for
    :param order_fields: the fields to sort the results by
    :param shape: The set of attributes to return
    :param query_string: a QueryString object
    :param depth: How deep in the folder structure to search for items
    :param max_items: the max number of items to return
    :param offset: the offset relative to the first item in the item collection. Usually 0.

    :return: XML elements for the matching items
    &#34;&#34;&#34;
    if shape not in SHAPE_CHOICES:
        raise InvalidEnumValue(&#34;shape&#34;, shape, SHAPE_CHOICES)
    if depth not in ITEM_TRAVERSAL_CHOICES:
        raise InvalidEnumValue(&#34;depth&#34;, depth, ITEM_TRAVERSAL_CHOICES)
    self.additional_fields = additional_fields
    self.shape = shape
    return self._elems_to_objs(
        self._paged_call(
            payload_func=self.get_payload,
            max_items=max_items,
            folders=[folder],  # We just need the list to satisfy self._paged_call()
            **dict(
                additional_fields=additional_fields,
                restriction=restriction,
                order_fields=order_fields,
                query_string=query_string,
                shape=shape,
                depth=depth,
                page_size=self.page_size,
                offset=offset,
            ),
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.FindPeople.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, folders, additional_fields, restriction, order_fields, query_string, shape, depth, page_size, offset=0)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(
    self, folders, additional_fields, restriction, order_fields, query_string, shape, depth, page_size, offset=0
):
    # We actually only support a single folder, but self._paged_call() sends us a list
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(Traversal=depth))
    payload.append(
        shape_element(
            tag=&#34;m:PersonaShape&#34;, shape=shape, additional_fields=additional_fields, version=self.account.version
        )
    )
    payload.append(
        create_element(
            &#34;m:IndexedPageItemView&#34;, attrs=dict(MaxEntriesReturned=page_size, Offset=offset, BasePoint=&#34;Beginning&#34;)
        )
    )
    if restriction:
        payload.append(restriction.to_xml(version=self.account.version))
    if order_fields:
        payload.append(set_xml_value(create_element(&#34;m:SortOrder&#34;), order_fields, version=self.account.version))
    payload.append(folder_ids_element(folders=folders, version=self.account.version, tag=&#34;m:ParentFolderId&#34;))
    if query_string:
        payload.append(query_string.to_xml(version=self.account.version))
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSPagingService" href="common.html#exchangelib.services.common.EWSPagingService">EWSPagingService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSPagingService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSPagingService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSPagingService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSPagingService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSPagingService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSPagingService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.GetAttachment"><code class="flex name class">
<span>class <span class="ident">GetAttachment</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getattachment-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getattachment-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GetAttachment(EWSAccountService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getattachment-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;GetAttachment&#34;
    element_container_name = f&#34;{{{MNS}}}Attachments&#34;
    cls_map = {cls.response_tag(): cls for cls in (FileAttachment, ItemAttachment)}

    def call(self, items, include_mime_content, body_type, filter_html_content, additional_fields):
        if body_type and body_type not in BODY_TYPE_CHOICES:
            raise InvalidEnumValue(&#34;body_type&#34;, body_type, BODY_TYPE_CHOICES)
        return self._elems_to_objs(
            self._chunked_get_elements(
                self.get_payload,
                items=items,
                include_mime_content=include_mime_content,
                body_type=body_type,
                filter_html_content=filter_html_content,
                additional_fields=additional_fields,
            )
        )

    def _elem_to_obj(self, elem):
        return self.cls_map[elem.tag].from_xml(elem=elem, account=self.account)

    def get_payload(self, items, include_mime_content, body_type, filter_html_content, additional_fields):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        shape_elem = create_element(&#34;m:AttachmentShape&#34;)
        if include_mime_content:
            add_xml_child(shape_elem, &#34;t:IncludeMimeContent&#34;, &#34;true&#34;)
        if body_type:
            add_xml_child(shape_elem, &#34;t:BodyType&#34;, body_type)
        if filter_html_content is not None:
            add_xml_child(shape_elem, &#34;t:FilterHtmlContent&#34;, &#34;true&#34; if filter_html_content else &#34;false&#34;)
        if additional_fields:
            additional_properties = create_element(&#34;t:AdditionalProperties&#34;)
            expanded_fields = chain(*(f.expand(version=self.account.version) for f in additional_fields))
            set_xml_value(
                additional_properties,
                sorted(expanded_fields, key=lambda f: (getattr(f.field, &#34;field_uri&#34;, &#34;&#34;), f.path)),
                version=self.account.version,
            )
            shape_elem.append(additional_properties)
        if len(shape_elem):
            payload.append(shape_elem)
        payload.append(attachment_ids_element(items=items, version=self.account.version))
        return payload

    def _update_api_version(self, api_version, header, **parse_opts):
        if not parse_opts.get(&#34;stream_file_content&#34;, False):
            super()._update_api_version(api_version, header, **parse_opts)
        # TODO: We&#39;re skipping this part in streaming mode because StreamingBase64Parser cannot parse the SOAP header

    @classmethod
    def _get_soap_parts(cls, response, **parse_opts):
        if not parse_opts.get(&#34;stream_file_content&#34;, False):
            return super()._get_soap_parts(response, **parse_opts)

        # Pass the response unaltered. We want to use our custom streaming parser
        return None, response

    def _get_soap_messages(self, body, **parse_opts):
        if not parse_opts.get(&#34;stream_file_content&#34;, False):
            return super()._get_soap_messages(body, **parse_opts)

        # &#39;body&#39; is actually the raw response passed on by &#39;_get_soap_parts&#39;
        r = body
        parser = StreamingBase64Parser()
        field = FileAttachment.get_field_by_fieldname(&#34;_content&#34;)
        handler = StreamingContentHandler(parser=parser, ns=field.namespace, element_name=field.field_uri)
        parser.setContentHandler(handler)
        return parser.parse(r)

    def stream_file_content(self, attachment_id):
        # The streaming XML parser can only stream content of one attachment
        payload = self.get_payload(
            items=[attachment_id],
            include_mime_content=False,
            body_type=None,
            filter_html_content=None,
            additional_fields=None,
        )
        self.streaming = True
        try:
            yield from self._get_response_xml(payload=payload, stream_file_content=True)
        except ElementNotFound as enf:
            # When the returned XML does not contain a Content element, ElementNotFound is thrown by parser.parse().
            # Let the non-streaming SOAP parser parse the response and hook into the normal exception handling.
            # Wrap in DummyResponse because _get_soap_parts() expects an iter_content() method.
            response = DummyResponse(content=enf.data)
            _, body = super()._get_soap_parts(response=response)
            res = super()._get_soap_messages(body=body)
            for e in self._get_elements_in_response(response=res):
                if isinstance(e, Exception):
                    raise e
            # The returned content did not contain any EWS exceptions. Give up and re-raise the original exception.
            raise enf
        finally:
            self.stop_streaming()
            self.streaming = False</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.GetAttachment.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetAttachment.cls_map"><code class="name">var <span class="ident">cls_map</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetAttachment.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.GetAttachment.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, items, include_mime_content, body_type, filter_html_content, additional_fields)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, items, include_mime_content, body_type, filter_html_content, additional_fields):
    if body_type and body_type not in BODY_TYPE_CHOICES:
        raise InvalidEnumValue(&#34;body_type&#34;, body_type, BODY_TYPE_CHOICES)
    return self._elems_to_objs(
        self._chunked_get_elements(
            self.get_payload,
            items=items,
            include_mime_content=include_mime_content,
            body_type=body_type,
            filter_html_content=filter_html_content,
            additional_fields=additional_fields,
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.GetAttachment.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, items, include_mime_content, body_type, filter_html_content, additional_fields)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, items, include_mime_content, body_type, filter_html_content, additional_fields):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    shape_elem = create_element(&#34;m:AttachmentShape&#34;)
    if include_mime_content:
        add_xml_child(shape_elem, &#34;t:IncludeMimeContent&#34;, &#34;true&#34;)
    if body_type:
        add_xml_child(shape_elem, &#34;t:BodyType&#34;, body_type)
    if filter_html_content is not None:
        add_xml_child(shape_elem, &#34;t:FilterHtmlContent&#34;, &#34;true&#34; if filter_html_content else &#34;false&#34;)
    if additional_fields:
        additional_properties = create_element(&#34;t:AdditionalProperties&#34;)
        expanded_fields = chain(*(f.expand(version=self.account.version) for f in additional_fields))
        set_xml_value(
            additional_properties,
            sorted(expanded_fields, key=lambda f: (getattr(f.field, &#34;field_uri&#34;, &#34;&#34;), f.path)),
            version=self.account.version,
        )
        shape_elem.append(additional_properties)
    if len(shape_elem):
        payload.append(shape_elem)
    payload.append(attachment_ids_element(items=items, version=self.account.version))
    return payload</code></pre>
</details>
</dd>
<dt id="exchangelib.services.GetAttachment.stream_file_content"><code class="name flex">
<span>def <span class="ident">stream_file_content</span></span>(<span>self, attachment_id)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def stream_file_content(self, attachment_id):
    # The streaming XML parser can only stream content of one attachment
    payload = self.get_payload(
        items=[attachment_id],
        include_mime_content=False,
        body_type=None,
        filter_html_content=None,
        additional_fields=None,
    )
    self.streaming = True
    try:
        yield from self._get_response_xml(payload=payload, stream_file_content=True)
    except ElementNotFound as enf:
        # When the returned XML does not contain a Content element, ElementNotFound is thrown by parser.parse().
        # Let the non-streaming SOAP parser parse the response and hook into the normal exception handling.
        # Wrap in DummyResponse because _get_soap_parts() expects an iter_content() method.
        response = DummyResponse(content=enf.data)
        _, body = super()._get_soap_parts(response=response)
        res = super()._get_soap_messages(body=body)
        for e in self._get_elements_in_response(response=res):
            if isinstance(e, Exception):
                raise e
        # The returned content did not contain any EWS exceptions. Give up and re-raise the original exception.
        raise enf
    finally:
        self.stop_streaming()
        self.streaming = False</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.GetDelegate"><code class="flex name class">
<span>class <span class="ident">GetDelegate</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getdelegate-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getdelegate-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GetDelegate(EWSAccountService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getdelegate-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;GetDelegate&#34;
    ERRORS_TO_CATCH_IN_RESPONSE = ()
    supported_from = EXCHANGE_2007_SP1

    def call(self, user_ids, include_permissions):
        return self._elems_to_objs(
            self._chunked_get_elements(
                self.get_payload,
                items=user_ids or [None],
                mailbox=DLMailbox(email_address=self.account.primary_smtp_address),
                include_permissions=include_permissions,
            )
        )

    def _elem_to_obj(self, elem):
        return DelegateUser.from_xml(elem=elem, account=self.account)

    def get_payload(self, user_ids, mailbox, include_permissions):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(IncludePermissions=include_permissions))
        set_xml_value(payload, mailbox, version=self.protocol.version)
        if user_ids != [None]:
            user_ids_elem = create_element(&#34;m:UserIds&#34;)
            for user_id in user_ids:
                if isinstance(user_id, str):
                    user_id = UserId(primary_smtp_address=user_id)
                set_xml_value(user_ids_elem, user_id, version=self.protocol.version)
            set_xml_value(payload, user_ids_elem, version=self.protocol.version)
        return payload

    @classmethod
    def _get_elements_in_container(cls, container):
        return container.findall(DelegateUser.response_tag())

    @classmethod
    def _response_message_tag(cls):
        return f&#34;{{{MNS}}}DelegateUserResponseMessageType&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.GetDelegate.ERRORS_TO_CATCH_IN_RESPONSE"><code class="name">var <span class="ident">ERRORS_TO_CATCH_IN_RESPONSE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetDelegate.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetDelegate.supported_from"><code class="name">var <span class="ident">supported_from</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.GetDelegate.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, user_ids, include_permissions)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, user_ids, include_permissions):
    return self._elems_to_objs(
        self._chunked_get_elements(
            self.get_payload,
            items=user_ids or [None],
            mailbox=DLMailbox(email_address=self.account.primary_smtp_address),
            include_permissions=include_permissions,
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.GetDelegate.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, user_ids, mailbox, include_permissions)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, user_ids, mailbox, include_permissions):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(IncludePermissions=include_permissions))
    set_xml_value(payload, mailbox, version=self.protocol.version)
    if user_ids != [None]:
        user_ids_elem = create_element(&#34;m:UserIds&#34;)
        for user_id in user_ids:
            if isinstance(user_id, str):
                user_id = UserId(primary_smtp_address=user_id)
            set_xml_value(user_ids_elem, user_id, version=self.protocol.version)
        set_xml_value(payload, user_ids_elem, version=self.protocol.version)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.GetEvents"><code class="flex name class">
<span>class <span class="ident">GetEvents</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getevents-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getevents-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GetEvents(EWSAccountService):
    &#34;&#34;&#34;MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getevents-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;GetEvents&#34;
    prefer_affinity = True

    def call(self, subscription_id, watermark):
        return self._elems_to_objs(
            self._get_elements(
                payload=self.get_payload(
                    subscription_id=subscription_id,
                    watermark=watermark,
                )
            )
        )

    def _elem_to_obj(self, elem):
        return Notification.from_xml(elem=elem, account=None)

    @classmethod
    def _get_elements_in_container(cls, container):
        return container.findall(Notification.response_tag())

    def get_payload(self, subscription_id, watermark):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        add_xml_child(payload, &#34;m:SubscriptionId&#34;, subscription_id)
        add_xml_child(payload, &#34;m:Watermark&#34;, watermark)
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.GetEvents.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetEvents.prefer_affinity"><code class="name">var <span class="ident">prefer_affinity</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.GetEvents.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, subscription_id, watermark)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, subscription_id, watermark):
    return self._elems_to_objs(
        self._get_elements(
            payload=self.get_payload(
                subscription_id=subscription_id,
                watermark=watermark,
            )
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.GetEvents.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, subscription_id, watermark)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, subscription_id, watermark):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    add_xml_child(payload, &#34;m:SubscriptionId&#34;, subscription_id)
    add_xml_child(payload, &#34;m:Watermark&#34;, watermark)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.GetFolder"><code class="flex name class">
<span>class <span class="ident">GetFolder</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getfolder-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getfolder-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GetFolder(EWSAccountService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getfolder-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;GetFolder&#34;
    element_container_name = f&#34;{{{MNS}}}Folders&#34;
    ERRORS_TO_CATCH_IN_RESPONSE = EWSAccountService.ERRORS_TO_CATCH_IN_RESPONSE + (
        ErrorFolderNotFound,
        ErrorNoPublicFolderReplicaAvailable,
        ErrorInvalidOperation,
    )

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self.folders = []  # A hack to communicate parsing args to _elems_to_objs()

    def call(self, folders, additional_fields, shape):
        &#34;&#34;&#34;Take a folder ID and returns the full information for that folder.

        :param folders: a list of Folder objects
        :param additional_fields: the extra fields that should be returned with the folder, as FieldPath objects
        :param shape: The set of attributes to return

        :return: XML elements for the folders, in stable order
        &#34;&#34;&#34;
        # We can&#39;t easily find the correct folder class from the returned XML. Instead, return objects with the same
        # class as the folder instance it was requested with.
        self.folders = list(folders)  # Convert to a list, in case &#39;folders&#39; is a generator. We&#39;re iterating twice.
        return self._elems_to_objs(
            self._chunked_get_elements(
                self.get_payload,
                items=self.folders,
                additional_fields=additional_fields,
                shape=shape,
            )
        )

    def _elems_to_objs(self, elems):
        for folder, elem in zip(self.folders, elems):
            if isinstance(elem, Exception):
                yield elem
                continue
            yield parse_folder_elem(elem=elem, folder=folder, account=self.account)

    def get_payload(self, folders, additional_fields, shape):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        payload.append(
            shape_element(
                tag=&#34;m:FolderShape&#34;, shape=shape, additional_fields=additional_fields, version=self.account.version
            )
        )
        payload.append(folder_ids_element(folders=folders, version=self.account.version))
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.GetFolder.ERRORS_TO_CATCH_IN_RESPONSE"><code class="name">var <span class="ident">ERRORS_TO_CATCH_IN_RESPONSE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetFolder.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetFolder.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.GetFolder.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, folders, additional_fields, shape)</span>
</code></dt>
<dd>
<div class="desc"><p>Take a folder ID and returns the full information for that folder.</p>
<p>:param folders: a list of Folder objects
:param additional_fields: the extra fields that should be returned with the folder, as FieldPath objects
:param shape: The set of attributes to return</p>
<p>:return: XML elements for the folders, in stable order</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, folders, additional_fields, shape):
    &#34;&#34;&#34;Take a folder ID and returns the full information for that folder.

    :param folders: a list of Folder objects
    :param additional_fields: the extra fields that should be returned with the folder, as FieldPath objects
    :param shape: The set of attributes to return

    :return: XML elements for the folders, in stable order
    &#34;&#34;&#34;
    # We can&#39;t easily find the correct folder class from the returned XML. Instead, return objects with the same
    # class as the folder instance it was requested with.
    self.folders = list(folders)  # Convert to a list, in case &#39;folders&#39; is a generator. We&#39;re iterating twice.
    return self._elems_to_objs(
        self._chunked_get_elements(
            self.get_payload,
            items=self.folders,
            additional_fields=additional_fields,
            shape=shape,
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.GetFolder.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, folders, additional_fields, shape)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, folders, additional_fields, shape):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    payload.append(
        shape_element(
            tag=&#34;m:FolderShape&#34;, shape=shape, additional_fields=additional_fields, version=self.account.version
        )
    )
    payload.append(folder_ids_element(folders=folders, version=self.account.version))
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.GetItem"><code class="flex name class">
<span>class <span class="ident">GetItem</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getitem-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getitem-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GetItem(EWSAccountService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getitem-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;GetItem&#34;
    element_container_name = f&#34;{{{MNS}}}Items&#34;

    def call(self, items, additional_fields, shape):
        &#34;&#34;&#34;Return all items in an account that correspond to a list of ID&#39;s, in stable order.

        :param items: a list of (id, changekey) tuples or Item objects
        :param additional_fields: the extra fields that should be returned with the item, as FieldPath objects
        :param shape: The shape of returned objects

        :return: XML elements for the items, in stable order
        &#34;&#34;&#34;
        return self._elems_to_objs(
            self._chunked_get_elements(
                self.get_payload,
                items=items,
                additional_fields=additional_fields,
                shape=shape,
            )
        )

    def _elem_to_obj(self, elem):
        return BaseFolder.item_model_from_tag(elem.tag).from_xml(elem=elem, account=self.account)

    def get_payload(self, items, additional_fields, shape):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        payload.append(
            shape_element(
                tag=&#34;m:ItemShape&#34;, shape=shape, additional_fields=additional_fields, version=self.account.version
            )
        )
        payload.append(item_ids_element(items=items, version=self.account.version))
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.GetItem.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetItem.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.GetItem.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, items, additional_fields, shape)</span>
</code></dt>
<dd>
<div class="desc"><p>Return all items in an account that correspond to a list of ID's, in stable order.</p>
<p>:param items: a list of (id, changekey) tuples or Item objects
:param additional_fields: the extra fields that should be returned with the item, as FieldPath objects
:param shape: The shape of returned objects</p>
<p>:return: XML elements for the items, in stable order</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, items, additional_fields, shape):
    &#34;&#34;&#34;Return all items in an account that correspond to a list of ID&#39;s, in stable order.

    :param items: a list of (id, changekey) tuples or Item objects
    :param additional_fields: the extra fields that should be returned with the item, as FieldPath objects
    :param shape: The shape of returned objects

    :return: XML elements for the items, in stable order
    &#34;&#34;&#34;
    return self._elems_to_objs(
        self._chunked_get_elements(
            self.get_payload,
            items=items,
            additional_fields=additional_fields,
            shape=shape,
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.GetItem.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, items, additional_fields, shape)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, items, additional_fields, shape):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    payload.append(
        shape_element(
            tag=&#34;m:ItemShape&#34;, shape=shape, additional_fields=additional_fields, version=self.account.version
        )
    )
    payload.append(item_ids_element(items=items, version=self.account.version))
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.GetMailTips"><code class="flex name class">
<span>class <span class="ident">GetMailTips</span></span>
<span>(</span><span>protocol, chunk_size=None, timeout=None)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getmailtips-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getmailtips-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GetMailTips(EWSService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getmailtips-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;GetMailTips&#34;

    def call(self, sending_as, recipients, mail_tips_requested):
        return self._elems_to_objs(
            self._chunked_get_elements(
                self.get_payload,
                items=recipients,
                sending_as=sending_as,
                mail_tips_requested=mail_tips_requested,
            )
        )

    def _elem_to_obj(self, elem):
        return MailTips.from_xml(elem=elem, account=None)

    def get_payload(self, recipients, sending_as, mail_tips_requested):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        set_xml_value(payload, sending_as, version=self.protocol.version)

        recipients_elem = create_element(&#34;m:Recipients&#34;)
        for recipient in recipients:
            set_xml_value(recipients_elem, recipient, version=self.protocol.version)
        payload.append(recipients_elem)

        if mail_tips_requested:
            set_xml_value(payload, mail_tips_requested, version=self.protocol.version)
        return payload

    def _get_elements_in_response(self, response):
        for msg in response:
            yield self._get_element_container(message=msg, name=MailTips.response_tag())

    @classmethod
    def _response_message_tag(cls):
        return f&#34;{{{MNS}}}MailTipsResponseMessageType&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.GetMailTips.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.GetMailTips.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, sending_as, recipients, mail_tips_requested)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, sending_as, recipients, mail_tips_requested):
    return self._elems_to_objs(
        self._chunked_get_elements(
            self.get_payload,
            items=recipients,
            sending_as=sending_as,
            mail_tips_requested=mail_tips_requested,
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.GetMailTips.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, recipients, sending_as, mail_tips_requested)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, recipients, sending_as, mail_tips_requested):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    set_xml_value(payload, sending_as, version=self.protocol.version)

    recipients_elem = create_element(&#34;m:Recipients&#34;)
    for recipient in recipients:
        set_xml_value(recipients_elem, recipient, version=self.protocol.version)
    payload.append(recipients_elem)

    if mail_tips_requested:
        set_xml_value(payload, mail_tips_requested, version=self.protocol.version)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.GetPersona"><code class="flex name class">
<span>class <span class="ident">GetPersona</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getpersona-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getpersona-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GetPersona(EWSAccountService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getpersona-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;GetPersona&#34;

    def call(self, personas):
        # GetPersona only accepts one persona ID per request. Crazy.
        for persona in personas:
            yield from self._elems_to_objs(self._get_elements(payload=self.get_payload(persona=persona)))

    def _elem_to_obj(self, elem):
        return Persona.from_xml(elem=elem, account=None)

    def get_payload(self, persona):
        return set_xml_value(
            create_element(f&#34;m:{self.SERVICE_NAME}&#34;), to_item_id(persona, PersonaId), version=self.protocol.version
        )

    @classmethod
    def _get_elements_in_container(cls, container):
        return container.findall(f&#34;{{{MNS}}}{Persona.ELEMENT_NAME}&#34;)

    @classmethod
    def _response_tag(cls):
        return f&#34;{{{MNS}}}{cls.SERVICE_NAME}ResponseMessage&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.GetPersona.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.GetPersona.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, personas)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, personas):
    # GetPersona only accepts one persona ID per request. Crazy.
    for persona in personas:
        yield from self._elems_to_objs(self._get_elements(payload=self.get_payload(persona=persona)))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.GetPersona.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, persona)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, persona):
    return set_xml_value(
        create_element(f&#34;m:{self.SERVICE_NAME}&#34;), to_item_id(persona, PersonaId), version=self.protocol.version
    )</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.GetRoomLists"><code class="flex name class">
<span>class <span class="ident">GetRoomLists</span></span>
<span>(</span><span>protocol, chunk_size=None, timeout=None)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getroomlists-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getroomlists-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GetRoomLists(EWSService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getroomlists-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;GetRoomLists&#34;
    element_container_name = f&#34;{{{MNS}}}RoomLists&#34;
    supported_from = EXCHANGE_2010

    def call(self):
        return self._elems_to_objs(self._get_elements(payload=self.get_payload()))

    def _elem_to_obj(self, elem):
        return RoomList.from_xml(elem=elem, account=None)

    def get_payload(self):
        return create_element(f&#34;m:{self.SERVICE_NAME}&#34;)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.GetRoomLists.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetRoomLists.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetRoomLists.supported_from"><code class="name">var <span class="ident">supported_from</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.GetRoomLists.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self):
    return self._elems_to_objs(self._get_elements(payload=self.get_payload()))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.GetRoomLists.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self):
    return create_element(f&#34;m:{self.SERVICE_NAME}&#34;)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.GetRooms"><code class="flex name class">
<span>class <span class="ident">GetRooms</span></span>
<span>(</span><span>protocol, chunk_size=None, timeout=None)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getrooms-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getrooms-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GetRooms(EWSService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getrooms-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;GetRooms&#34;
    element_container_name = f&#34;{{{MNS}}}Rooms&#34;
    supported_from = EXCHANGE_2010

    def call(self, room_list):
        return self._elems_to_objs(self._get_elements(payload=self.get_payload(room_list=room_list)))

    def _elem_to_obj(self, elem):
        return Room.from_xml(elem=elem, account=None)

    def get_payload(self, room_list):
        return set_xml_value(create_element(f&#34;m:{self.SERVICE_NAME}&#34;), room_list, version=self.protocol.version)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.GetRooms.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetRooms.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetRooms.supported_from"><code class="name">var <span class="ident">supported_from</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.GetRooms.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, room_list)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, room_list):
    return self._elems_to_objs(self._get_elements(payload=self.get_payload(room_list=room_list)))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.GetRooms.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, room_list)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, room_list):
    return set_xml_value(create_element(f&#34;m:{self.SERVICE_NAME}&#34;), room_list, version=self.protocol.version)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.GetSearchableMailboxes"><code class="flex name class">
<span>class <span class="ident">GetSearchableMailboxes</span></span>
<span>(</span><span>protocol, chunk_size=None, timeout=None)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getsearchablemailboxes-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getsearchablemailboxes-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GetSearchableMailboxes(EWSService):
    &#34;&#34;&#34;MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getsearchablemailboxes-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;GetSearchableMailboxes&#34;
    element_container_name = f&#34;{{{MNS}}}SearchableMailboxes&#34;
    failed_mailboxes_container_name = f&#34;{{{MNS}}}FailedMailboxes&#34;
    supported_from = EXCHANGE_2013
    cls_map = {cls.response_tag(): cls for cls in (SearchableMailbox, FailedMailbox)}

    def call(self, search_filter, expand_group_membership):
        return self._elems_to_objs(
            self._get_elements(
                payload=self.get_payload(
                    search_filter=search_filter,
                    expand_group_membership=expand_group_membership,
                )
            )
        )

    def _elem_to_obj(self, elem):
        return self.cls_map[elem.tag].from_xml(elem=elem, account=None)

    def get_payload(self, search_filter, expand_group_membership):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        if search_filter:
            add_xml_child(payload, &#34;m:SearchFilter&#34;, search_filter)
        if expand_group_membership is not None:
            add_xml_child(payload, &#34;m:ExpandGroupMembership&#34;, &#34;true&#34; if expand_group_membership else &#34;false&#34;)
        return payload

    def _get_elements_in_response(self, response):
        for msg in response:
            for container_name in (self.element_container_name, self.failed_mailboxes_container_name):
                try:
                    container = self._get_element_container(message=msg, name=container_name)
                except MalformedResponseError:
                    # Responses may contain no mailboxes of either kind. _get_element_container() does not accept this.
                    continue
                yield from self._get_elements_in_container(container=container)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.GetSearchableMailboxes.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetSearchableMailboxes.cls_map"><code class="name">var <span class="ident">cls_map</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetSearchableMailboxes.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetSearchableMailboxes.failed_mailboxes_container_name"><code class="name">var <span class="ident">failed_mailboxes_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetSearchableMailboxes.supported_from"><code class="name">var <span class="ident">supported_from</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.GetSearchableMailboxes.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, search_filter, expand_group_membership)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, search_filter, expand_group_membership):
    return self._elems_to_objs(
        self._get_elements(
            payload=self.get_payload(
                search_filter=search_filter,
                expand_group_membership=expand_group_membership,
            )
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.GetSearchableMailboxes.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, search_filter, expand_group_membership)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, search_filter, expand_group_membership):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    if search_filter:
        add_xml_child(payload, &#34;m:SearchFilter&#34;, search_filter)
    if expand_group_membership is not None:
        add_xml_child(payload, &#34;m:ExpandGroupMembership&#34;, &#34;true&#34; if expand_group_membership else &#34;false&#34;)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.GetServerTimeZones"><code class="flex name class">
<span>class <span class="ident">GetServerTimeZones</span></span>
<span>(</span><span>protocol, chunk_size=None, timeout=None)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getservertimezones-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getservertimezones-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GetServerTimeZones(EWSService):
    &#34;&#34;&#34;MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getservertimezones-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;GetServerTimeZones&#34;
    element_container_name = f&#34;{{{MNS}}}TimeZoneDefinitions&#34;
    supported_from = EXCHANGE_2010

    def call(self, timezones=None, return_full_timezone_data=False):
        return self._elems_to_objs(
            self._get_elements(
                payload=self.get_payload(timezones=timezones, return_full_timezone_data=return_full_timezone_data)
            )
        )

    def get_payload(self, timezones, return_full_timezone_data):
        payload = create_element(
            f&#34;m:{self.SERVICE_NAME}&#34;,
            attrs=dict(ReturnFullTimeZoneData=return_full_timezone_data),
        )
        if timezones is not None:
            is_empty, timezones = peek(timezones)
            if not is_empty:
                tz_ids = create_element(&#34;m:Ids&#34;)
                for timezone in timezones:
                    tz_id = set_xml_value(create_element(&#34;t:Id&#34;), timezone.ms_id)
                    tz_ids.append(tz_id)
                payload.append(tz_ids)
        return payload

    def _elem_to_obj(self, elem):
        return TimeZoneDefinition.from_xml(elem=elem, account=None)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.GetServerTimeZones.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetServerTimeZones.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetServerTimeZones.supported_from"><code class="name">var <span class="ident">supported_from</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.GetServerTimeZones.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, timezones=None, return_full_timezone_data=False)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, timezones=None, return_full_timezone_data=False):
    return self._elems_to_objs(
        self._get_elements(
            payload=self.get_payload(timezones=timezones, return_full_timezone_data=return_full_timezone_data)
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.GetServerTimeZones.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, timezones, return_full_timezone_data)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, timezones, return_full_timezone_data):
    payload = create_element(
        f&#34;m:{self.SERVICE_NAME}&#34;,
        attrs=dict(ReturnFullTimeZoneData=return_full_timezone_data),
    )
    if timezones is not None:
        is_empty, timezones = peek(timezones)
        if not is_empty:
            tz_ids = create_element(&#34;m:Ids&#34;)
            for timezone in timezones:
                tz_id = set_xml_value(create_element(&#34;t:Id&#34;), timezone.ms_id)
                tz_ids.append(tz_id)
            payload.append(tz_ids)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.GetStreamingEvents"><code class="flex name class">
<span>class <span class="ident">GetStreamingEvents</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getstreamingevents-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getstreamingevents-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GetStreamingEvents(EWSAccountService):
    &#34;&#34;&#34;MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getstreamingevents-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;GetStreamingEvents&#34;
    element_container_name = f&#34;{{{MNS}}}Notifications&#34;
    prefer_affinity = True

    # Connection status values
    OK = &#34;OK&#34;
    CLOSED = &#34;Closed&#34;

    def __init__(self, *args, **kwargs):
        # These values are set each time call() is consumed
        self.connection_status = None
        super().__init__(*args, **kwargs)
        self.streaming = True

    def call(self, subscription_ids, connection_timeout):
        if not isinstance(connection_timeout, int):
            raise InvalidTypeError(&#34;connection_timeout&#34;, connection_timeout, int)
        if connection_timeout &lt; 1:
            raise ValueError(f&#34;&#39;connection_timeout&#39; {connection_timeout} must be a positive integer&#34;)
        # Add 60 seconds to the timeout, to allow us to always get the final message containing ConnectionStatus=Closed
        self.timeout = connection_timeout * 60 + 60
        return self._elems_to_objs(
            self._get_elements(
                payload=self.get_payload(
                    subscription_ids=subscription_ids,
                    connection_timeout=connection_timeout,
                )
            )
        )

    def _elem_to_obj(self, elem):
        return Notification.from_xml(elem=elem, account=None)

    @classmethod
    def _get_soap_parts(cls, response, **parse_opts):
        # Pass the response unaltered. We want to use our custom document yielder
        return None, response

    def _get_soap_messages(self, body, **parse_opts):
        # &#39;body&#39; is actually the raw response passed on by &#39;_get_soap_parts&#39;. We want to continuously read the content,
        # looking for complete XML documents. When we have a full document, we want to parse it as if it was a normal
        # XML response.
        r = body
        for i, doc in enumerate(DocumentYielder(r.iter_content()), start=1):
            xml_log.debug(&#34;Response XML (docs counter: %(i)s): %(xml_response)s&#34;, dict(i=i, xml_response=doc))
            response = DummyResponse(content=doc)
            try:
                _, body = super()._get_soap_parts(response=response, **parse_opts)
            except Exception:
                r.close()  # Release memory
                raise
            # TODO: We&#39;re skipping ._update_api_version() here because we don&#39;t have access to the &#39;api_version&#39; used.
            # TODO: We should be doing a lot of error handling for ._get_soap_messages().
            yield from super()._get_soap_messages(body=body, **parse_opts)
            if self.connection_status == self.CLOSED:
                # Don&#39;t wait for the TCP connection to timeout
                break

    def _get_element_container(self, message, name=None):
        error_ids_elem = message.find(f&#34;{{{MNS}}}ErrorSubscriptionIds&#34;)
        error_ids = [] if error_ids_elem is None else get_xml_attrs(error_ids_elem, f&#34;{{{MNS}}}SubscriptionId&#34;)
        self.connection_status = get_xml_attr(message, f&#34;{{{MNS}}}ConnectionStatus&#34;)  # Either &#39;OK&#39; or &#39;Closed&#39;
        log.debug(&#34;Connection status is: %s&#34;, self.connection_status)
        # Upstream normally expects to find a &#39;name&#39; tag but our response does not always have it. We still want to
        # call upstream, to have exceptions raised. Return an empty list if there is no &#39;name&#39; tag and no errors.
        if message.find(name) is None:
            name = None
        try:
            res = super()._get_element_container(message=message, name=name)
        except EWSError as e:
            # When the request contains a combination of good and failing subscription IDs, notifications for the good
            # subscriptions seem to never be returned even though the XML spec allows it. This means there&#39;s no point in
            # trying to collect any notifications here and delivering a combination of errors and return values.
            if error_ids:
                e.value += f&#34; (subscription IDs: {error_ids})&#34;
            raise e
        return [] if name is None else res

    def get_payload(self, subscription_ids, connection_timeout):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        subscriptions_elem = create_element(&#34;m:SubscriptionIds&#34;)
        for subscription_id in subscription_ids:
            add_xml_child(subscriptions_elem, &#34;t:SubscriptionId&#34;, subscription_id)
        if not len(subscriptions_elem):
            raise ValueError(&#34;&#39;subscription_ids&#39; must not be empty&#34;)

        payload.append(subscriptions_elem)
        add_xml_child(payload, &#34;m:ConnectionTimeout&#34;, connection_timeout)
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.GetStreamingEvents.CLOSED"><code class="name">var <span class="ident">CLOSED</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetStreamingEvents.OK"><code class="name">var <span class="ident">OK</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetStreamingEvents.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetStreamingEvents.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetStreamingEvents.prefer_affinity"><code class="name">var <span class="ident">prefer_affinity</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.GetStreamingEvents.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, subscription_ids, connection_timeout)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, subscription_ids, connection_timeout):
    if not isinstance(connection_timeout, int):
        raise InvalidTypeError(&#34;connection_timeout&#34;, connection_timeout, int)
    if connection_timeout &lt; 1:
        raise ValueError(f&#34;&#39;connection_timeout&#39; {connection_timeout} must be a positive integer&#34;)
    # Add 60 seconds to the timeout, to allow us to always get the final message containing ConnectionStatus=Closed
    self.timeout = connection_timeout * 60 + 60
    return self._elems_to_objs(
        self._get_elements(
            payload=self.get_payload(
                subscription_ids=subscription_ids,
                connection_timeout=connection_timeout,
            )
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.GetStreamingEvents.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, subscription_ids, connection_timeout)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, subscription_ids, connection_timeout):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    subscriptions_elem = create_element(&#34;m:SubscriptionIds&#34;)
    for subscription_id in subscription_ids:
        add_xml_child(subscriptions_elem, &#34;t:SubscriptionId&#34;, subscription_id)
    if not len(subscriptions_elem):
        raise ValueError(&#34;&#39;subscription_ids&#39; must not be empty&#34;)

    payload.append(subscriptions_elem)
    add_xml_child(payload, &#34;m:ConnectionTimeout&#34;, connection_timeout)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.GetUserAvailability"><code class="flex name class">
<span>class <span class="ident">GetUserAvailability</span></span>
<span>(</span><span>protocol, chunk_size=None, timeout=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Get detailed availability information for a list of users.
MSDN:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getuseravailability-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getuseravailability-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GetUserAvailability(EWSService):
    &#34;&#34;&#34;Get detailed availability information for a list of users.
    MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getuseravailability-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;GetUserAvailability&#34;

    def call(self, mailbox_data, timezone, free_busy_view_options):
        # TODO: Also supports SuggestionsViewOptions, see
        #  https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/suggestionsviewoptions
        return self._elems_to_objs(
            self._chunked_get_elements(
                self.get_payload,
                items=mailbox_data,
                timezone=timezone,
                free_busy_view_options=free_busy_view_options,
            )
        )

    def _elem_to_obj(self, elem):
        return FreeBusyView.from_xml(elem=elem, account=None)

    def get_payload(self, mailbox_data, timezone, free_busy_view_options):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}Request&#34;)
        set_xml_value(payload, timezone, version=self.protocol.version)
        mailbox_data_array = create_element(&#34;m:MailboxDataArray&#34;)
        set_xml_value(mailbox_data_array, mailbox_data, version=self.protocol.version)
        payload.append(mailbox_data_array)
        return set_xml_value(payload, free_busy_view_options, version=self.protocol.version)

    @staticmethod
    def _response_messages_tag():
        return f&#34;{{{MNS}}}FreeBusyResponseArray&#34;

    @classmethod
    def _response_message_tag(cls):
        return f&#34;{{{MNS}}}FreeBusyResponse&#34;

    def _get_elements_in_response(self, response):
        for msg in response:
            container_or_exc = self._get_element_container(message=msg.find(f&#34;{{{MNS}}}ResponseMessage&#34;))
            if isinstance(container_or_exc, Exception):
                yield container_or_exc
            else:
                yield from self._get_elements_in_container(container=msg)

    @classmethod
    def _get_elements_in_container(cls, container):
        return [container.find(f&#34;{{{MNS}}}FreeBusyView&#34;)]</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.GetUserAvailability.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.GetUserAvailability.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, mailbox_data, timezone, free_busy_view_options)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, mailbox_data, timezone, free_busy_view_options):
    # TODO: Also supports SuggestionsViewOptions, see
    #  https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/suggestionsviewoptions
    return self._elems_to_objs(
        self._chunked_get_elements(
            self.get_payload,
            items=mailbox_data,
            timezone=timezone,
            free_busy_view_options=free_busy_view_options,
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.GetUserAvailability.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, mailbox_data, timezone, free_busy_view_options)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, mailbox_data, timezone, free_busy_view_options):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}Request&#34;)
    set_xml_value(payload, timezone, version=self.protocol.version)
    mailbox_data_array = create_element(&#34;m:MailboxDataArray&#34;)
    set_xml_value(mailbox_data_array, mailbox_data, version=self.protocol.version)
    payload.append(mailbox_data_array)
    return set_xml_value(payload, free_busy_view_options, version=self.protocol.version)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.GetUserConfiguration"><code class="flex name class">
<span>class <span class="ident">GetUserConfiguration</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getuserconfiguration-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getuserconfiguration-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GetUserConfiguration(EWSAccountService):
    &#34;&#34;&#34;MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getuserconfiguration-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;GetUserConfiguration&#34;

    def call(self, user_configuration_name, properties):
        if properties not in PROPERTIES_CHOICES:
            raise InvalidEnumValue(&#34;properties&#34;, properties, PROPERTIES_CHOICES)
        return self._elems_to_objs(
            self._get_elements(
                payload=self.get_payload(user_configuration_name=user_configuration_name, properties=properties)
            )
        )

    def _elem_to_obj(self, elem):
        return UserConfiguration.from_xml(elem=elem, account=self.account)

    @classmethod
    def _get_elements_in_container(cls, container):
        return container.findall(UserConfiguration.response_tag())

    def get_payload(self, user_configuration_name, properties):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        set_xml_value(payload, user_configuration_name, version=self.account.version)
        payload.append(
            set_xml_value(create_element(&#34;m:UserConfigurationProperties&#34;), properties, version=self.account.version)
        )
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.GetUserConfiguration.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.GetUserConfiguration.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, user_configuration_name, properties)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, user_configuration_name, properties):
    if properties not in PROPERTIES_CHOICES:
        raise InvalidEnumValue(&#34;properties&#34;, properties, PROPERTIES_CHOICES)
    return self._elems_to_objs(
        self._get_elements(
            payload=self.get_payload(user_configuration_name=user_configuration_name, properties=properties)
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.GetUserConfiguration.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, user_configuration_name, properties)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, user_configuration_name, properties):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    set_xml_value(payload, user_configuration_name, version=self.account.version)
    payload.append(
        set_xml_value(create_element(&#34;m:UserConfigurationProperties&#34;), properties, version=self.account.version)
    )
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.GetUserOofSettings"><code class="flex name class">
<span>class <span class="ident">GetUserOofSettings</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Get automatic reply settings for the specified mailbox.
MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getuseroofsettings-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getuseroofsettings-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GetUserOofSettings(EWSAccountService):
    &#34;&#34;&#34;Get automatic reply settings for the specified mailbox.
    MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getuseroofsettings-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;GetUserOofSettings&#34;
    element_container_name = f&#34;{{{TNS}}}OofSettings&#34;

    def call(self, mailbox):
        return self._elems_to_objs(self._get_elements(payload=self.get_payload(mailbox=mailbox)))

    def _elem_to_obj(self, elem):
        return OofSettings.from_xml(elem=elem, account=self.account)

    def get_payload(self, mailbox):
        return set_xml_value(
            create_element(f&#34;m:{self.SERVICE_NAME}Request&#34;),
            AvailabilityMailbox.from_mailbox(mailbox),
            version=self.account.version,
        )

    @classmethod
    def _get_elements_in_container(cls, container):
        # This service only returns one result, directly in &#39;container&#39;
        return [container]

    def _get_element_container(self, message, name=None):
        # This service returns the result container outside the response message
        super()._get_element_container(message=message.find(self._response_message_tag()), name=None)
        return message.find(name)

    @classmethod
    def _response_message_tag(cls):
        return f&#34;{{{MNS}}}ResponseMessage&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.GetUserOofSettings.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetUserOofSettings.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.GetUserOofSettings.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, mailbox)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, mailbox):
    return self._elems_to_objs(self._get_elements(payload=self.get_payload(mailbox=mailbox)))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.GetUserOofSettings.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, mailbox)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, mailbox):
    return set_xml_value(
        create_element(f&#34;m:{self.SERVICE_NAME}Request&#34;),
        AvailabilityMailbox.from_mailbox(mailbox),
        version=self.account.version,
    )</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.GetUserSettings"><code class="flex name class">
<span>class <span class="ident">GetUserSettings</span></span>
<span>(</span><span>protocol, chunk_size=None, timeout=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Take a list of users and requested Autodiscover settings for these users. Returns the requested settings values.</p>
<p>MSDN:
<a href="https://learn.microsoft.com/en-us/exchange/client-developer/web-service-reference/getusersettings-operation-soap">https://learn.microsoft.com/en-us/exchange/client-developer/web-service-reference/getusersettings-operation-soap</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GetUserSettings(EWSService):
    &#34;&#34;&#34;Take a list of users and requested Autodiscover settings for these users. Returns the requested settings values.

    MSDN:
    https://learn.microsoft.com/en-us/exchange/client-developer/web-service-reference/getusersettings-operation-soap
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;GetUserSettings&#34;
    NS_MAP = {k: v for k, v in ns_translation.items() if k in (&#34;s&#34;, &#34;t&#34;, &#34;a&#34;, &#34;wsa&#34;, &#34;xsi&#34;)}
    element_container_name = f&#34;{{{ANS}}}UserResponses&#34;
    supported_from = EXCHANGE_2010

    def call(self, users, settings):
        return self._elems_to_objs(self._get_elements(self.get_payload(users=users, settings=settings)))

    def wrap(self, content, api_version=None):
        envelope = create_element(&#34;s:Envelope&#34;, nsmap=self.NS_MAP)
        header = create_element(&#34;s:Header&#34;)
        if api_version:
            add_xml_child(header, &#34;a:RequestedServerVersion&#34;, api_version)
        action = f&#34;http://schemas.microsoft.com/exchange/2010/Autodiscover/Autodiscover/{self.SERVICE_NAME}&#34;
        add_xml_child(header, &#34;wsa:Action&#34;, action)
        add_xml_child(header, &#34;wsa:To&#34;, self.protocol.service_endpoint)
        identity = self._account_to_impersonate
        if identity:
            add_xml_child(header, &#34;t:ExchangeImpersonation&#34;, identity)
        envelope.append(header)
        body = create_element(&#34;s:Body&#34;)
        body.append(content)
        envelope.append(body)
        return xml_to_str(envelope, encoding=DEFAULT_ENCODING, xml_declaration=True)

    def _elem_to_obj(self, elem):
        return UserResponse.from_xml(elem=elem, account=None)

    def get_payload(self, users, settings):
        payload = create_element(f&#34;a:{self.SERVICE_NAME}RequestMessage&#34;)
        request = create_element(&#34;a:Request&#34;)
        users_elem = create_element(&#34;a:Users&#34;)
        for user in users:
            mailbox = create_element(&#34;a:Mailbox&#34;)
            set_xml_value(mailbox, user)
            add_xml_child(users_elem, &#34;a:User&#34;, mailbox)
        if not len(users_elem):
            raise ValueError(&#34;&#39;users&#39; must not be empty&#34;)
        request.append(users_elem)
        requested_settings = create_element(&#34;a:RequestedSettings&#34;)
        for setting in settings:
            add_xml_child(requested_settings, &#34;a:Setting&#34;, UserResponse.SETTINGS_MAP[setting])
        if not len(requested_settings):
            raise ValueError(&#34;&#39;requested_settings&#39; must not be empty&#34;)
        request.append(requested_settings)
        payload.append(request)
        return payload

    @classmethod
    def _response_tag(cls):
        &#34;&#34;&#34;Return the name of the element containing the service response.&#34;&#34;&#34;
        return f&#34;{{{ANS}}}{cls.SERVICE_NAME}ResponseMessage&#34;

    def _get_element_container(self, message, name=None):
        response = message.find(f&#34;{{{ANS}}}Response&#34;)
        # ErrorCode: See
        # https://learn.microsoft.com/en-us/exchange/client-developer/web-service-reference/errorcode-soap
        # There are two &#39;ErrorCode&#39; elements in the response; one is a child of the &#39;Response&#39; element, the other is a
        # child of the &#39;UserResponse&#39; element. Let&#39;s handle both with the same code.
        res = UserResponse.parse_elem(response)
        if isinstance(res, Exception):
            raise res
        if res.error_code == &#34;NoError&#34;:
            container = response.find(name)
            if container is None:
                raise MalformedResponseError(f&#34;No {name} elements in ResponseMessage ({xml_to_str(response)})&#34;)
            return container
        # Raise any non-acceptable errors in the container, or return the acceptable exception instance
        try:
            raise self._get_exception(code=res.error_code, text=res.error_message, msg_xml=None)
        except self.ERRORS_TO_CATCH_IN_RESPONSE as e:
            return e</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.GetUserSettings.NS_MAP"><code class="name">var <span class="ident">NS_MAP</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetUserSettings.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetUserSettings.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.GetUserSettings.supported_from"><code class="name">var <span class="ident">supported_from</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.GetUserSettings.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, users, settings)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, users, settings):
    return self._elems_to_objs(self._get_elements(self.get_payload(users=users, settings=settings)))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.GetUserSettings.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, users, settings)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, users, settings):
    payload = create_element(f&#34;a:{self.SERVICE_NAME}RequestMessage&#34;)
    request = create_element(&#34;a:Request&#34;)
    users_elem = create_element(&#34;a:Users&#34;)
    for user in users:
        mailbox = create_element(&#34;a:Mailbox&#34;)
        set_xml_value(mailbox, user)
        add_xml_child(users_elem, &#34;a:User&#34;, mailbox)
    if not len(users_elem):
        raise ValueError(&#34;&#39;users&#39; must not be empty&#34;)
    request.append(users_elem)
    requested_settings = create_element(&#34;a:RequestedSettings&#34;)
    for setting in settings:
        add_xml_child(requested_settings, &#34;a:Setting&#34;, UserResponse.SETTINGS_MAP[setting])
    if not len(requested_settings):
        raise ValueError(&#34;&#39;requested_settings&#39; must not be empty&#34;)
    request.append(requested_settings)
    payload.append(request)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.MarkAsJunk"><code class="flex name class">
<span>class <span class="ident">MarkAsJunk</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/markasjunk-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/markasjunk-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MarkAsJunk(EWSAccountService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/markasjunk-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;MarkAsJunk&#34;

    def call(self, items, is_junk, move_item):
        return self._elems_to_objs(
            self._chunked_get_elements(self.get_payload, items=items, is_junk=is_junk, move_item=move_item)
        )

    def _elem_to_obj(self, elem):
        return MovedItemId.id_from_xml(elem)

    @classmethod
    def _get_elements_in_container(cls, container):
        return container.findall(MovedItemId.response_tag())

    def get_payload(self, items, is_junk, move_item):
        # Takes a list of items and returns either success or raises an error message
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(IsJunk=is_junk, MoveItem=move_item))
        payload.append(item_ids_element(items=items, version=self.account.version))
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.MarkAsJunk.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.MarkAsJunk.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, items, is_junk, move_item)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, items, is_junk, move_item):
    return self._elems_to_objs(
        self._chunked_get_elements(self.get_payload, items=items, is_junk=is_junk, move_item=move_item)
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.MarkAsJunk.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, items, is_junk, move_item)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, items, is_junk, move_item):
    # Takes a list of items and returns either success or raises an error message
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(IsJunk=is_junk, MoveItem=move_item))
    payload.append(item_ids_element(items=items, version=self.account.version))
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.MoveFolder"><code class="flex name class">
<span>class <span class="ident">MoveFolder</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/movefolder-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/movefolder-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MoveFolder(EWSAccountService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/movefolder-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;MoveFolder&#34;
    element_container_name = f&#34;{{{MNS}}}Folders&#34;

    def call(self, folders, to_folder):
        if not isinstance(to_folder, (BaseFolder, FolderId)):
            raise InvalidTypeError(&#34;to_folder&#34;, to_folder, (BaseFolder, FolderId))
        return self._elems_to_objs(self._chunked_get_elements(self.get_payload, items=folders, to_folder=to_folder))

    def _elem_to_obj(self, elem):
        return FolderId.from_xml(elem=elem.find(FolderId.response_tag()), account=self.account)

    def get_payload(self, folders, to_folder):
        # Takes a list of folders and returns their new folder IDs
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        payload.append(folder_ids_element(folders=[to_folder], version=self.account.version, tag=&#34;m:ToFolderId&#34;))
        payload.append(folder_ids_element(folders=folders, version=self.account.version))
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.MoveFolder.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.MoveFolder.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.MoveFolder.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, folders, to_folder)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, folders, to_folder):
    if not isinstance(to_folder, (BaseFolder, FolderId)):
        raise InvalidTypeError(&#34;to_folder&#34;, to_folder, (BaseFolder, FolderId))
    return self._elems_to_objs(self._chunked_get_elements(self.get_payload, items=folders, to_folder=to_folder))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.MoveFolder.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, folders, to_folder)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, folders, to_folder):
    # Takes a list of folders and returns their new folder IDs
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    payload.append(folder_ids_element(folders=[to_folder], version=self.account.version, tag=&#34;m:ToFolderId&#34;))
    payload.append(folder_ids_element(folders=folders, version=self.account.version))
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.MoveItem"><code class="flex name class">
<span>class <span class="ident">MoveItem</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/moveitem-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/moveitem-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MoveItem(EWSAccountService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/moveitem-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;MoveItem&#34;
    element_container_name = f&#34;{{{MNS}}}Items&#34;

    def call(self, items, to_folder):
        if not isinstance(to_folder, (BaseFolder, FolderId)):
            raise InvalidTypeError(&#34;to_folder&#34;, to_folder, (BaseFolder, FolderId))
        return self._elems_to_objs(self._chunked_get_elements(self.get_payload, items=items, to_folder=to_folder))

    def _elem_to_obj(self, elem):
        return Item.id_from_xml(elem)

    def get_payload(self, items, to_folder):
        # Takes a list of items and returns their new item IDs
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        payload.append(folder_ids_element(folders=[to_folder], version=self.account.version, tag=&#34;m:ToFolderId&#34;))
        payload.append(item_ids_element(items=items, version=self.account.version))
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="exchangelib.services.copy_item.CopyItem" href="copy_item.html#exchangelib.services.copy_item.CopyItem">CopyItem</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.MoveItem.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.MoveItem.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.MoveItem.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, items, to_folder)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, items, to_folder):
    if not isinstance(to_folder, (BaseFolder, FolderId)):
        raise InvalidTypeError(&#34;to_folder&#34;, to_folder, (BaseFolder, FolderId))
    return self._elems_to_objs(self._chunked_get_elements(self.get_payload, items=items, to_folder=to_folder))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.MoveItem.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, items, to_folder)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, items, to_folder):
    # Takes a list of items and returns their new item IDs
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    payload.append(folder_ids_element(folders=[to_folder], version=self.account.version, tag=&#34;m:ToFolderId&#34;))
    payload.append(item_ids_element(items=items, version=self.account.version))
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.ResolveNames"><code class="flex name class">
<span>class <span class="ident">ResolveNames</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/resolvenames-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/resolvenames-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ResolveNames(EWSService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/resolvenames-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;ResolveNames&#34;
    element_container_name = f&#34;{{{MNS}}}ResolutionSet&#34;
    ERRORS_TO_CATCH_IN_RESPONSE = ErrorNameResolutionNoResults
    WARNINGS_TO_IGNORE_IN_RESPONSE = ErrorNameResolutionMultipleResults

    # According to the &#39;Remarks&#39; section of the MSDN documentation referenced above, at most 100 candidates are
    # returned for a lookup.
    # Note: paging information is returned as attrs on the &#39;ResolutionSet&#39; element, but this service does not
    # support the &#39;IndexedPageItemView&#39; element, so it&#39;s not really a paging service.
    candidates_limit = 100

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self.return_full_contact_data = False  # A hack to communicate parsing args to _elems_to_objs()

    def call(
        self,
        unresolved_entries,
        parent_folders=None,
        return_full_contact_data=False,
        search_scope=None,
        contact_data_shape=None,
    ):
        if self.chunk_size &gt; 100:
            raise ValueError(
                f&#34;Chunk size {self.chunk_size} is too high. {self.SERVICE_NAME} supports returning at most 100 &#34;
                f&#34;candidates for a lookup&#34;,
            )
        if search_scope and search_scope not in SEARCH_SCOPE_CHOICES:
            raise InvalidEnumValue(&#34;search_scope&#34;, search_scope, SEARCH_SCOPE_CHOICES)
        if contact_data_shape and contact_data_shape not in SHAPE_CHOICES:
            raise InvalidEnumValue(&#34;contact_data_shape&#34;, contact_data_shape, SHAPE_CHOICES)
        self.return_full_contact_data = return_full_contact_data
        return self._elems_to_objs(
            self._chunked_get_elements(
                self.get_payload,
                items=unresolved_entries,
                parent_folders=parent_folders,
                return_full_contact_data=return_full_contact_data,
                search_scope=search_scope,
                contact_data_shape=contact_data_shape,
            )
        )

    def _get_element_container(self, message, name=None):
        container_or_exc = super()._get_element_container(message=message, name=name)
        if isinstance(container_or_exc, Exception):
            return container_or_exc
        is_last_page = container_or_exc.get(&#34;IncludesLastItemInRange&#34;).lower() in (&#34;true&#34;, &#34;0&#34;)
        log.debug(&#34;Includes last item in range: %s&#34;, is_last_page)
        if not is_last_page:
            warnings.warn(
                f&#34;The {self.__class__.__name__} service returns at most {self.candidates_limit} candidates and does &#34;
                f&#34;not support paging. You have reached this limit and have not received the exhaustive list of &#34;
                f&#34;candidates.&#34;
            )
        return container_or_exc

    def _elem_to_obj(self, elem):
        if self.return_full_contact_data:
            mailbox_elem = elem.find(Mailbox.response_tag())
            contact_elem = elem.find(Contact.response_tag())
            return (
                None if mailbox_elem is None else Mailbox.from_xml(elem=mailbox_elem, account=None),
                None if contact_elem is None else Contact.from_xml(elem=contact_elem, account=None),
            )
        return Mailbox.from_xml(elem=elem.find(Mailbox.response_tag()), account=None)

    def get_payload(
        self, unresolved_entries, parent_folders, return_full_contact_data, search_scope, contact_data_shape
    ):
        attrs = dict(ReturnFullContactData=return_full_contact_data)
        if search_scope:
            attrs[&#34;SearchScope&#34;] = search_scope
        if contact_data_shape:
            if self.protocol.version.build &lt; EXCHANGE_2010_SP2:
                raise NotImplementedError(
                    &#34;&#39;contact_data_shape&#39; is only supported for Exchange 2010 SP2 servers and later&#34;
                )
            attrs[&#34;ContactDataShape&#34;] = contact_data_shape
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=attrs)
        if parent_folders:
            payload.append(
                folder_ids_element(folders=parent_folders, version=self.protocol.version, tag=&#34;m:ParentFolderIds&#34;)
            )
        for entry in unresolved_entries:
            add_xml_child(payload, &#34;m:UnresolvedEntry&#34;, entry)
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.ResolveNames.ERRORS_TO_CATCH_IN_RESPONSE"><code class="name">var <span class="ident">ERRORS_TO_CATCH_IN_RESPONSE</span></code></dt>
<dd>
<div class="desc"><p>Global error type within this module.</p></div>
</dd>
<dt id="exchangelib.services.ResolveNames.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.ResolveNames.WARNINGS_TO_IGNORE_IN_RESPONSE"><code class="name">var <span class="ident">WARNINGS_TO_IGNORE_IN_RESPONSE</span></code></dt>
<dd>
<div class="desc"><p>Global error type within this module.</p></div>
</dd>
<dt id="exchangelib.services.ResolveNames.candidates_limit"><code class="name">var <span class="ident">candidates_limit</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.ResolveNames.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.ResolveNames.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, unresolved_entries, parent_folders=None, return_full_contact_data=False, search_scope=None, contact_data_shape=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(
    self,
    unresolved_entries,
    parent_folders=None,
    return_full_contact_data=False,
    search_scope=None,
    contact_data_shape=None,
):
    if self.chunk_size &gt; 100:
        raise ValueError(
            f&#34;Chunk size {self.chunk_size} is too high. {self.SERVICE_NAME} supports returning at most 100 &#34;
            f&#34;candidates for a lookup&#34;,
        )
    if search_scope and search_scope not in SEARCH_SCOPE_CHOICES:
        raise InvalidEnumValue(&#34;search_scope&#34;, search_scope, SEARCH_SCOPE_CHOICES)
    if contact_data_shape and contact_data_shape not in SHAPE_CHOICES:
        raise InvalidEnumValue(&#34;contact_data_shape&#34;, contact_data_shape, SHAPE_CHOICES)
    self.return_full_contact_data = return_full_contact_data
    return self._elems_to_objs(
        self._chunked_get_elements(
            self.get_payload,
            items=unresolved_entries,
            parent_folders=parent_folders,
            return_full_contact_data=return_full_contact_data,
            search_scope=search_scope,
            contact_data_shape=contact_data_shape,
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.ResolveNames.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, unresolved_entries, parent_folders, return_full_contact_data, search_scope, contact_data_shape)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(
    self, unresolved_entries, parent_folders, return_full_contact_data, search_scope, contact_data_shape
):
    attrs = dict(ReturnFullContactData=return_full_contact_data)
    if search_scope:
        attrs[&#34;SearchScope&#34;] = search_scope
    if contact_data_shape:
        if self.protocol.version.build &lt; EXCHANGE_2010_SP2:
            raise NotImplementedError(
                &#34;&#39;contact_data_shape&#39; is only supported for Exchange 2010 SP2 servers and later&#34;
            )
        attrs[&#34;ContactDataShape&#34;] = contact_data_shape
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=attrs)
    if parent_folders:
        payload.append(
            folder_ids_element(folders=parent_folders, version=self.protocol.version, tag=&#34;m:ParentFolderIds&#34;)
        )
    for entry in unresolved_entries:
        add_xml_child(payload, &#34;m:UnresolvedEntry&#34;, entry)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.SendItem"><code class="flex name class">
<span>class <span class="ident">SendItem</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/senditem-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/senditem-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SendItem(EWSAccountService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/senditem-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;SendItem&#34;
    returns_elements = False

    def call(self, items, saved_item_folder):
        if saved_item_folder and not isinstance(saved_item_folder, (BaseFolder, FolderId)):
            raise InvalidTypeError(&#34;saved_item_folder&#34;, saved_item_folder, (BaseFolder, FolderId))
        return self._chunked_get_elements(self.get_payload, items=items, saved_item_folder=saved_item_folder)

    def get_payload(self, items, saved_item_folder):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(SaveItemToFolder=bool(saved_item_folder)))
        payload.append(item_ids_element(items=items, version=self.account.version))
        if saved_item_folder:
            payload.append(
                folder_ids_element(folders=[saved_item_folder], version=self.account.version, tag=&#34;m:SavedItemFolderId&#34;)
            )
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.SendItem.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.SendItem.returns_elements"><code class="name">var <span class="ident">returns_elements</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.SendItem.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, items, saved_item_folder)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, items, saved_item_folder):
    if saved_item_folder and not isinstance(saved_item_folder, (BaseFolder, FolderId)):
        raise InvalidTypeError(&#34;saved_item_folder&#34;, saved_item_folder, (BaseFolder, FolderId))
    return self._chunked_get_elements(self.get_payload, items=items, saved_item_folder=saved_item_folder)</code></pre>
</details>
</dd>
<dt id="exchangelib.services.SendItem.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, items, saved_item_folder)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, items, saved_item_folder):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=dict(SaveItemToFolder=bool(saved_item_folder)))
    payload.append(item_ids_element(items=items, version=self.account.version))
    if saved_item_folder:
        payload.append(
            folder_ids_element(folders=[saved_item_folder], version=self.account.version, tag=&#34;m:SavedItemFolderId&#34;)
        )
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.SendNotification"><code class="flex name class">
<span>class <span class="ident">SendNotification</span></span>
<span>(</span><span>protocol, chunk_size=None, timeout=None)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/sendnotification">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/sendnotification</a></p>
<p>This service is implemented backwards compared to other services. We use it to parse the XML body of push
notifications we receive on the callback URL defined in a push subscription, and to create responses to these
push notifications.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SendNotification(EWSService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/sendnotification

    This service is implemented backwards compared to other services. We use it to parse the XML body of push
    notifications we receive on the callback URL defined in a push subscription, and to create responses to these
    push notifications.
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;SendNotification&#34;
    OK = &#34;OK&#34;
    UNSUBSCRIBE = &#34;Unsubscribe&#34;
    STATUS_CHOICES = (OK, UNSUBSCRIBE)

    def ok_payload(self):
        return self.wrap(content=self.get_payload(status=self.OK))

    def unsubscribe_payload(self):
        return self.wrap(content=self.get_payload(status=self.UNSUBSCRIBE))

    def _elem_to_obj(self, elem):
        return Notification.from_xml(elem=elem, account=None)

    @classmethod
    def _response_tag(cls):
        &#34;&#34;&#34;Return the name of the element containing the service response.&#34;&#34;&#34;
        return f&#34;{{{MNS}}}{cls.SERVICE_NAME}&#34;

    @classmethod
    def _get_elements_in_container(cls, container):
        return container.findall(Notification.response_tag())

    def get_payload(self, status):
        if status not in self.STATUS_CHOICES:
            raise InvalidEnumValue(&#34;status&#34;, status, self.STATUS_CHOICES)
        payload = create_element(f&#34;m:{self.SERVICE_NAME}Result&#34;)
        add_xml_child(payload, &#34;m:SubscriptionStatus&#34;, status)
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.SendNotification.OK"><code class="name">var <span class="ident">OK</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.SendNotification.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.SendNotification.STATUS_CHOICES"><code class="name">var <span class="ident">STATUS_CHOICES</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.SendNotification.UNSUBSCRIBE"><code class="name">var <span class="ident">UNSUBSCRIBE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.SendNotification.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, status)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, status):
    if status not in self.STATUS_CHOICES:
        raise InvalidEnumValue(&#34;status&#34;, status, self.STATUS_CHOICES)
    payload = create_element(f&#34;m:{self.SERVICE_NAME}Result&#34;)
    add_xml_child(payload, &#34;m:SubscriptionStatus&#34;, status)
    return payload</code></pre>
</details>
</dd>
<dt id="exchangelib.services.SendNotification.ok_payload"><code class="name flex">
<span>def <span class="ident">ok_payload</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def ok_payload(self):
    return self.wrap(content=self.get_payload(status=self.OK))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.SendNotification.unsubscribe_payload"><code class="name flex">
<span>def <span class="ident">unsubscribe_payload</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def unsubscribe_payload(self):
    return self.wrap(content=self.get_payload(status=self.UNSUBSCRIBE))</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.SetUserOofSettings"><code class="flex name class">
<span>class <span class="ident">SetUserOofSettings</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Set automatic replies for the specified mailbox.
MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/setuseroofsettings-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/setuseroofsettings-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SetUserOofSettings(EWSAccountService):
    &#34;&#34;&#34;Set automatic replies for the specified mailbox.
    MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/setuseroofsettings-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;SetUserOofSettings&#34;
    returns_elements = False

    def call(self, oof_settings, mailbox):
        if not isinstance(oof_settings, OofSettings):
            raise InvalidTypeError(&#34;oof_settings&#34;, oof_settings, OofSettings)
        if not isinstance(mailbox, Mailbox):
            raise InvalidTypeError(&#34;mailbox&#34;, mailbox, Mailbox)
        return self._get_elements(payload=self.get_payload(oof_settings=oof_settings, mailbox=mailbox))

    def get_payload(self, oof_settings, mailbox):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}Request&#34;)
        set_xml_value(payload, AvailabilityMailbox.from_mailbox(mailbox), version=self.account.version)
        return set_xml_value(payload, oof_settings, version=self.account.version)

    def _get_element_container(self, message, name=None):
        message = message.find(self._response_message_tag())
        return super()._get_element_container(message=message, name=name)

    @classmethod
    def _response_message_tag(cls):
        return f&#34;{{{MNS}}}ResponseMessage&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.SetUserOofSettings.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.SetUserOofSettings.returns_elements"><code class="name">var <span class="ident">returns_elements</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.SetUserOofSettings.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, oof_settings, mailbox)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, oof_settings, mailbox):
    if not isinstance(oof_settings, OofSettings):
        raise InvalidTypeError(&#34;oof_settings&#34;, oof_settings, OofSettings)
    if not isinstance(mailbox, Mailbox):
        raise InvalidTypeError(&#34;mailbox&#34;, mailbox, Mailbox)
    return self._get_elements(payload=self.get_payload(oof_settings=oof_settings, mailbox=mailbox))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.SetUserOofSettings.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, oof_settings, mailbox)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, oof_settings, mailbox):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}Request&#34;)
    set_xml_value(payload, AvailabilityMailbox.from_mailbox(mailbox), version=self.account.version)
    return set_xml_value(payload, oof_settings, version=self.account.version)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.SubscribeToPull"><code class="flex name class">
<span>class <span class="ident">SubscribeToPull</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Base class for subscription classes.</p>
<p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/subscribe-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/subscribe-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SubscribeToPull(Subscribe):
    subscription_request_elem_tag = &#34;m:PullSubscriptionRequest&#34;
    prefer_affinity = True

    def call(self, folders, event_types, watermark, timeout):
        yield from self._partial_call(
            payload_func=self.get_payload,
            folders=folders,
            event_types=event_types,
            timeout=timeout,
            watermark=watermark,
        )

    def get_payload(self, folders, event_types, watermark, timeout):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        request_elem = self._partial_payload(folders=folders, event_types=event_types)
        if watermark:
            add_xml_child(request_elem, &#34;m:Watermark&#34;, watermark)
        add_xml_child(request_elem, &#34;t:Timeout&#34;, timeout)  # In minutes
        payload.append(request_elem)
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.subscribe.Subscribe" href="subscribe.html#exchangelib.services.subscribe.Subscribe">Subscribe</a></li>
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.SubscribeToPull.prefer_affinity"><code class="name">var <span class="ident">prefer_affinity</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.SubscribeToPull.subscription_request_elem_tag"><code class="name">var <span class="ident">subscription_request_elem_tag</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.SubscribeToPull.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, folders, event_types, watermark, timeout)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, folders, event_types, watermark, timeout):
    yield from self._partial_call(
        payload_func=self.get_payload,
        folders=folders,
        event_types=event_types,
        timeout=timeout,
        watermark=watermark,
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.SubscribeToPull.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, folders, event_types, watermark, timeout)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, folders, event_types, watermark, timeout):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    request_elem = self._partial_payload(folders=folders, event_types=event_types)
    if watermark:
        add_xml_child(request_elem, &#34;m:Watermark&#34;, watermark)
    add_xml_child(request_elem, &#34;t:Timeout&#34;, timeout)  # In minutes
    payload.append(request_elem)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.subscribe.Subscribe" href="subscribe.html#exchangelib.services.subscribe.Subscribe">Subscribe</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.subscribe.Subscribe.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.subscribe.Subscribe.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.subscribe.Subscribe.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.subscribe.Subscribe.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.subscribe.Subscribe.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.subscribe.Subscribe.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.SubscribeToPush"><code class="flex name class">
<span>class <span class="ident">SubscribeToPush</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Base class for subscription classes.</p>
<p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/subscribe-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/subscribe-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SubscribeToPush(Subscribe):
    subscription_request_elem_tag = &#34;m:PushSubscriptionRequest&#34;

    def call(self, folders, event_types, watermark, status_frequency, url):
        yield from self._partial_call(
            payload_func=self.get_payload,
            folders=folders,
            event_types=event_types,
            status_frequency=status_frequency,
            url=url,
            watermark=watermark,
        )

    def get_payload(self, folders, event_types, watermark, status_frequency, url):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        request_elem = self._partial_payload(folders=folders, event_types=event_types)
        if watermark:
            add_xml_child(request_elem, &#34;m:Watermark&#34;, watermark)
        add_xml_child(request_elem, &#34;t:StatusFrequency&#34;, status_frequency)  # In minutes
        add_xml_child(request_elem, &#34;t:URL&#34;, url)
        payload.append(request_elem)
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.subscribe.Subscribe" href="subscribe.html#exchangelib.services.subscribe.Subscribe">Subscribe</a></li>
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.SubscribeToPush.subscription_request_elem_tag"><code class="name">var <span class="ident">subscription_request_elem_tag</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.SubscribeToPush.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, folders, event_types, watermark, status_frequency, url)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, folders, event_types, watermark, status_frequency, url):
    yield from self._partial_call(
        payload_func=self.get_payload,
        folders=folders,
        event_types=event_types,
        status_frequency=status_frequency,
        url=url,
        watermark=watermark,
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.SubscribeToPush.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, folders, event_types, watermark, status_frequency, url)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, folders, event_types, watermark, status_frequency, url):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    request_elem = self._partial_payload(folders=folders, event_types=event_types)
    if watermark:
        add_xml_child(request_elem, &#34;m:Watermark&#34;, watermark)
    add_xml_child(request_elem, &#34;t:StatusFrequency&#34;, status_frequency)  # In minutes
    add_xml_child(request_elem, &#34;t:URL&#34;, url)
    payload.append(request_elem)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.subscribe.Subscribe" href="subscribe.html#exchangelib.services.subscribe.Subscribe">Subscribe</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.subscribe.Subscribe.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.subscribe.Subscribe.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.subscribe.Subscribe.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.subscribe.Subscribe.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.subscribe.Subscribe.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.subscribe.Subscribe.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.SubscribeToStreaming"><code class="flex name class">
<span>class <span class="ident">SubscribeToStreaming</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Base class for subscription classes.</p>
<p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/subscribe-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/subscribe-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SubscribeToStreaming(Subscribe):
    subscription_request_elem_tag = &#34;m:StreamingSubscriptionRequest&#34;
    prefer_affinity = True

    def call(self, folders, event_types):
        yield from self._partial_call(payload_func=self.get_payload, folders=folders, event_types=event_types)

    def _elem_to_obj(self, elem):
        return elem.text

    @classmethod
    def _get_elements_in_container(cls, container):
        return [container.find(f&#34;{{{MNS}}}SubscriptionId&#34;)]

    def get_payload(self, folders, event_types):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        payload.append(self._partial_payload(folders=folders, event_types=event_types))
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.subscribe.Subscribe" href="subscribe.html#exchangelib.services.subscribe.Subscribe">Subscribe</a></li>
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.SubscribeToStreaming.prefer_affinity"><code class="name">var <span class="ident">prefer_affinity</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.SubscribeToStreaming.subscription_request_elem_tag"><code class="name">var <span class="ident">subscription_request_elem_tag</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.SubscribeToStreaming.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, folders, event_types)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, folders, event_types):
    yield from self._partial_call(payload_func=self.get_payload, folders=folders, event_types=event_types)</code></pre>
</details>
</dd>
<dt id="exchangelib.services.SubscribeToStreaming.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, folders, event_types)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, folders, event_types):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    payload.append(self._partial_payload(folders=folders, event_types=event_types))
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.subscribe.Subscribe" href="subscribe.html#exchangelib.services.subscribe.Subscribe">Subscribe</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.subscribe.Subscribe.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.subscribe.Subscribe.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.subscribe.Subscribe.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.subscribe.Subscribe.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.subscribe.Subscribe.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.subscribe.Subscribe.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.SyncFolderHierarchy"><code class="flex name class">
<span>class <span class="ident">SyncFolderHierarchy</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/syncfolderhierarchy-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/syncfolderhierarchy-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SyncFolderHierarchy(SyncFolder):
    &#34;&#34;&#34;MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/syncfolderhierarchy-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;SyncFolderHierarchy&#34;
    shape_tag = &#34;m:FolderShape&#34;
    last_in_range_name = f&#34;{{{MNS}}}IncludesLastFolderInRange&#34;

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self.folder = None  # A hack to communicate parsing args to _elems_to_objs()

    def call(self, folder, shape, additional_fields, sync_state):
        self.sync_state = sync_state
        self.folder = folder
        return self._elems_to_objs(
            self._get_elements(
                payload=self.get_payload(
                    folder=folder,
                    shape=shape,
                    additional_fields=additional_fields,
                    sync_state=sync_state,
                )
            )
        )

    def _elem_to_obj(self, elem):
        change_type = self.change_types_map[elem.tag]
        if change_type == self.DELETE:
            folder = FolderId.from_xml(elem=elem.find(FolderId.response_tag()), account=self.account)
        else:
            # We can&#39;t find() the element because we don&#39;t know which tag to look for. The change element can
            # contain multiple folder types, each with their own tag.
            folder_elem = elem[0]
            folder = parse_folder_elem(elem=folder_elem, folder=self.folder, account=self.account)
        return change_type, folder

    def get_payload(self, folder, shape, additional_fields, sync_state):
        return self._partial_get_payload(
            folder=folder, shape=shape, additional_fields=additional_fields, sync_state=sync_state
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.sync_folder_hierarchy.SyncFolder" href="sync_folder_hierarchy.html#exchangelib.services.sync_folder_hierarchy.SyncFolder">SyncFolder</a></li>
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.SyncFolderHierarchy.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.SyncFolderHierarchy.last_in_range_name"><code class="name">var <span class="ident">last_in_range_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.SyncFolderHierarchy.shape_tag"><code class="name">var <span class="ident">shape_tag</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.SyncFolderHierarchy.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, folder, shape, additional_fields, sync_state)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, folder, shape, additional_fields, sync_state):
    self.sync_state = sync_state
    self.folder = folder
    return self._elems_to_objs(
        self._get_elements(
            payload=self.get_payload(
                folder=folder,
                shape=shape,
                additional_fields=additional_fields,
                sync_state=sync_state,
            )
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.SyncFolderHierarchy.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, folder, shape, additional_fields, sync_state)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, folder, shape, additional_fields, sync_state):
    return self._partial_get_payload(
        folder=folder, shape=shape, additional_fields=additional_fields, sync_state=sync_state
    )</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.sync_folder_hierarchy.SyncFolder" href="sync_folder_hierarchy.html#exchangelib.services.sync_folder_hierarchy.SyncFolder">SyncFolder</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.sync_folder_hierarchy.SyncFolder.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.sync_folder_hierarchy.SyncFolder.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.sync_folder_hierarchy.SyncFolder.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.sync_folder_hierarchy.SyncFolder.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.sync_folder_hierarchy.SyncFolder.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.sync_folder_hierarchy.SyncFolder.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.SyncFolderItems"><code class="flex name class">
<span>class <span class="ident">SyncFolderItems</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/syncfolderitems-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/syncfolderitems-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SyncFolderItems(SyncFolder):
    &#34;&#34;&#34;MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/syncfolderitems-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;SyncFolderItems&#34;
    SYNC_SCOPES = (
        &#34;NormalItems&#34;,
        &#34;NormalAndAssociatedItems&#34;,
    )
    # Extra change type
    READ_FLAG_CHANGE = &#34;read_flag_change&#34;
    CHANGE_TYPES = SyncFolder.CHANGE_TYPES + (READ_FLAG_CHANGE,)
    shape_tag = &#34;m:ItemShape&#34;
    last_in_range_name = f&#34;{{{MNS}}}IncludesLastItemInRange&#34;
    change_types_map = SyncFolder.change_types_map
    change_types_map[f&#34;{{{TNS}}}ReadFlagChange&#34;] = READ_FLAG_CHANGE

    def call(self, folder, shape, additional_fields, sync_state, ignore, max_changes_returned, sync_scope):
        self.sync_state = sync_state
        if max_changes_returned is None:
            max_changes_returned = 100
        if not isinstance(max_changes_returned, int):
            raise InvalidTypeError(&#34;max_changes_returned&#34;, max_changes_returned, int)
        if max_changes_returned &lt;= 0:
            raise ValueError(f&#34;&#39;max_changes_returned&#39; {max_changes_returned} must be a positive integer&#34;)
        if sync_scope is not None and sync_scope not in self.SYNC_SCOPES:
            raise InvalidEnumValue(&#34;sync_scope&#34;, sync_scope, self.SYNC_SCOPES)
        return self._elems_to_objs(
            self._get_elements(
                payload=self.get_payload(
                    folder=folder,
                    shape=shape,
                    additional_fields=additional_fields,
                    sync_state=sync_state,
                    ignore=ignore,
                    max_changes_returned=max_changes_returned,
                    sync_scope=sync_scope,
                )
            )
        )

    def _elem_to_obj(self, elem):
        change_type = self.change_types_map[elem.tag]
        if change_type == self.READ_FLAG_CHANGE:
            item = (
                ItemId.from_xml(elem=elem.find(ItemId.response_tag()), account=self.account),
                xml_text_to_value(elem.find(f&#34;{{{TNS}}}IsRead&#34;).text, bool),
            )
        elif change_type == self.DELETE:
            item = ItemId.from_xml(elem=elem.find(ItemId.response_tag()), account=self.account)
        else:
            # We can&#39;t find() the element because we don&#39;t know which tag to look for. The change element can
            # contain multiple item types, each with their own tag.
            item_elem = elem[0]
            item = BaseFolder.item_model_from_tag(item_elem.tag).from_xml(elem=item_elem, account=self.account)
        return change_type, item

    def get_payload(self, folder, shape, additional_fields, sync_state, ignore, max_changes_returned, sync_scope):
        sync_folder_items = self._partial_get_payload(
            folder=folder, shape=shape, additional_fields=additional_fields, sync_state=sync_state
        )
        is_empty, ignore = (True, None) if ignore is None else peek(ignore)
        if not is_empty:
            sync_folder_items.append(item_ids_element(items=ignore, version=self.account.version, tag=&#34;m:Ignore&#34;))
        add_xml_child(sync_folder_items, &#34;m:MaxChangesReturned&#34;, max_changes_returned)
        if sync_scope:
            add_xml_child(sync_folder_items, &#34;m:SyncScope&#34;, sync_scope)
        return sync_folder_items</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.sync_folder_hierarchy.SyncFolder" href="sync_folder_hierarchy.html#exchangelib.services.sync_folder_hierarchy.SyncFolder">SyncFolder</a></li>
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.SyncFolderItems.CHANGE_TYPES"><code class="name">var <span class="ident">CHANGE_TYPES</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.SyncFolderItems.READ_FLAG_CHANGE"><code class="name">var <span class="ident">READ_FLAG_CHANGE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.SyncFolderItems.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.SyncFolderItems.SYNC_SCOPES"><code class="name">var <span class="ident">SYNC_SCOPES</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.SyncFolderItems.change_types_map"><code class="name">var <span class="ident">change_types_map</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.SyncFolderItems.last_in_range_name"><code class="name">var <span class="ident">last_in_range_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.SyncFolderItems.shape_tag"><code class="name">var <span class="ident">shape_tag</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.SyncFolderItems.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, folder, shape, additional_fields, sync_state, ignore, max_changes_returned, sync_scope)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, folder, shape, additional_fields, sync_state, ignore, max_changes_returned, sync_scope):
    self.sync_state = sync_state
    if max_changes_returned is None:
        max_changes_returned = 100
    if not isinstance(max_changes_returned, int):
        raise InvalidTypeError(&#34;max_changes_returned&#34;, max_changes_returned, int)
    if max_changes_returned &lt;= 0:
        raise ValueError(f&#34;&#39;max_changes_returned&#39; {max_changes_returned} must be a positive integer&#34;)
    if sync_scope is not None and sync_scope not in self.SYNC_SCOPES:
        raise InvalidEnumValue(&#34;sync_scope&#34;, sync_scope, self.SYNC_SCOPES)
    return self._elems_to_objs(
        self._get_elements(
            payload=self.get_payload(
                folder=folder,
                shape=shape,
                additional_fields=additional_fields,
                sync_state=sync_state,
                ignore=ignore,
                max_changes_returned=max_changes_returned,
                sync_scope=sync_scope,
            )
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.SyncFolderItems.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, folder, shape, additional_fields, sync_state, ignore, max_changes_returned, sync_scope)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, folder, shape, additional_fields, sync_state, ignore, max_changes_returned, sync_scope):
    sync_folder_items = self._partial_get_payload(
        folder=folder, shape=shape, additional_fields=additional_fields, sync_state=sync_state
    )
    is_empty, ignore = (True, None) if ignore is None else peek(ignore)
    if not is_empty:
        sync_folder_items.append(item_ids_element(items=ignore, version=self.account.version, tag=&#34;m:Ignore&#34;))
    add_xml_child(sync_folder_items, &#34;m:MaxChangesReturned&#34;, max_changes_returned)
    if sync_scope:
        add_xml_child(sync_folder_items, &#34;m:SyncScope&#34;, sync_scope)
    return sync_folder_items</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.sync_folder_hierarchy.SyncFolder" href="sync_folder_hierarchy.html#exchangelib.services.sync_folder_hierarchy.SyncFolder">SyncFolder</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.sync_folder_hierarchy.SyncFolder.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.sync_folder_hierarchy.SyncFolder.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.sync_folder_hierarchy.SyncFolder.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.sync_folder_hierarchy.SyncFolder.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.sync_folder_hierarchy.SyncFolder.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.sync_folder_hierarchy.SyncFolder.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.Unsubscribe"><code class="flex name class">
<span>class <span class="ident">Unsubscribe</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Unsubscribing is only valid for pull and streaming notifications.</p>
<p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/unsubscribe-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/unsubscribe-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Unsubscribe(EWSAccountService):
    &#34;&#34;&#34;Unsubscribing is only valid for pull and streaming notifications.

    MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/unsubscribe-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;Unsubscribe&#34;
    returns_elements = False
    prefer_affinity = True

    def call(self, subscription_id):
        return self._get_elements(payload=self.get_payload(subscription_id=subscription_id))

    def get_payload(self, subscription_id):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        add_xml_child(payload, &#34;m:SubscriptionId&#34;, subscription_id)
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.Unsubscribe.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.Unsubscribe.prefer_affinity"><code class="name">var <span class="ident">prefer_affinity</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.Unsubscribe.returns_elements"><code class="name">var <span class="ident">returns_elements</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.Unsubscribe.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, subscription_id)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, subscription_id):
    return self._get_elements(payload=self.get_payload(subscription_id=subscription_id))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.Unsubscribe.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, subscription_id)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, subscription_id):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    add_xml_child(payload, &#34;m:SubscriptionId&#34;, subscription_id)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.UpdateFolder"><code class="flex name class">
<span>class <span class="ident">UpdateFolder</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/updatefolder-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/updatefolder-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class UpdateFolder(BaseUpdateService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/updatefolder-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;UpdateFolder&#34;
    SET_FIELD_ELEMENT_NAME = &#34;t:SetFolderField&#34;
    DELETE_FIELD_ELEMENT_NAME = &#34;t:DeleteFolderField&#34;
    CHANGE_ELEMENT_NAME = &#34;t:FolderChange&#34;
    CHANGES_ELEMENT_NAME = &#34;m:FolderChanges&#34;
    element_container_name = f&#34;{{{MNS}}}Folders&#34;

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self.folders = []  # A hack to communicate parsing args to _elems_to_objs()

    def call(self, folders):
        # We can&#39;t easily find the correct folder class from the returned XML. Instead, return objects with the same
        # class as the folder instance it was requested with.
        self.folders = list(folders)  # Convert to a list, in case &#39;folders&#39; is a generator. We&#39;re iterating twice.
        return self._elems_to_objs(self._chunked_get_elements(self.get_payload, items=self.folders))

    def _elems_to_objs(self, elems):
        for (folder, _), elem in zip(self.folders, elems):
            if isinstance(elem, Exception):
                yield elem
                continue
            yield parse_folder_elem(elem=elem, folder=folder, account=self.account)

    @staticmethod
    def _target_elem(target):
        return to_item_id(target, FolderId)

    def get_payload(self, folders):
        # Takes a list of (Folder, fieldnames) tuples where &#39;Folder&#39; is an instance of a subclass of Folder and
        # &#39;fieldnames&#39; are the attribute names that were updated.
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        payload.append(self._changes_elem(target_changes=folders))
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.update_folder.BaseUpdateService" href="update_folder.html#exchangelib.services.update_folder.BaseUpdateService">BaseUpdateService</a></li>
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.UpdateFolder.CHANGES_ELEMENT_NAME"><code class="name">var <span class="ident">CHANGES_ELEMENT_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.UpdateFolder.CHANGE_ELEMENT_NAME"><code class="name">var <span class="ident">CHANGE_ELEMENT_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.UpdateFolder.DELETE_FIELD_ELEMENT_NAME"><code class="name">var <span class="ident">DELETE_FIELD_ELEMENT_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.UpdateFolder.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.UpdateFolder.SET_FIELD_ELEMENT_NAME"><code class="name">var <span class="ident">SET_FIELD_ELEMENT_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.UpdateFolder.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.UpdateFolder.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, folders)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, folders):
    # We can&#39;t easily find the correct folder class from the returned XML. Instead, return objects with the same
    # class as the folder instance it was requested with.
    self.folders = list(folders)  # Convert to a list, in case &#39;folders&#39; is a generator. We&#39;re iterating twice.
    return self._elems_to_objs(self._chunked_get_elements(self.get_payload, items=self.folders))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.UpdateFolder.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, folders)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, folders):
    # Takes a list of (Folder, fieldnames) tuples where &#39;Folder&#39; is an instance of a subclass of Folder and
    # &#39;fieldnames&#39; are the attribute names that were updated.
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    payload.append(self._changes_elem(target_changes=folders))
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.update_folder.BaseUpdateService" href="update_folder.html#exchangelib.services.update_folder.BaseUpdateService">BaseUpdateService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.update_folder.BaseUpdateService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.update_folder.BaseUpdateService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.update_folder.BaseUpdateService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.update_folder.BaseUpdateService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.update_folder.BaseUpdateService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.update_folder.BaseUpdateService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.UpdateItem"><code class="flex name class">
<span>class <span class="ident">UpdateItem</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateitem-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateitem-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class UpdateItem(BaseUpdateService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateitem-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;UpdateItem&#34;
    SET_FIELD_ELEMENT_NAME = &#34;t:SetItemField&#34;
    DELETE_FIELD_ELEMENT_NAME = &#34;t:DeleteItemField&#34;
    CHANGE_ELEMENT_NAME = &#34;t:ItemChange&#34;
    CHANGES_ELEMENT_NAME = &#34;m:ItemChanges&#34;
    element_container_name = f&#34;{{{MNS}}}Items&#34;

    def call(
        self,
        items,
        conflict_resolution,
        message_disposition,
        send_meeting_invitations_or_cancellations,
        suppress_read_receipts,
    ):
        if conflict_resolution not in CONFLICT_RESOLUTION_CHOICES:
            raise InvalidEnumValue(&#34;conflict_resolution&#34;, conflict_resolution, CONFLICT_RESOLUTION_CHOICES)
        if message_disposition not in MESSAGE_DISPOSITION_CHOICES:
            raise InvalidEnumValue(&#34;message_disposition&#34;, message_disposition, MESSAGE_DISPOSITION_CHOICES)
        if send_meeting_invitations_or_cancellations not in SEND_MEETING_INVITATIONS_AND_CANCELLATIONS_CHOICES:
            raise InvalidEnumValue(
                &#34;send_meeting_invitations_or_cancellations&#34;,
                send_meeting_invitations_or_cancellations,
                SEND_MEETING_INVITATIONS_AND_CANCELLATIONS_CHOICES,
            )
        if message_disposition == SEND_ONLY:
            raise ValueError(&#34;Cannot send-only existing objects. Use SendItem service instead&#34;)
        return self._elems_to_objs(
            self._chunked_get_elements(
                self.get_payload,
                items=items,
                conflict_resolution=conflict_resolution,
                message_disposition=message_disposition,
                send_meeting_invitations_or_cancellations=send_meeting_invitations_or_cancellations,
                suppress_read_receipts=suppress_read_receipts,
            )
        )

    def _elem_to_obj(self, elem):
        return Item.id_from_xml(elem)

    def _update_elems(self, target, fieldnames):
        fieldnames_copy = list(fieldnames)

        if target.__class__ == CalendarItem:
            # For CalendarItem items where we update &#39;start&#39; or &#39;end&#39;, we want to update internal timezone fields
            target.clean_timezone_fields(version=self.account.version)  # Possibly also sets timezone values
            for field_name in (&#34;start&#34;, &#34;end&#34;):
                if field_name in fieldnames_copy:
                    tz_field_name = target.tz_field_for_field_name(field_name).name
                    if tz_field_name not in fieldnames_copy:
                        fieldnames_copy.append(tz_field_name)

        yield from super()._update_elems(target=target, fieldnames=fieldnames_copy)

    def _get_value(self, target, field):
        value = super()._get_value(target, field)

        if target.__class__ == CalendarItem:
            # For CalendarItem items where we update &#39;start&#39; or &#39;end&#39;, we want to send values in the local timezone
            if field.name in (&#34;start&#34;, &#34;end&#34;):
                if type(value) is EWSDate:
                    # EWS always expects a datetime
                    return target.date_to_datetime(field_name=field.name)
                tz_field_name = target.tz_field_for_field_name(field.name).name
                return value.astimezone(getattr(target, tz_field_name))

        return value

    @staticmethod
    def _target_elem(target):
        return to_item_id(target, ItemId)

    def get_payload(
        self,
        items,
        conflict_resolution,
        message_disposition,
        send_meeting_invitations_or_cancellations,
        suppress_read_receipts,
    ):
        # Takes a list of (Item, fieldnames) tuples where &#39;Item&#39; is an instance of a subclass of Item and &#39;fieldnames&#39;
        # are the attribute names that were updated.
        attrs = dict(
            ConflictResolution=conflict_resolution,
            MessageDisposition=message_disposition,
            SendMeetingInvitationsOrCancellations=send_meeting_invitations_or_cancellations,
        )
        if self.account.version.build &gt;= EXCHANGE_2013_SP1:
            attrs[&#34;SuppressReadReceipts&#34;] = suppress_read_receipts
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=attrs)
        payload.append(self._changes_elem(target_changes=items))
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.update_folder.BaseUpdateService" href="update_folder.html#exchangelib.services.update_folder.BaseUpdateService">BaseUpdateService</a></li>
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.UpdateItem.CHANGES_ELEMENT_NAME"><code class="name">var <span class="ident">CHANGES_ELEMENT_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.UpdateItem.CHANGE_ELEMENT_NAME"><code class="name">var <span class="ident">CHANGE_ELEMENT_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.UpdateItem.DELETE_FIELD_ELEMENT_NAME"><code class="name">var <span class="ident">DELETE_FIELD_ELEMENT_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.UpdateItem.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.UpdateItem.SET_FIELD_ELEMENT_NAME"><code class="name">var <span class="ident">SET_FIELD_ELEMENT_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.UpdateItem.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.UpdateItem.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, items, conflict_resolution, message_disposition, send_meeting_invitations_or_cancellations, suppress_read_receipts)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(
    self,
    items,
    conflict_resolution,
    message_disposition,
    send_meeting_invitations_or_cancellations,
    suppress_read_receipts,
):
    if conflict_resolution not in CONFLICT_RESOLUTION_CHOICES:
        raise InvalidEnumValue(&#34;conflict_resolution&#34;, conflict_resolution, CONFLICT_RESOLUTION_CHOICES)
    if message_disposition not in MESSAGE_DISPOSITION_CHOICES:
        raise InvalidEnumValue(&#34;message_disposition&#34;, message_disposition, MESSAGE_DISPOSITION_CHOICES)
    if send_meeting_invitations_or_cancellations not in SEND_MEETING_INVITATIONS_AND_CANCELLATIONS_CHOICES:
        raise InvalidEnumValue(
            &#34;send_meeting_invitations_or_cancellations&#34;,
            send_meeting_invitations_or_cancellations,
            SEND_MEETING_INVITATIONS_AND_CANCELLATIONS_CHOICES,
        )
    if message_disposition == SEND_ONLY:
        raise ValueError(&#34;Cannot send-only existing objects. Use SendItem service instead&#34;)
    return self._elems_to_objs(
        self._chunked_get_elements(
            self.get_payload,
            items=items,
            conflict_resolution=conflict_resolution,
            message_disposition=message_disposition,
            send_meeting_invitations_or_cancellations=send_meeting_invitations_or_cancellations,
            suppress_read_receipts=suppress_read_receipts,
        )
    )</code></pre>
</details>
</dd>
<dt id="exchangelib.services.UpdateItem.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, items, conflict_resolution, message_disposition, send_meeting_invitations_or_cancellations, suppress_read_receipts)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(
    self,
    items,
    conflict_resolution,
    message_disposition,
    send_meeting_invitations_or_cancellations,
    suppress_read_receipts,
):
    # Takes a list of (Item, fieldnames) tuples where &#39;Item&#39; is an instance of a subclass of Item and &#39;fieldnames&#39;
    # are the attribute names that were updated.
    attrs = dict(
        ConflictResolution=conflict_resolution,
        MessageDisposition=message_disposition,
        SendMeetingInvitationsOrCancellations=send_meeting_invitations_or_cancellations,
    )
    if self.account.version.build &gt;= EXCHANGE_2013_SP1:
        attrs[&#34;SuppressReadReceipts&#34;] = suppress_read_receipts
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;, attrs=attrs)
    payload.append(self._changes_elem(target_changes=items))
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.update_folder.BaseUpdateService" href="update_folder.html#exchangelib.services.update_folder.BaseUpdateService">BaseUpdateService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.update_folder.BaseUpdateService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.update_folder.BaseUpdateService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.update_folder.BaseUpdateService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.update_folder.BaseUpdateService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.update_folder.BaseUpdateService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.update_folder.BaseUpdateService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.UpdateUserConfiguration"><code class="flex name class">
<span>class <span class="ident">UpdateUserConfiguration</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateuserconfiguration-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateuserconfiguration-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class UpdateUserConfiguration(EWSAccountService):
    &#34;&#34;&#34;MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateuserconfiguration-operation
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;UpdateUserConfiguration&#34;
    returns_elements = False

    def call(self, user_configuration):
        return self._get_elements(payload=self.get_payload(user_configuration=user_configuration))

    def get_payload(self, user_configuration):
        return set_xml_value(create_element(f&#34;m:{self.SERVICE_NAME}&#34;), user_configuration, version=self.account.version)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.UpdateUserConfiguration.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.UpdateUserConfiguration.returns_elements"><code class="name">var <span class="ident">returns_elements</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.UpdateUserConfiguration.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, user_configuration)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, user_configuration):
    return self._get_elements(payload=self.get_payload(user_configuration=user_configuration))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.UpdateUserConfiguration.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, user_configuration)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, user_configuration):
    return set_xml_value(create_element(f&#34;m:{self.SERVICE_NAME}&#34;), user_configuration, version=self.account.version)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.UploadItems"><code class="flex name class">
<span>class <span class="ident">UploadItems</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/uploaditems-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/uploaditems-operation</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class UploadItems(EWSAccountService):
    &#34;&#34;&#34;MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/uploaditems-operation&#34;&#34;&#34;

    SERVICE_NAME = &#34;UploadItems&#34;
    element_container_name = f&#34;{{{MNS}}}ItemId&#34;

    def call(self, items):
        # _pool_requests expects &#39;items&#39;, not &#39;data&#39;
        return self._elems_to_objs(self._chunked_get_elements(self.get_payload, items=items))

    def get_payload(self, items):
        &#34;&#34;&#34;Upload given items to given account.

        &#39;items&#39; is an iterable of tuples where the first element is a Folder instance representing the ParentFolder
        that the item will be placed in and the second element is a tuple containing an optional ItemId, an optional
        Item.is_associated boolean, and a Data string returned from an ExportItems.
        call.

        :param items:
        &#34;&#34;&#34;
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        items_elem = create_element(&#34;m:Items&#34;)
        payload.append(items_elem)
        for parent_folder, (item_id, is_associated, data_str) in items:
            # TODO: The full spec also allows the &#34;UpdateOrCreate&#34; create action.
            attrs = dict(CreateAction=&#34;Update&#34; if item_id else &#34;CreateNew&#34;)
            if is_associated is not None:
                attrs[&#34;IsAssociated&#34;] = is_associated
            item = create_element(&#34;t:Item&#34;, attrs=attrs)
            set_xml_value(item, ParentFolderId(parent_folder.id, parent_folder.changekey), version=self.account.version)
            if item_id:
                set_xml_value(item, to_item_id(item_id, ItemId), version=self.account.version)
            add_xml_child(item, &#34;t:Data&#34;, data_str)
            items_elem.append(item)
        return payload

    def _elem_to_obj(self, elem):
        return elem.get(ItemId.ID_ATTR), elem.get(ItemId.CHANGEKEY_ATTR)

    @classmethod
    def _get_elements_in_container(cls, container):
        return [container]</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.UploadItems.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.UploadItems.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.UploadItems.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, items)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, items):
    # _pool_requests expects &#39;items&#39;, not &#39;data&#39;
    return self._elems_to_objs(self._chunked_get_elements(self.get_payload, items=items))</code></pre>
</details>
</dd>
<dt id="exchangelib.services.UploadItems.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, items)</span>
</code></dt>
<dd>
<div class="desc"><p>Upload given items to given account.</p>
<p>'items' is an iterable of tuples where the first element is a Folder instance representing the ParentFolder
that the item will be placed in and the second element is a tuple containing an optional ItemId, an optional
Item.is_associated boolean, and a Data string returned from an ExportItems.
call.</p>
<p>:param items:</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, items):
    &#34;&#34;&#34;Upload given items to given account.

    &#39;items&#39; is an iterable of tuples where the first element is a Folder instance representing the ParentFolder
    that the item will be placed in and the second element is a tuple containing an optional ItemId, an optional
    Item.is_associated boolean, and a Data string returned from an ExportItems.
    call.

    :param items:
    &#34;&#34;&#34;
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    items_elem = create_element(&#34;m:Items&#34;)
    payload.append(items_elem)
    for parent_folder, (item_id, is_associated, data_str) in items:
        # TODO: The full spec also allows the &#34;UpdateOrCreate&#34; create action.
        attrs = dict(CreateAction=&#34;Update&#34; if item_id else &#34;CreateNew&#34;)
        if is_associated is not None:
            attrs[&#34;IsAssociated&#34;] = is_associated
        item = create_element(&#34;t:Item&#34;, attrs=attrs)
        set_xml_value(item, ParentFolderId(parent_folder.id, parent_folder.changekey), version=self.account.version)
        if item_id:
            set_xml_value(item, to_item_id(item_id, ItemId), version=self.account.version)
        add_xml_child(item, &#34;t:Data&#34;, data_str)
        items_elem.append(item)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="exchangelib" href="../index.html">exchangelib</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="exchangelib.services.archive_item" href="archive_item.html">exchangelib.services.archive_item</a></code></li>
<li><code><a title="exchangelib.services.common" href="common.html">exchangelib.services.common</a></code></li>
<li><code><a title="exchangelib.services.convert_id" href="convert_id.html">exchangelib.services.convert_id</a></code></li>
<li><code><a title="exchangelib.services.copy_item" href="copy_item.html">exchangelib.services.copy_item</a></code></li>
<li><code><a title="exchangelib.services.create_attachment" href="create_attachment.html">exchangelib.services.create_attachment</a></code></li>
<li><code><a title="exchangelib.services.create_folder" href="create_folder.html">exchangelib.services.create_folder</a></code></li>
<li><code><a title="exchangelib.services.create_item" href="create_item.html">exchangelib.services.create_item</a></code></li>
<li><code><a title="exchangelib.services.create_user_configuration" href="create_user_configuration.html">exchangelib.services.create_user_configuration</a></code></li>
<li><code><a title="exchangelib.services.delete_attachment" href="delete_attachment.html">exchangelib.services.delete_attachment</a></code></li>
<li><code><a title="exchangelib.services.delete_folder" href="delete_folder.html">exchangelib.services.delete_folder</a></code></li>
<li><code><a title="exchangelib.services.delete_item" href="delete_item.html">exchangelib.services.delete_item</a></code></li>
<li><code><a title="exchangelib.services.delete_user_configuration" href="delete_user_configuration.html">exchangelib.services.delete_user_configuration</a></code></li>
<li><code><a title="exchangelib.services.empty_folder" href="empty_folder.html">exchangelib.services.empty_folder</a></code></li>
<li><code><a title="exchangelib.services.expand_dl" href="expand_dl.html">exchangelib.services.expand_dl</a></code></li>
<li><code><a title="exchangelib.services.export_items" href="export_items.html">exchangelib.services.export_items</a></code></li>
<li><code><a title="exchangelib.services.find_folder" href="find_folder.html">exchangelib.services.find_folder</a></code></li>
<li><code><a title="exchangelib.services.find_item" href="find_item.html">exchangelib.services.find_item</a></code></li>
<li><code><a title="exchangelib.services.find_people" href="find_people.html">exchangelib.services.find_people</a></code></li>
<li><code><a title="exchangelib.services.get_attachment" href="get_attachment.html">exchangelib.services.get_attachment</a></code></li>
<li><code><a title="exchangelib.services.get_delegate" href="get_delegate.html">exchangelib.services.get_delegate</a></code></li>
<li><code><a title="exchangelib.services.get_events" href="get_events.html">exchangelib.services.get_events</a></code></li>
<li><code><a title="exchangelib.services.get_folder" href="get_folder.html">exchangelib.services.get_folder</a></code></li>
<li><code><a title="exchangelib.services.get_item" href="get_item.html">exchangelib.services.get_item</a></code></li>
<li><code><a title="exchangelib.services.get_mail_tips" href="get_mail_tips.html">exchangelib.services.get_mail_tips</a></code></li>
<li><code><a title="exchangelib.services.get_persona" href="get_persona.html">exchangelib.services.get_persona</a></code></li>
<li><code><a title="exchangelib.services.get_room_lists" href="get_room_lists.html">exchangelib.services.get_room_lists</a></code></li>
<li><code><a title="exchangelib.services.get_rooms" href="get_rooms.html">exchangelib.services.get_rooms</a></code></li>
<li><code><a title="exchangelib.services.get_searchable_mailboxes" href="get_searchable_mailboxes.html">exchangelib.services.get_searchable_mailboxes</a></code></li>
<li><code><a title="exchangelib.services.get_server_time_zones" href="get_server_time_zones.html">exchangelib.services.get_server_time_zones</a></code></li>
<li><code><a title="exchangelib.services.get_streaming_events" href="get_streaming_events.html">exchangelib.services.get_streaming_events</a></code></li>
<li><code><a title="exchangelib.services.get_user_availability" href="get_user_availability.html">exchangelib.services.get_user_availability</a></code></li>
<li><code><a title="exchangelib.services.get_user_configuration" href="get_user_configuration.html">exchangelib.services.get_user_configuration</a></code></li>
<li><code><a title="exchangelib.services.get_user_oof_settings" href="get_user_oof_settings.html">exchangelib.services.get_user_oof_settings</a></code></li>
<li><code><a title="exchangelib.services.get_user_settings" href="get_user_settings.html">exchangelib.services.get_user_settings</a></code></li>
<li><code><a title="exchangelib.services.mark_as_junk" href="mark_as_junk.html">exchangelib.services.mark_as_junk</a></code></li>
<li><code><a title="exchangelib.services.move_folder" href="move_folder.html">exchangelib.services.move_folder</a></code></li>
<li><code><a title="exchangelib.services.move_item" href="move_item.html">exchangelib.services.move_item</a></code></li>
<li><code><a title="exchangelib.services.resolve_names" href="resolve_names.html">exchangelib.services.resolve_names</a></code></li>
<li><code><a title="exchangelib.services.send_item" href="send_item.html">exchangelib.services.send_item</a></code></li>
<li><code><a title="exchangelib.services.send_notification" href="send_notification.html">exchangelib.services.send_notification</a></code></li>
<li><code><a title="exchangelib.services.set_user_oof_settings" href="set_user_oof_settings.html">exchangelib.services.set_user_oof_settings</a></code></li>
<li><code><a title="exchangelib.services.subscribe" href="subscribe.html">exchangelib.services.subscribe</a></code></li>
<li><code><a title="exchangelib.services.sync_folder_hierarchy" href="sync_folder_hierarchy.html">exchangelib.services.sync_folder_hierarchy</a></code></li>
<li><code><a title="exchangelib.services.sync_folder_items" href="sync_folder_items.html">exchangelib.services.sync_folder_items</a></code></li>
<li><code><a title="exchangelib.services.unsubscribe" href="unsubscribe.html">exchangelib.services.unsubscribe</a></code></li>
<li><code><a title="exchangelib.services.update_folder" href="update_folder.html">exchangelib.services.update_folder</a></code></li>
<li><code><a title="exchangelib.services.update_item" href="update_item.html">exchangelib.services.update_item</a></code></li>
<li><code><a title="exchangelib.services.update_user_configuration" href="update_user_configuration.html">exchangelib.services.update_user_configuration</a></code></li>
<li><code><a title="exchangelib.services.upload_items" href="upload_items.html">exchangelib.services.upload_items</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="exchangelib.services.ArchiveItem" href="#exchangelib.services.ArchiveItem">ArchiveItem</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.ArchiveItem.SERVICE_NAME" href="#exchangelib.services.ArchiveItem.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.ArchiveItem.call" href="#exchangelib.services.ArchiveItem.call">call</a></code></li>
<li><code><a title="exchangelib.services.ArchiveItem.element_container_name" href="#exchangelib.services.ArchiveItem.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.ArchiveItem.get_payload" href="#exchangelib.services.ArchiveItem.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.ArchiveItem.supported_from" href="#exchangelib.services.ArchiveItem.supported_from">supported_from</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.ConvertId" href="#exchangelib.services.ConvertId">ConvertId</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.ConvertId.SERVICE_NAME" href="#exchangelib.services.ConvertId.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.ConvertId.call" href="#exchangelib.services.ConvertId.call">call</a></code></li>
<li><code><a title="exchangelib.services.ConvertId.cls_map" href="#exchangelib.services.ConvertId.cls_map">cls_map</a></code></li>
<li><code><a title="exchangelib.services.ConvertId.get_payload" href="#exchangelib.services.ConvertId.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.CopyItem" href="#exchangelib.services.CopyItem">CopyItem</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.CopyItem.SERVICE_NAME" href="#exchangelib.services.CopyItem.SERVICE_NAME">SERVICE_NAME</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.CreateAttachment" href="#exchangelib.services.CreateAttachment">CreateAttachment</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.CreateAttachment.SERVICE_NAME" href="#exchangelib.services.CreateAttachment.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.CreateAttachment.call" href="#exchangelib.services.CreateAttachment.call">call</a></code></li>
<li><code><a title="exchangelib.services.CreateAttachment.cls_map" href="#exchangelib.services.CreateAttachment.cls_map">cls_map</a></code></li>
<li><code><a title="exchangelib.services.CreateAttachment.element_container_name" href="#exchangelib.services.CreateAttachment.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.CreateAttachment.get_payload" href="#exchangelib.services.CreateAttachment.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.CreateFolder" href="#exchangelib.services.CreateFolder">CreateFolder</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.CreateFolder.ERRORS_TO_CATCH_IN_RESPONSE" href="#exchangelib.services.CreateFolder.ERRORS_TO_CATCH_IN_RESPONSE">ERRORS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.CreateFolder.SERVICE_NAME" href="#exchangelib.services.CreateFolder.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.CreateFolder.call" href="#exchangelib.services.CreateFolder.call">call</a></code></li>
<li><code><a title="exchangelib.services.CreateFolder.element_container_name" href="#exchangelib.services.CreateFolder.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.CreateFolder.get_payload" href="#exchangelib.services.CreateFolder.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.CreateItem" href="#exchangelib.services.CreateItem">CreateItem</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.CreateItem.SERVICE_NAME" href="#exchangelib.services.CreateItem.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.CreateItem.call" href="#exchangelib.services.CreateItem.call">call</a></code></li>
<li><code><a title="exchangelib.services.CreateItem.element_container_name" href="#exchangelib.services.CreateItem.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.CreateItem.get_payload" href="#exchangelib.services.CreateItem.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.CreateUserConfiguration" href="#exchangelib.services.CreateUserConfiguration">CreateUserConfiguration</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.CreateUserConfiguration.SERVICE_NAME" href="#exchangelib.services.CreateUserConfiguration.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.CreateUserConfiguration.call" href="#exchangelib.services.CreateUserConfiguration.call">call</a></code></li>
<li><code><a title="exchangelib.services.CreateUserConfiguration.get_payload" href="#exchangelib.services.CreateUserConfiguration.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.CreateUserConfiguration.returns_elements" href="#exchangelib.services.CreateUserConfiguration.returns_elements">returns_elements</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.DeleteAttachment" href="#exchangelib.services.DeleteAttachment">DeleteAttachment</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.DeleteAttachment.SERVICE_NAME" href="#exchangelib.services.DeleteAttachment.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.DeleteAttachment.call" href="#exchangelib.services.DeleteAttachment.call">call</a></code></li>
<li><code><a title="exchangelib.services.DeleteAttachment.get_payload" href="#exchangelib.services.DeleteAttachment.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.DeleteFolder" href="#exchangelib.services.DeleteFolder">DeleteFolder</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.DeleteFolder.SERVICE_NAME" href="#exchangelib.services.DeleteFolder.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.DeleteFolder.call" href="#exchangelib.services.DeleteFolder.call">call</a></code></li>
<li><code><a title="exchangelib.services.DeleteFolder.get_payload" href="#exchangelib.services.DeleteFolder.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.DeleteFolder.returns_elements" href="#exchangelib.services.DeleteFolder.returns_elements">returns_elements</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.DeleteItem" href="#exchangelib.services.DeleteItem">DeleteItem</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.DeleteItem.SERVICE_NAME" href="#exchangelib.services.DeleteItem.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.DeleteItem.call" href="#exchangelib.services.DeleteItem.call">call</a></code></li>
<li><code><a title="exchangelib.services.DeleteItem.get_payload" href="#exchangelib.services.DeleteItem.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.DeleteItem.returns_elements" href="#exchangelib.services.DeleteItem.returns_elements">returns_elements</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.DeleteUserConfiguration" href="#exchangelib.services.DeleteUserConfiguration">DeleteUserConfiguration</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.DeleteUserConfiguration.SERVICE_NAME" href="#exchangelib.services.DeleteUserConfiguration.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.DeleteUserConfiguration.call" href="#exchangelib.services.DeleteUserConfiguration.call">call</a></code></li>
<li><code><a title="exchangelib.services.DeleteUserConfiguration.get_payload" href="#exchangelib.services.DeleteUserConfiguration.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.DeleteUserConfiguration.returns_elements" href="#exchangelib.services.DeleteUserConfiguration.returns_elements">returns_elements</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.EWSService" href="#exchangelib.services.EWSService">EWSService</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.EWSService.CHUNK_SIZE" href="#exchangelib.services.EWSService.CHUNK_SIZE">CHUNK_SIZE</a></code></li>
<li><code><a title="exchangelib.services.EWSService.ERRORS_TO_CATCH_IN_RESPONSE" href="#exchangelib.services.EWSService.ERRORS_TO_CATCH_IN_RESPONSE">ERRORS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.EWSService.NO_VALID_SERVER_VERSIONS" href="#exchangelib.services.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.EWSService.NS_MAP" href="#exchangelib.services.EWSService.NS_MAP">NS_MAP</a></code></li>
<li><code><a title="exchangelib.services.EWSService.SERVICE_NAME" href="#exchangelib.services.EWSService.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE" href="#exchangelib.services.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.EWSService.WARNINGS_TO_IGNORE_IN_RESPONSE" href="#exchangelib.services.EWSService.WARNINGS_TO_IGNORE_IN_RESPONSE">WARNINGS_TO_IGNORE_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.EWSService.element_container_name" href="#exchangelib.services.EWSService.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.EWSService.get" href="#exchangelib.services.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.EWSService.parse" href="#exchangelib.services.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.EWSService.returns_elements" href="#exchangelib.services.EWSService.returns_elements">returns_elements</a></code></li>
<li><code><a title="exchangelib.services.EWSService.stop_streaming" href="#exchangelib.services.EWSService.stop_streaming">stop_streaming</a></code></li>
<li><code><a title="exchangelib.services.EWSService.supported_api_versions" href="#exchangelib.services.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.EWSService.wrap" href="#exchangelib.services.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.EmptyFolder" href="#exchangelib.services.EmptyFolder">EmptyFolder</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.EmptyFolder.SERVICE_NAME" href="#exchangelib.services.EmptyFolder.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.EmptyFolder.call" href="#exchangelib.services.EmptyFolder.call">call</a></code></li>
<li><code><a title="exchangelib.services.EmptyFolder.get_payload" href="#exchangelib.services.EmptyFolder.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.EmptyFolder.returns_elements" href="#exchangelib.services.EmptyFolder.returns_elements">returns_elements</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.ExpandDL" href="#exchangelib.services.ExpandDL">ExpandDL</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.ExpandDL.SERVICE_NAME" href="#exchangelib.services.ExpandDL.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.ExpandDL.WARNINGS_TO_IGNORE_IN_RESPONSE" href="#exchangelib.services.ExpandDL.WARNINGS_TO_IGNORE_IN_RESPONSE">WARNINGS_TO_IGNORE_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.ExpandDL.call" href="#exchangelib.services.ExpandDL.call">call</a></code></li>
<li><code><a title="exchangelib.services.ExpandDL.element_container_name" href="#exchangelib.services.ExpandDL.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.ExpandDL.get_payload" href="#exchangelib.services.ExpandDL.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.ExportItems" href="#exchangelib.services.ExportItems">ExportItems</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.ExportItems.ERRORS_TO_CATCH_IN_RESPONSE" href="#exchangelib.services.ExportItems.ERRORS_TO_CATCH_IN_RESPONSE">ERRORS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.ExportItems.SERVICE_NAME" href="#exchangelib.services.ExportItems.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.ExportItems.call" href="#exchangelib.services.ExportItems.call">call</a></code></li>
<li><code><a title="exchangelib.services.ExportItems.element_container_name" href="#exchangelib.services.ExportItems.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.ExportItems.get_payload" href="#exchangelib.services.ExportItems.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.FindFolder" href="#exchangelib.services.FindFolder">FindFolder</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.FindFolder.SERVICE_NAME" href="#exchangelib.services.FindFolder.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.FindFolder.call" href="#exchangelib.services.FindFolder.call">call</a></code></li>
<li><code><a title="exchangelib.services.FindFolder.element_container_name" href="#exchangelib.services.FindFolder.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.FindFolder.get_payload" href="#exchangelib.services.FindFolder.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.FindFolder.paging_container_name" href="#exchangelib.services.FindFolder.paging_container_name">paging_container_name</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.FindItem" href="#exchangelib.services.FindItem">FindItem</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.FindItem.SERVICE_NAME" href="#exchangelib.services.FindItem.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.FindItem.call" href="#exchangelib.services.FindItem.call">call</a></code></li>
<li><code><a title="exchangelib.services.FindItem.element_container_name" href="#exchangelib.services.FindItem.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.FindItem.get_payload" href="#exchangelib.services.FindItem.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.FindItem.paging_container_name" href="#exchangelib.services.FindItem.paging_container_name">paging_container_name</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.FindPeople" href="#exchangelib.services.FindPeople">FindPeople</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.FindPeople.SERVICE_NAME" href="#exchangelib.services.FindPeople.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.FindPeople.call" href="#exchangelib.services.FindPeople.call">call</a></code></li>
<li><code><a title="exchangelib.services.FindPeople.element_container_name" href="#exchangelib.services.FindPeople.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.FindPeople.get_payload" href="#exchangelib.services.FindPeople.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.FindPeople.supported_from" href="#exchangelib.services.FindPeople.supported_from">supported_from</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.GetAttachment" href="#exchangelib.services.GetAttachment">GetAttachment</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.GetAttachment.SERVICE_NAME" href="#exchangelib.services.GetAttachment.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.GetAttachment.call" href="#exchangelib.services.GetAttachment.call">call</a></code></li>
<li><code><a title="exchangelib.services.GetAttachment.cls_map" href="#exchangelib.services.GetAttachment.cls_map">cls_map</a></code></li>
<li><code><a title="exchangelib.services.GetAttachment.element_container_name" href="#exchangelib.services.GetAttachment.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.GetAttachment.get_payload" href="#exchangelib.services.GetAttachment.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.GetAttachment.stream_file_content" href="#exchangelib.services.GetAttachment.stream_file_content">stream_file_content</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.GetDelegate" href="#exchangelib.services.GetDelegate">GetDelegate</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.GetDelegate.ERRORS_TO_CATCH_IN_RESPONSE" href="#exchangelib.services.GetDelegate.ERRORS_TO_CATCH_IN_RESPONSE">ERRORS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.GetDelegate.SERVICE_NAME" href="#exchangelib.services.GetDelegate.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.GetDelegate.call" href="#exchangelib.services.GetDelegate.call">call</a></code></li>
<li><code><a title="exchangelib.services.GetDelegate.get_payload" href="#exchangelib.services.GetDelegate.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.GetDelegate.supported_from" href="#exchangelib.services.GetDelegate.supported_from">supported_from</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.GetEvents" href="#exchangelib.services.GetEvents">GetEvents</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.GetEvents.SERVICE_NAME" href="#exchangelib.services.GetEvents.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.GetEvents.call" href="#exchangelib.services.GetEvents.call">call</a></code></li>
<li><code><a title="exchangelib.services.GetEvents.get_payload" href="#exchangelib.services.GetEvents.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.GetEvents.prefer_affinity" href="#exchangelib.services.GetEvents.prefer_affinity">prefer_affinity</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.GetFolder" href="#exchangelib.services.GetFolder">GetFolder</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.GetFolder.ERRORS_TO_CATCH_IN_RESPONSE" href="#exchangelib.services.GetFolder.ERRORS_TO_CATCH_IN_RESPONSE">ERRORS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.GetFolder.SERVICE_NAME" href="#exchangelib.services.GetFolder.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.GetFolder.call" href="#exchangelib.services.GetFolder.call">call</a></code></li>
<li><code><a title="exchangelib.services.GetFolder.element_container_name" href="#exchangelib.services.GetFolder.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.GetFolder.get_payload" href="#exchangelib.services.GetFolder.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.GetItem" href="#exchangelib.services.GetItem">GetItem</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.GetItem.SERVICE_NAME" href="#exchangelib.services.GetItem.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.GetItem.call" href="#exchangelib.services.GetItem.call">call</a></code></li>
<li><code><a title="exchangelib.services.GetItem.element_container_name" href="#exchangelib.services.GetItem.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.GetItem.get_payload" href="#exchangelib.services.GetItem.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.GetMailTips" href="#exchangelib.services.GetMailTips">GetMailTips</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.GetMailTips.SERVICE_NAME" href="#exchangelib.services.GetMailTips.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.GetMailTips.call" href="#exchangelib.services.GetMailTips.call">call</a></code></li>
<li><code><a title="exchangelib.services.GetMailTips.get_payload" href="#exchangelib.services.GetMailTips.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.GetPersona" href="#exchangelib.services.GetPersona">GetPersona</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.GetPersona.SERVICE_NAME" href="#exchangelib.services.GetPersona.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.GetPersona.call" href="#exchangelib.services.GetPersona.call">call</a></code></li>
<li><code><a title="exchangelib.services.GetPersona.get_payload" href="#exchangelib.services.GetPersona.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.GetRoomLists" href="#exchangelib.services.GetRoomLists">GetRoomLists</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.GetRoomLists.SERVICE_NAME" href="#exchangelib.services.GetRoomLists.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.GetRoomLists.call" href="#exchangelib.services.GetRoomLists.call">call</a></code></li>
<li><code><a title="exchangelib.services.GetRoomLists.element_container_name" href="#exchangelib.services.GetRoomLists.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.GetRoomLists.get_payload" href="#exchangelib.services.GetRoomLists.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.GetRoomLists.supported_from" href="#exchangelib.services.GetRoomLists.supported_from">supported_from</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.GetRooms" href="#exchangelib.services.GetRooms">GetRooms</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.GetRooms.SERVICE_NAME" href="#exchangelib.services.GetRooms.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.GetRooms.call" href="#exchangelib.services.GetRooms.call">call</a></code></li>
<li><code><a title="exchangelib.services.GetRooms.element_container_name" href="#exchangelib.services.GetRooms.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.GetRooms.get_payload" href="#exchangelib.services.GetRooms.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.GetRooms.supported_from" href="#exchangelib.services.GetRooms.supported_from">supported_from</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.GetSearchableMailboxes" href="#exchangelib.services.GetSearchableMailboxes">GetSearchableMailboxes</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.GetSearchableMailboxes.SERVICE_NAME" href="#exchangelib.services.GetSearchableMailboxes.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.GetSearchableMailboxes.call" href="#exchangelib.services.GetSearchableMailboxes.call">call</a></code></li>
<li><code><a title="exchangelib.services.GetSearchableMailboxes.cls_map" href="#exchangelib.services.GetSearchableMailboxes.cls_map">cls_map</a></code></li>
<li><code><a title="exchangelib.services.GetSearchableMailboxes.element_container_name" href="#exchangelib.services.GetSearchableMailboxes.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.GetSearchableMailboxes.failed_mailboxes_container_name" href="#exchangelib.services.GetSearchableMailboxes.failed_mailboxes_container_name">failed_mailboxes_container_name</a></code></li>
<li><code><a title="exchangelib.services.GetSearchableMailboxes.get_payload" href="#exchangelib.services.GetSearchableMailboxes.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.GetSearchableMailboxes.supported_from" href="#exchangelib.services.GetSearchableMailboxes.supported_from">supported_from</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.GetServerTimeZones" href="#exchangelib.services.GetServerTimeZones">GetServerTimeZones</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.GetServerTimeZones.SERVICE_NAME" href="#exchangelib.services.GetServerTimeZones.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.GetServerTimeZones.call" href="#exchangelib.services.GetServerTimeZones.call">call</a></code></li>
<li><code><a title="exchangelib.services.GetServerTimeZones.element_container_name" href="#exchangelib.services.GetServerTimeZones.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.GetServerTimeZones.get_payload" href="#exchangelib.services.GetServerTimeZones.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.GetServerTimeZones.supported_from" href="#exchangelib.services.GetServerTimeZones.supported_from">supported_from</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.GetStreamingEvents" href="#exchangelib.services.GetStreamingEvents">GetStreamingEvents</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.GetStreamingEvents.CLOSED" href="#exchangelib.services.GetStreamingEvents.CLOSED">CLOSED</a></code></li>
<li><code><a title="exchangelib.services.GetStreamingEvents.OK" href="#exchangelib.services.GetStreamingEvents.OK">OK</a></code></li>
<li><code><a title="exchangelib.services.GetStreamingEvents.SERVICE_NAME" href="#exchangelib.services.GetStreamingEvents.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.GetStreamingEvents.call" href="#exchangelib.services.GetStreamingEvents.call">call</a></code></li>
<li><code><a title="exchangelib.services.GetStreamingEvents.element_container_name" href="#exchangelib.services.GetStreamingEvents.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.GetStreamingEvents.get_payload" href="#exchangelib.services.GetStreamingEvents.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.GetStreamingEvents.prefer_affinity" href="#exchangelib.services.GetStreamingEvents.prefer_affinity">prefer_affinity</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.GetUserAvailability" href="#exchangelib.services.GetUserAvailability">GetUserAvailability</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.GetUserAvailability.SERVICE_NAME" href="#exchangelib.services.GetUserAvailability.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.GetUserAvailability.call" href="#exchangelib.services.GetUserAvailability.call">call</a></code></li>
<li><code><a title="exchangelib.services.GetUserAvailability.get_payload" href="#exchangelib.services.GetUserAvailability.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.GetUserConfiguration" href="#exchangelib.services.GetUserConfiguration">GetUserConfiguration</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.GetUserConfiguration.SERVICE_NAME" href="#exchangelib.services.GetUserConfiguration.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.GetUserConfiguration.call" href="#exchangelib.services.GetUserConfiguration.call">call</a></code></li>
<li><code><a title="exchangelib.services.GetUserConfiguration.get_payload" href="#exchangelib.services.GetUserConfiguration.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.GetUserOofSettings" href="#exchangelib.services.GetUserOofSettings">GetUserOofSettings</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.GetUserOofSettings.SERVICE_NAME" href="#exchangelib.services.GetUserOofSettings.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.GetUserOofSettings.call" href="#exchangelib.services.GetUserOofSettings.call">call</a></code></li>
<li><code><a title="exchangelib.services.GetUserOofSettings.element_container_name" href="#exchangelib.services.GetUserOofSettings.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.GetUserOofSettings.get_payload" href="#exchangelib.services.GetUserOofSettings.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.GetUserSettings" href="#exchangelib.services.GetUserSettings">GetUserSettings</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.GetUserSettings.NS_MAP" href="#exchangelib.services.GetUserSettings.NS_MAP">NS_MAP</a></code></li>
<li><code><a title="exchangelib.services.GetUserSettings.SERVICE_NAME" href="#exchangelib.services.GetUserSettings.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.GetUserSettings.call" href="#exchangelib.services.GetUserSettings.call">call</a></code></li>
<li><code><a title="exchangelib.services.GetUserSettings.element_container_name" href="#exchangelib.services.GetUserSettings.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.GetUserSettings.get_payload" href="#exchangelib.services.GetUserSettings.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.GetUserSettings.supported_from" href="#exchangelib.services.GetUserSettings.supported_from">supported_from</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.MarkAsJunk" href="#exchangelib.services.MarkAsJunk">MarkAsJunk</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.MarkAsJunk.SERVICE_NAME" href="#exchangelib.services.MarkAsJunk.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.MarkAsJunk.call" href="#exchangelib.services.MarkAsJunk.call">call</a></code></li>
<li><code><a title="exchangelib.services.MarkAsJunk.get_payload" href="#exchangelib.services.MarkAsJunk.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.MoveFolder" href="#exchangelib.services.MoveFolder">MoveFolder</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.MoveFolder.SERVICE_NAME" href="#exchangelib.services.MoveFolder.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.MoveFolder.call" href="#exchangelib.services.MoveFolder.call">call</a></code></li>
<li><code><a title="exchangelib.services.MoveFolder.element_container_name" href="#exchangelib.services.MoveFolder.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.MoveFolder.get_payload" href="#exchangelib.services.MoveFolder.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.MoveItem" href="#exchangelib.services.MoveItem">MoveItem</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.MoveItem.SERVICE_NAME" href="#exchangelib.services.MoveItem.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.MoveItem.call" href="#exchangelib.services.MoveItem.call">call</a></code></li>
<li><code><a title="exchangelib.services.MoveItem.element_container_name" href="#exchangelib.services.MoveItem.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.MoveItem.get_payload" href="#exchangelib.services.MoveItem.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.ResolveNames" href="#exchangelib.services.ResolveNames">ResolveNames</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.ResolveNames.ERRORS_TO_CATCH_IN_RESPONSE" href="#exchangelib.services.ResolveNames.ERRORS_TO_CATCH_IN_RESPONSE">ERRORS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.ResolveNames.SERVICE_NAME" href="#exchangelib.services.ResolveNames.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.ResolveNames.WARNINGS_TO_IGNORE_IN_RESPONSE" href="#exchangelib.services.ResolveNames.WARNINGS_TO_IGNORE_IN_RESPONSE">WARNINGS_TO_IGNORE_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.ResolveNames.call" href="#exchangelib.services.ResolveNames.call">call</a></code></li>
<li><code><a title="exchangelib.services.ResolveNames.candidates_limit" href="#exchangelib.services.ResolveNames.candidates_limit">candidates_limit</a></code></li>
<li><code><a title="exchangelib.services.ResolveNames.element_container_name" href="#exchangelib.services.ResolveNames.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.ResolveNames.get_payload" href="#exchangelib.services.ResolveNames.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.SendItem" href="#exchangelib.services.SendItem">SendItem</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.SendItem.SERVICE_NAME" href="#exchangelib.services.SendItem.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.SendItem.call" href="#exchangelib.services.SendItem.call">call</a></code></li>
<li><code><a title="exchangelib.services.SendItem.get_payload" href="#exchangelib.services.SendItem.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.SendItem.returns_elements" href="#exchangelib.services.SendItem.returns_elements">returns_elements</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.SendNotification" href="#exchangelib.services.SendNotification">SendNotification</a></code></h4>
<ul class="two-column">
<li><code><a title="exchangelib.services.SendNotification.OK" href="#exchangelib.services.SendNotification.OK">OK</a></code></li>
<li><code><a title="exchangelib.services.SendNotification.SERVICE_NAME" href="#exchangelib.services.SendNotification.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.SendNotification.STATUS_CHOICES" href="#exchangelib.services.SendNotification.STATUS_CHOICES">STATUS_CHOICES</a></code></li>
<li><code><a title="exchangelib.services.SendNotification.UNSUBSCRIBE" href="#exchangelib.services.SendNotification.UNSUBSCRIBE">UNSUBSCRIBE</a></code></li>
<li><code><a title="exchangelib.services.SendNotification.get_payload" href="#exchangelib.services.SendNotification.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.SendNotification.ok_payload" href="#exchangelib.services.SendNotification.ok_payload">ok_payload</a></code></li>
<li><code><a title="exchangelib.services.SendNotification.unsubscribe_payload" href="#exchangelib.services.SendNotification.unsubscribe_payload">unsubscribe_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.SetUserOofSettings" href="#exchangelib.services.SetUserOofSettings">SetUserOofSettings</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.SetUserOofSettings.SERVICE_NAME" href="#exchangelib.services.SetUserOofSettings.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.SetUserOofSettings.call" href="#exchangelib.services.SetUserOofSettings.call">call</a></code></li>
<li><code><a title="exchangelib.services.SetUserOofSettings.get_payload" href="#exchangelib.services.SetUserOofSettings.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.SetUserOofSettings.returns_elements" href="#exchangelib.services.SetUserOofSettings.returns_elements">returns_elements</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.SubscribeToPull" href="#exchangelib.services.SubscribeToPull">SubscribeToPull</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.SubscribeToPull.call" href="#exchangelib.services.SubscribeToPull.call">call</a></code></li>
<li><code><a title="exchangelib.services.SubscribeToPull.get_payload" href="#exchangelib.services.SubscribeToPull.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.SubscribeToPull.prefer_affinity" href="#exchangelib.services.SubscribeToPull.prefer_affinity">prefer_affinity</a></code></li>
<li><code><a title="exchangelib.services.SubscribeToPull.subscription_request_elem_tag" href="#exchangelib.services.SubscribeToPull.subscription_request_elem_tag">subscription_request_elem_tag</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.SubscribeToPush" href="#exchangelib.services.SubscribeToPush">SubscribeToPush</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.SubscribeToPush.call" href="#exchangelib.services.SubscribeToPush.call">call</a></code></li>
<li><code><a title="exchangelib.services.SubscribeToPush.get_payload" href="#exchangelib.services.SubscribeToPush.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.SubscribeToPush.subscription_request_elem_tag" href="#exchangelib.services.SubscribeToPush.subscription_request_elem_tag">subscription_request_elem_tag</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.SubscribeToStreaming" href="#exchangelib.services.SubscribeToStreaming">SubscribeToStreaming</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.SubscribeToStreaming.call" href="#exchangelib.services.SubscribeToStreaming.call">call</a></code></li>
<li><code><a title="exchangelib.services.SubscribeToStreaming.get_payload" href="#exchangelib.services.SubscribeToStreaming.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.SubscribeToStreaming.prefer_affinity" href="#exchangelib.services.SubscribeToStreaming.prefer_affinity">prefer_affinity</a></code></li>
<li><code><a title="exchangelib.services.SubscribeToStreaming.subscription_request_elem_tag" href="#exchangelib.services.SubscribeToStreaming.subscription_request_elem_tag">subscription_request_elem_tag</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.SyncFolderHierarchy" href="#exchangelib.services.SyncFolderHierarchy">SyncFolderHierarchy</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.SyncFolderHierarchy.SERVICE_NAME" href="#exchangelib.services.SyncFolderHierarchy.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.SyncFolderHierarchy.call" href="#exchangelib.services.SyncFolderHierarchy.call">call</a></code></li>
<li><code><a title="exchangelib.services.SyncFolderHierarchy.get_payload" href="#exchangelib.services.SyncFolderHierarchy.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.SyncFolderHierarchy.last_in_range_name" href="#exchangelib.services.SyncFolderHierarchy.last_in_range_name">last_in_range_name</a></code></li>
<li><code><a title="exchangelib.services.SyncFolderHierarchy.shape_tag" href="#exchangelib.services.SyncFolderHierarchy.shape_tag">shape_tag</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.SyncFolderItems" href="#exchangelib.services.SyncFolderItems">SyncFolderItems</a></code></h4>
<ul class="two-column">
<li><code><a title="exchangelib.services.SyncFolderItems.CHANGE_TYPES" href="#exchangelib.services.SyncFolderItems.CHANGE_TYPES">CHANGE_TYPES</a></code></li>
<li><code><a title="exchangelib.services.SyncFolderItems.READ_FLAG_CHANGE" href="#exchangelib.services.SyncFolderItems.READ_FLAG_CHANGE">READ_FLAG_CHANGE</a></code></li>
<li><code><a title="exchangelib.services.SyncFolderItems.SERVICE_NAME" href="#exchangelib.services.SyncFolderItems.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.SyncFolderItems.SYNC_SCOPES" href="#exchangelib.services.SyncFolderItems.SYNC_SCOPES">SYNC_SCOPES</a></code></li>
<li><code><a title="exchangelib.services.SyncFolderItems.call" href="#exchangelib.services.SyncFolderItems.call">call</a></code></li>
<li><code><a title="exchangelib.services.SyncFolderItems.change_types_map" href="#exchangelib.services.SyncFolderItems.change_types_map">change_types_map</a></code></li>
<li><code><a title="exchangelib.services.SyncFolderItems.get_payload" href="#exchangelib.services.SyncFolderItems.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.SyncFolderItems.last_in_range_name" href="#exchangelib.services.SyncFolderItems.last_in_range_name">last_in_range_name</a></code></li>
<li><code><a title="exchangelib.services.SyncFolderItems.shape_tag" href="#exchangelib.services.SyncFolderItems.shape_tag">shape_tag</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.Unsubscribe" href="#exchangelib.services.Unsubscribe">Unsubscribe</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.Unsubscribe.SERVICE_NAME" href="#exchangelib.services.Unsubscribe.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.Unsubscribe.call" href="#exchangelib.services.Unsubscribe.call">call</a></code></li>
<li><code><a title="exchangelib.services.Unsubscribe.get_payload" href="#exchangelib.services.Unsubscribe.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.Unsubscribe.prefer_affinity" href="#exchangelib.services.Unsubscribe.prefer_affinity">prefer_affinity</a></code></li>
<li><code><a title="exchangelib.services.Unsubscribe.returns_elements" href="#exchangelib.services.Unsubscribe.returns_elements">returns_elements</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.UpdateFolder" href="#exchangelib.services.UpdateFolder">UpdateFolder</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.UpdateFolder.CHANGES_ELEMENT_NAME" href="#exchangelib.services.UpdateFolder.CHANGES_ELEMENT_NAME">CHANGES_ELEMENT_NAME</a></code></li>
<li><code><a title="exchangelib.services.UpdateFolder.CHANGE_ELEMENT_NAME" href="#exchangelib.services.UpdateFolder.CHANGE_ELEMENT_NAME">CHANGE_ELEMENT_NAME</a></code></li>
<li><code><a title="exchangelib.services.UpdateFolder.DELETE_FIELD_ELEMENT_NAME" href="#exchangelib.services.UpdateFolder.DELETE_FIELD_ELEMENT_NAME">DELETE_FIELD_ELEMENT_NAME</a></code></li>
<li><code><a title="exchangelib.services.UpdateFolder.SERVICE_NAME" href="#exchangelib.services.UpdateFolder.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.UpdateFolder.SET_FIELD_ELEMENT_NAME" href="#exchangelib.services.UpdateFolder.SET_FIELD_ELEMENT_NAME">SET_FIELD_ELEMENT_NAME</a></code></li>
<li><code><a title="exchangelib.services.UpdateFolder.call" href="#exchangelib.services.UpdateFolder.call">call</a></code></li>
<li><code><a title="exchangelib.services.UpdateFolder.element_container_name" href="#exchangelib.services.UpdateFolder.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.UpdateFolder.get_payload" href="#exchangelib.services.UpdateFolder.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.UpdateItem" href="#exchangelib.services.UpdateItem">UpdateItem</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.UpdateItem.CHANGES_ELEMENT_NAME" href="#exchangelib.services.UpdateItem.CHANGES_ELEMENT_NAME">CHANGES_ELEMENT_NAME</a></code></li>
<li><code><a title="exchangelib.services.UpdateItem.CHANGE_ELEMENT_NAME" href="#exchangelib.services.UpdateItem.CHANGE_ELEMENT_NAME">CHANGE_ELEMENT_NAME</a></code></li>
<li><code><a title="exchangelib.services.UpdateItem.DELETE_FIELD_ELEMENT_NAME" href="#exchangelib.services.UpdateItem.DELETE_FIELD_ELEMENT_NAME">DELETE_FIELD_ELEMENT_NAME</a></code></li>
<li><code><a title="exchangelib.services.UpdateItem.SERVICE_NAME" href="#exchangelib.services.UpdateItem.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.UpdateItem.SET_FIELD_ELEMENT_NAME" href="#exchangelib.services.UpdateItem.SET_FIELD_ELEMENT_NAME">SET_FIELD_ELEMENT_NAME</a></code></li>
<li><code><a title="exchangelib.services.UpdateItem.call" href="#exchangelib.services.UpdateItem.call">call</a></code></li>
<li><code><a title="exchangelib.services.UpdateItem.element_container_name" href="#exchangelib.services.UpdateItem.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.UpdateItem.get_payload" href="#exchangelib.services.UpdateItem.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.UpdateUserConfiguration" href="#exchangelib.services.UpdateUserConfiguration">UpdateUserConfiguration</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.UpdateUserConfiguration.SERVICE_NAME" href="#exchangelib.services.UpdateUserConfiguration.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.UpdateUserConfiguration.call" href="#exchangelib.services.UpdateUserConfiguration.call">call</a></code></li>
<li><code><a title="exchangelib.services.UpdateUserConfiguration.get_payload" href="#exchangelib.services.UpdateUserConfiguration.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.UpdateUserConfiguration.returns_elements" href="#exchangelib.services.UpdateUserConfiguration.returns_elements">returns_elements</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.UploadItems" href="#exchangelib.services.UploadItems">UploadItems</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.UploadItems.SERVICE_NAME" href="#exchangelib.services.UploadItems.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.UploadItems.call" href="#exchangelib.services.UploadItems.call">call</a></code></li>
<li><code><a title="exchangelib.services.UploadItems.element_container_name" href="#exchangelib.services.UploadItems.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.UploadItems.get_payload" href="#exchangelib.services.UploadItems.get_payload">get_payload</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>
